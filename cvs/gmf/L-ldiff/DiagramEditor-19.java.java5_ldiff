60a61,62
> import org.eclipse.emf.transaction.RunnableWithResult;
> 
121,121c123,123
< import org.eclipse.gmf.runtime.diagram.core.internal.util.MEditingDomainGetter;
---
> import org.eclipse.gmf.runtime.diagram.core.listener.DiagramEventBroker;
174a141,141
> import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIStatusCodes;
175,175d140
< import org.eclipse.gmf.runtime.emf.core.edit.MRunnable;
176,176c142,142
< 
---
> 
345a348,349
>             try {
>                 TransactionUtil.getEditingDomain (getDiagram ()).runExclusive (new Runnable () {
346,346d347
<             MEditingDomainGetter.getMEditingDomain (getDiagram ()).runAsRead (new MRunnable () {
348,348c351,351
<                 public Object run () {
---
>                     public void run () {
350a720,720
>     }
350,350c719,719
<                     return null;
---
>         return null;
355a358,361
>             } catch (InterruptedException e) {
>                 Trace.catching (DiagramUIPlugin.getInstance (), DiagramUIDebugOptions.EXCEPTIONS_CATCHING, getClass (), "initializeOutlineViewer", e);
>                 Log.error (DiagramUIPlugin.getInstance (), DiagramUIStatusCodes.IGNORED_EXCEPTION_WARNING, "initializeOutlineViewer", e);
>             }
472,472c478,478
<                     TransactionalEditingDomain editingDomain = TransactionalEditingDomain.Factory.INSTANCE.getEditingDomain (resourceSet);
---
>                     TransactionalEditingDomain resourceSetEditingDomain = TransactionalEditingDomain.Factory.INSTANCE.getEditingDomain (resourceSet);
473,473c479,479
<                     if (domain.equals (editingDomain)) {
---
>                     if (domain.equals (resourceSetEditingDomain)) {
673a680,686
>         TransactionalEditingDomain domain = getEditingDomain ();
>         if (domain != null) {
>             DiagramEventBroker eventBroker = DiagramEventBroker.getInstance (domain);
>             if (eventBroker == null) {
>                 DiagramEventBroker.startListening (domain);
>             }
>         }
701a715,716
>     public TransactionalEditingDomain getEditingDomain () {
>         if (getDiagram () != null) {
702,702d714
<     protected EditingDomain getEditingDomain () {
708,708c724,724
<             TransactionalEditingDomain domain = (TransactionalEditingDomain) getEditingDomain ();
---
>             TransactionalEditingDomain domain = getEditingDomain ();
832,832c848,848
<             DiagramRulerProvider vertProvider = new DiagramRulerProvider ((TransactionalEditingDomain) getEditingDomain (), verticalRuler, root.getMapMode ());
---
>             DiagramRulerProvider vertProvider = new DiagramRulerProvider (getEditingDomain (), verticalRuler, root.getMapMode ());
838,838c854,854
<             DiagramRulerProvider horzProvider = new DiagramRulerProvider ((TransactionalEditingDomain) getEditingDomain (), horizontalRuler, root.getMapMode ());
---
>             DiagramRulerProvider horzProvider = new DiagramRulerProvider (getEditingDomain (), horizontalRuler, root.getMapMode ());
853a870,870
>             try {
853,853c869,869
<         if (selection instanceof IStructuredSelection) {
---
>         if (selection instanceof IStructuredSelection && ! selection.isEmpty ()) {
854,854c871,871
<             return (List) MEditingDomainGetter.getMEditingDomain (((IStructuredSelection) selection).toList ()).runAsRead (new MRunnable () {
---
>                 return (List) TransactionUtil.getEditingDomain (((IAdaptable) ((IStructuredSelection) selection).toList ().get (0)).getAdapter (View.class)).runExclusive (new RunnableWithResult.Impl () {
856,856c873,873
<                 public Object run () {
---
>                     public void run () {
873a891,891
>                         setResult (retval);
874,874d890
<                     return retval;
879a897,900
>             } catch (InterruptedException e) {
>                 Trace.catching (DiagramUIPlugin.getInstance (), DiagramUIDebugOptions.EXCEPTIONS_CATCHING, getClass (), "createEditPart", e);
>                 return Collections.EMPTY_LIST;
>             }
