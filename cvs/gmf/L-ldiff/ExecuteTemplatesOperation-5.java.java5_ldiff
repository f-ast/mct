13,13c13,13
< import org.eclipse.emf.common.util.BasicDiagnostic;
---
> import org.eclipse.emf.common.util.Diagnostic;
90,90c90,90
<             IStatus loadStatus = loadGenModel ();
---
>             Diagnostic loadStatus = loadGenModel ();
94a95,96
>             Diagnostic isGenModelValid = validateGenModel ();
>             if (! ValidationHelper.isOK (isGenModelValid)) {
95,98d94
<             IStatus isGenModelValid = validateGenModel ();
<             if (! isGenModelValid.isOK ()) {
<                 final String [] buttons = new String [] {IDialogConstants.PROCEED_LABEL, IDialogConstants.CANCEL_LABEL};
<                 final int [] buttonIDs = new int [] {IDialogConstants.PROCEED_ID, IDialogConstants.CANCEL_ID};
100,100c98,98
<                 ErrorDialogEx dlg = new ErrorDialogEx (getShell (), getName (), msg, isGenModelValid, buttons, buttonIDs, 0);
---
>                 if (DiagnosticsDialog.openProceedCancel (getShell (), getName (), msg, isGenModelValid) == IDialogConstants.CANCEL_ID) {
101,101d98
<                 if (dlg.open () == IDialogConstants.CANCEL_ID) {
127,127c124,124
<     private boolean canProcessGMFGenModel (IStatus loadStatus) {
---
>     private boolean canProcessGMFGenModel (Diagnostic loadStatus) {
127a125,125
>         if (! ValidationHelper.isOK (loadStatus)) {
128,130d124
<         if (! loadStatus.isOK ()) {
<             String [] buttons = new String [] {IDialogConstants.PROCEED_LABEL, IDialogConstants.CANCEL_LABEL};
<             int [] buttonIDs = new int [] {IDialogConstants.PROCEED_ID, IDialogConstants.CANCEL_ID};
131,131c126,126
<             if (myGenModel == null) {
---
>             boolean disableProceed = myGenModel == null;
131a127,127
>             if (IDialogConstants.CANCEL_ID == DiagnosticsDialog.openProceedCancel (getShell (), getName (), null, loadStatus, disableProceed)) {
132,136d126
<                 buttons = new String [] {buttons [1]};
<                 buttonIDs = new int [] {buttonIDs [1]};
<             }
<             ErrorDialogEx dlg = new ErrorDialogEx (getShell (), getName (), CodeGenUIPlugin.getBundleString ("generatecode.badsrc"), loadStatus, buttons, buttonIDs, 0);
<             if (dlg.open () == IDialogConstants.CANCEL_ID) {
171,171c162,162
<     private IStatus loadGenModel () {
---
>     private Diagnostic loadGenModel () {
184,184c175,175
<         return loadHelper.getStatus ();
---
>         return loadHelper.getDiagnostics ();
194,194c185,185
<     private IStatus validateGenModel () {
---
>     private Diagnostic validateGenModel () {
195,195c186,186
<         return BasicDiagnostic.toIStatus (ValidationHelper.validate (getGenModel (), true));
---
>         return ValidationHelper.validate (getGenModel (), true);
