14a15,18
> import org.eclipse.core.commands.ExecutionException;
> 
> import org.eclipse.core.runtime.IAdaptable;
> 
18a23,24
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
> 
73,73c79,79
< import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
150,150c156,156
<         return cc.isEmpty () ? null : new EtoolsProxyCommand (cc.unwrap ());
---
>         return cc.isEmpty () ? null : new EtoolsProxyCommand (cc.reduce ());
158a165,165
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
160,160c167,167
<             Command moveSemanticCmd = getHost ().getCommand (new EditCommandRequestWrapper (new MoveRequest (context, element)));
---
>             Command moveSemanticCmd = getHost ().getCommand (new EditCommandRequestWrapper (new MoveRequest (editingDomain, context, element)));
170,170c177,177
<         return new AddCommand (new EObjectAdapter (container), new EObjectAdapter (view));
---
>         return new AddCommand (gep.getEditingDomain (), new EObjectAdapter (container), new EObjectAdapter (view));
173a181,182
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
>         CompositeTransactionalCommand cc = new CompositeTransactionalCommand (editingDomain, DiagramUIMessages.AddCommand_Label);
174,174d180
<         CompositeModelCommand cc = new CompositeModelCommand (DiagramUIMessages.AddCommand_Label);
178,178c186,186
<             CreateCommand createCommand = new CreateCommand (descriptor, (View) (getHost ().getModel ()));
---
>             CreateCommand createCommand = new CreateCommand (editingDomain, descriptor, (View) (getHost ().getModel ()));
181,181c189,189
<         return new EtoolsProxyCommand (cc.unwrap ());
---
>         return new EtoolsProxyCommand (cc.reduce ());
241a250,250
>                 protected CommandResult doExecuteWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
242,242d249
<                 protected CommandResult doExecute (IProgressMonitor progressMonitor) {
243,243c251,251
<                     CommandResult cmdResult = super.doExecute (progressMonitor);
---
>                     CommandResult cmdResult = super.doExecuteWithResult (progressMonitor, info);
253,253c261,261
<                     return newOKCommandResult ();
---
>                     return CommandResult.newOKCommandResult ();
255a264,264
>                 protected CommandResult doUndoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
256,256d263
<                 protected CommandResult doUndo () {
260,260c268,268
<                     return super.doUndo ();
---
>                     return super.doUndoWithResult (progressMonitor, info);
262a271,271
>                 protected CommandResult doRedoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
263,263d270
<                 protected CommandResult doRedo () {
267,267c275,275
<                     return super.doRedo ();
---
>                     return super.doRedoWithResult (progressMonitor, info);
