1342a1343,1343
>         createMetaAnnotations ();
1347,1347c1348,1348
<         addAnnotation (genDiagramEClass, source, new String [] {"constraints", "http://www.eclipse.org/gmf/2005/constraints"});
---
>         addAnnotation (this, source, new String [] {"constraints", "http://www.eclipse.org/gmf/2005/constraints", "meta", "http://www.eclipse.org/gmf/2005/constraints/meta"});
1351a1353,1353
>         addAnnotation (this, source, new String [] {"import", "platform:/resource/org.eclipse.gmf.runtime.notation/model/notation.ecore"});
1352a1355,1358
>         addAnnotation (genNodeEClass, source, new String [] {"ocl", "let c: ecore::EClass = diagramRunTimeClass.ecoreClass.oclAsType(ecore::EClass) in c = notation::Node or c.eAllSuperTypes->includes(notation::Node)"});
>         addAnnotation (genLinkEClass, source, new String [] {"ocl", "let c: ecore::EClass = diagramRunTimeClass.ecoreClass.oclAsType(ecore::EClass) in c = notation::Edge or c.eAllSuperTypes->includes(notation::Edge)"});
>         addAnnotation (genNodeLabelEClass, source, new String [] {"ocl", "modelFacet.metaFeature.ecoreFeature.eContainingClass.isSuperTypeOf(node.getDomainMetaClass().ecoreClass)"});
>         addAnnotation (genLinkLabelEClass, source, new String [] {"ocl", "let tl: TypeLinkModelFacet = link.modelFacet.oclAsType(TypeLinkModelFacet) in tl.oclIsUndefined() or modelFacet.metaFeature.ecoreFeature.eContainingClass.isSuperTypeOf(tl.metaClass.ecoreClass)"});
1352,1352c1354,1354
<         addAnnotation (genDiagramEClass, source, new String [] {"ocl", "nodes->forAll(n : GenNode | self.links->forAll(l : GenLink | l.domainMetaClass <> n.domainMetaClass))"});
---
>         addAnnotation (genDiagramEClass, source, new String [] {"ocl", "nodes->forAll(n : GenNode | self.links->forAll(l : GenLink | l.oclAsType(TypeLinkModelFacet).metaClass <> n.getDomainMetaClass()))"});
1353,1354d1354
<         addAnnotation (genNodeEClass, source, new String [] {"ocl", "super.domainNameFeature.eClass == domainMetaClass"});
<         addAnnotation (genNodeEClass, source, new String [] {"ocl", "diagramRunTimeClass.eCoreClass.eAllSuperTypes->includes(diagramrt.DiagramNode)"});
1355,1355c1359,1359
<         addAnnotation (getTypeModelFacet_ContainmentMetaFeature (), source, new String [] {"ocl", "containmentMetaFeature.isContainment"});
---
>         addAnnotation (getTypeModelFacet_ContainmentMetaFeature (), source, new String [] {"ocl", "containmentMetaFeature.ecoreFeature.oclAsType(ecore::EReference).containment"});
1355a1360,1361
>         addAnnotation (getTypeModelFacet_ContainmentMetaFeature (), source, new String [] {"ocl", "containmentMetaFeature.ecoreFeature.oclAsType(ecore::EReference).eReferenceType.isSuperTypeOf(metaClass.ecoreClass)"});
>         addAnnotation (getTypeLinkModelFacet_SourceMetaFeature (), source, new String [] {"ocl", "sourceMetaFeature.oclIsUndefined() or sourceMetaFeature.ecoreFeature.oclAsType(ecore::EReference).eReferenceType.isSuperTypeOf(metaClass.ecoreClass)"});
1356,1356d1359
<         addAnnotation (getTypeLinkModelFacet_SourceMetaFeature (), source, new String [] {"ocl", "sourceMetaFeature.eContainingClass \'equals to\' or \'superclass of\' super.metaClass"});
1357a1363,1375
>         addAnnotation (getGenFeatureSeqInitializer_Initializers (), source, new String [] {"ocl", "initializers.feature->forAll(f| f.ecoreFeature.eContainingClass.isSuperTypeOf(typeModelFacet.metaClass.ecoreClass))"});
>         addAnnotation (genLinkConstraintsEClass, source, new String [] {"ocl", "not sourceEnd.oclIsUndefined() or not targetEnd.oclIsUndefined()"});
>     }
> 
>     protected void createMetaAnnotations () {
>         String source = "http://www.eclipse.org/gmf/2005/constraints/meta";
>         addAnnotation (getTypeModelFacet_ModelElementSelector (), source, new String [] {"def", "context", "ocl", "metaClass.ecoreClass"});
>         addAnnotation (valueExpressionEClass, source, new String [] {"def", "ValueSpec"});
>         addAnnotation (getValueExpression_Body (), source, new String [] {"def", "body"});
>         addAnnotation (getValueExpression_Language (), source, new String [] {"def", "lang"});
>         addAnnotation (modelElementSelectorEClass, source, new String [] {"def", "Constraint"});
>         addAnnotation (getGenFeatureSeqInitializer_Initializers (), source, new String [] {"def", "context", "ocl", "typeModelFacet.metaClass.ecoreClass"});
>         addAnnotation (genFeatureValueSpecEClass, source, new String [] {"def", "ValueSpec"});
1357,1357c1362,1362
<         addAnnotation (getTypeLinkModelFacet_TargetMetaFeature (), source, new String [] {"ocl", "targetMetaFeature.eContainingClass \'equals to\' or \'superclass of\' super.metaClass"});
---
>         addAnnotation (getTypeLinkModelFacet_TargetMetaFeature (), source, new String [] {"ocl", "targetMetaFeature.genClass.ecoreClass.isSuperTypeOf(metaClass.ecoreClass)"});
1358,1358d1362
<         addAnnotation (genFeatureSeqInitializerEClass, source, new String [] {"ocl", "initializers.feature.genClass.ecoreClass->asSet()->size() = 1 -- common ECore class"});
1359,1359c1376,1376
<         addAnnotation (genFeatureValueSpecEClass, source, new String [] {"ocl", "self.feature.ecoreFeature.eType = self.body->evaluate().eType"});
---
>         addAnnotation (genFeatureValueSpecEClass, source, new String [] {"def", "type", "ocl", "feature.ecoreFeature"});
1359a1377,1380
>         addAnnotation (getGenLinkConstraints_SourceEnd (), source, new String [] {"def", "context", "ocl", "getSourceEndContextClass().ecoreClass"});
>         addAnnotation (getGenLinkConstraints_SourceEnd (), source, new String [] {"def", "variable", "name", "oppositeEnd", "type.ocl", "getTargetEndContextClass().ecoreClass"});
>         addAnnotation (getGenLinkConstraints_TargetEnd (), source, new String [] {"def", "context", "ocl", "getTargetEndContextClass().ecoreClass"});
>         addAnnotation (getGenLinkConstraints_TargetEnd (), source, new String [] {"def", "variable", "name", "oppositeEnd", "type.ocl", "getSourceEndContextClass().ecoreClass"});
