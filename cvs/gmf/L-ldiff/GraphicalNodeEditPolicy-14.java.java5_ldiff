8a9,10
> import org.eclipse.core.commands.ExecutionException;
> 
24a27,28
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
> 
131a136,136
>         protected CommandResult doExecuteWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
132,132d135
<         protected CommandResult doExecute (IProgressMonitor progressMonitor) {
133,133c137,137
<             CommandResult cmdResult = super.doExecute (progressMonitor);
---
>             CommandResult cmdResult = super.doExecuteWithResult (progressMonitor, info);
141,141c145,145
<             return newOKCommandResult ();
---
>             return CommandResult.newOKCommandResult ();
143a148,148
>         protected CommandResult doUndoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
144,144d147
<         protected CommandResult doUndo () {
148,148c152,152
<             return super.doUndo ();
---
>             return super.doUndoWithResult (progressMonitor, info);
150a155,155
>         protected CommandResult doRedoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
151,151d154
<         protected CommandResult doRedo () {
155,155c159,159
<             return super.doRedo ();
---
>             return super.doRedoWithResult (progressMonitor, info);
240,240c244,244
<             ICommand spc = new SetPropertyCommand (connection, Properties.ID_ROUTING, StringStatics.BLANK, newRouterType);
---
>             ICommand spc = new SetPropertyCommand (getEditingDomain (), connection, Properties.ID_ROUTING, StringStatics.BLANK, newRouterType);
252a257,257
>         TransactionalEditingDomain editingDomain = getEditingDomain ();
258,258c263,263
<         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (null);
---
>         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (editingDomain, null);
261,261c266,266
<         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (null);
---
>         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (editingDomain, null);
281,281c286,286
<             SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand ();
---
>             SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand (editingDomain);
295a301,301
>         TransactionalEditingDomain editingDomain = getEditingDomain ();
297,297c303,303
<         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (null);
---
>         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (editingDomain, null);
300,300c306,306
<         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (null);
---
>         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (editingDomain, null);
319a326,328
>         Iterator commandItr = cc.iterator ();
>         commandItr.next ();
>         SetConnectionEndsCommand sceCommand = (SetConnectionEndsCommand) commandItr.next ();
320,320d325
<         SetConnectionEndsCommand sceCommand = (SetConnectionEndsCommand) cc.getCommands ().get (1);
322,322c330,330
<         SetConnectionAnchorsCommand scaCommand = (SetConnectionAnchorsCommand) cc.getCommands ().get (2);
---
>         SetConnectionAnchorsCommand scaCommand = (SetConnectionAnchorsCommand) commandItr.next ();
335,335c343,343
<         SetConnectionBendpointsCommand sbbCommand = (SetConnectionBendpointsCommand) cc.getCommands ().get (3);
---
>         SetConnectionBendpointsCommand sbbCommand = (SetConnectionBendpointsCommand) commandItr.next ();
353a362,362
>         TransactionalEditingDomain editingDomain = getEditingDomain ();
354,354c363,363
<         CreateCommand createCommand = new CreateCommand (req.getConnectionViewDescriptor (), diagramView.getDiagram ());
---
>         CreateCommand createCommand = new CreateCommand (editingDomain, req.getConnectionViewDescriptor (), diagramView.getDiagram ());
356,356c365,365
<         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (null);
---
>         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand (editingDomain, null);
360,360c369,369
<         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (null);
---
>         SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand (editingDomain, null);
363,363c372,372
<         SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand ();
---
>         SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand (editingDomain);
556a566,569
>     private TransactionalEditingDomain getEditingDomain () {
>         return ((IGraphicalEditPart) getHost ()).getEditingDomain ();
>     }
> 
