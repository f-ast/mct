18a19,20
> import org.eclipse.core.commands.ExecutionException;
> 
26a29,30
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
> 
105,105c109,109
< import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand;
140,140c144,144
<             return new EtoolsProxyCommand (new PasteCommand (DiagramUIMessages.PasteCommand_Label, viewContext, data, MapModeUtil.getMapMode (((org.eclipse.gef.GraphicalEditPart) getHost ()).getFigure ())));
---
>             return new EtoolsProxyCommand (new PasteCommand (editPart.getEditingDomain (), DiagramUIMessages.PasteCommand_Label, viewContext, data, MapModeUtil.getMapMode (((org.eclipse.gef.GraphicalEditPart) getHost ()).getFigure ())));
179,179c183,183
<             toReturn.compose (new BringToFrontCommand ((View) element.getModel ()));
---
>             toReturn.compose (new BringToFrontCommand (element.getEditingDomain (), (View) element.getModel ()));
189,189c193,193
<             toReturn.compose (new BringForwardCommand ((View) toOrder.getModel ()));
---
>             toReturn.compose (new BringForwardCommand (toOrder.getEditingDomain (), (View) toOrder.getModel ()));
199,199c203,203
<             toReturn.compose (new SendToBackCommand ((View) toOrder.getModel ()));
---
>             toReturn.compose (new SendToBackCommand (toOrder.getEditingDomain (), (View) toOrder.getModel ()));
209,209c213,213
<             toReturn.compose (new SendBackwardCommand ((View) toOrder.getModel ()));
---
>             toReturn.compose (new SendBackwardCommand (toOrder.getEditingDomain (), (View) toOrder.getModel ()));
216a221,221
>             TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
217,217c222,222
<             return new EtoolsProxyCommand (new DeferredLayoutCommand (request.getViewAdaptersToArrange (), (IGraphicalEditPart) getHost (), layoutType));
---
>             return new EtoolsProxyCommand (new DeferredLayoutCommand (editingDomain, request.getViewAdaptersToArrange (), (IGraphicalEditPart) getHost (), layoutType));
251a257,257
>             TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
252,252c258,258
<             return new EtoolsProxyCommand (new AbstractModelCommand ("", null) {
---
>             return new EtoolsProxyCommand (new AbstractTransactionalCommand (editingDomain, "", null) {
254,254c260,260
<                 protected CommandResult doExecute (IProgressMonitor progressMonitor) {
---
>                 protected CommandResult doExecuteWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
256,256c262,262
<                     return newOKCommandResult ();
---
>                     return CommandResult.newOKCommandResult ();
304,304c310,310
<                 org.eclipse.gmf.runtime.emf.type.core.requests.DuplicateElementsRequest duplicateElementsRequest = new DuplicateElementsRequest (new ArrayList (elementsToDuplicate));
---
>                 org.eclipse.gmf.runtime.emf.type.core.requests.DuplicateElementsRequest duplicateElementsRequest = new DuplicateElementsRequest (editingDomain, new ArrayList (elementsToDuplicate));
309,309c315,315
<                     cc.compose (new DuplicateViewsCommand (DiagramUIMessages.Commands_Duplicate_Label, request, notationViewsToDuplicate, duplicateElementsRequest.getAllDuplicatedElementsMap (), getPasteOffset ()));
---
>                     cc.compose (new DuplicateViewsCommand (editingDomain, DiagramUIMessages.Commands_Duplicate_Label, request, notationViewsToDuplicate, duplicateElementsRequest.getAllDuplicatedElementsMap (), getPasteOffset ()));
313,313c319,319
<                 return new EtoolsProxyCommand (new DuplicateViewsCommand (DiagramUIMessages.Commands_Duplicate_Label, request, notationViewsToDuplicate, getPasteOffset ()));
---
>                 return new EtoolsProxyCommand (new DuplicateViewsCommand (editingDomain, DiagramUIMessages.Commands_Duplicate_Label, request, notationViewsToDuplicate, getPasteOffset ()));
