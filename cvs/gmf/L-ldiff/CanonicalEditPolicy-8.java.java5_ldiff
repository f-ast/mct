3,6d2
< import java.beans.PropertyChangeEvent;
< 
< import java.beans.PropertyChangeListener;
< 
34a31,32
> import org.eclipse.emf.common.notify.Notification;
> 
62a61,62
> import org.eclipse.gmf.runtime.diagram.core.listener.NotificationListener;
> 
63,63c63,63
< import org.eclipse.gmf.runtime.diagram.core.listener.NotificationEvent;
---
> import org.eclipse.gmf.runtime.diagram.core.listener.NotificationUtil;
84a85,86
> import org.eclipse.gmf.runtime.emf.core.edit.MRunOption;
> 
105,105c107,107
< public abstract class CanonicalEditPolicy extends AbstractEditPolicy implements PropertyChangeListener {
---
> public abstract class CanonicalEditPolicy extends AbstractEditPolicy implements NotificationListener {
326a329,329
>         int options = MRunOption.UNCHECKED;
327,327c330,330
<         MEditingDomainGetter.getMEditingDomain ((View) getHost ().getModel ()).runAsUnchecked (new MRunnable () {
---
>         MEditingDomainGetter.getMEditingDomain ((View) getHost ().getModel ()).runWithOptions (new MRunnable () {
335a339,339
>         , options);
336,336d338
<         );
445,445c448,448
<     protected boolean addListenerFilter (String filterId, PropertyChangeListener listener, EObject element) {
---
>     protected boolean addListenerFilter (String filterId, NotificationListener listener, EObject element) {
453,453c456,456
<                 PresentationListener.getInstance ().addPropertyChangeListener (element, listener);
---
>                 PresentationListener.getInstance ().addNotificationListener (element, listener);
461,461c464,464
<     protected boolean addListenerFilter (String filterId, PropertyChangeListener listener, EObject element, EStructuralFeature feature) {
---
>     protected boolean addListenerFilter (String filterId, NotificationListener listener, EObject element, EStructuralFeature feature) {
469,469c472,472
<                 PresentationListener.getInstance ().addPropertyChangeListener (element, feature, listener);
---
>                 PresentationListener.getInstance ().addNotificationListener (element, feature, listener);
484,484c487,487
<             PresentationListener.getInstance ().removePropertyChangeListener ((EObject) objects [0], (EStructuralFeature) objects [1], (PropertyChangeListener) objects [2]);
---
>             PresentationListener.getInstance ().removeNotificationListener ((EObject) objects [0], (EStructuralFeature) objects [1], (NotificationListener) objects [2]);
486,486c489,489
<             PresentationListener.getInstance ().removePropertyChangeListener ((EObject) objects [0], (PropertyChangeListener) objects [1]);
---
>             PresentationListener.getInstance ().removeNotificationListener ((EObject) objects [0], (NotificationListener) objects [1]);
489a493,495
>     public final void notifyChanged (Notification notification) {
>         if (isHostStillValid ()) {
>             Object element = notification.getNotifier ();
490,493d492
<     public final void propertyChange (PropertyChangeEvent event) {
<         if (isHostStillValid () && event instanceof NotificationEvent) {
<             NotificationEvent ne = (NotificationEvent) event;
<             EObject element = ne.getElement ();
497,497c499,499
<             handleNotificationEvent (ne);
---
>             handleNotificationEvent (notification);
505,505c507,507
<     protected void handleSemanticEvent (NotificationEvent event) {
---
>     protected void handleSemanticEvent (Notification event) {
506,506d507
<         if (shouldHandleSemanticEvent (event)) {
509,509d509
<     }
511,511c511,511
<     protected boolean shouldHandleSemanticEvent (NotificationEvent event) {
---
>     protected boolean shouldHandleSemanticEvent (Notification event) {
512,512c512,512
<         return event.isElementAddedToSlot () || event.isElementRemovedFromSlot ();
---
>         return NotificationUtil.isElementAddedToSlot (event) || NotificationUtil.isElementRemovedFromSlot (event);
515,515c515,515
<     protected void handleNotificationEvent (NotificationEvent event) {
---
>     protected void handleNotificationEvent (Notification event) {
534,534c534,534
<     protected boolean shouldHandleNotificationEvent (NotificationEvent event) {
---
>     protected boolean shouldHandleNotificationEvent (Notification event) {
538,538c538,538
<         EObject element = event.getElement ();
---
>         Object element = event.getNotifier ();
539,539c539,539
<         return (! (element instanceof View) && (event.isElementAddedToSlot () || event.isElementRemovedFromSlot ()));
---
>         return (element instanceof EObject && ! (element instanceof View) && (NotificationUtil.isElementAddedToSlot (event) || NotificationUtil.isElementRemovedFromSlot (event)));
