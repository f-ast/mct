4a5,6
> import org.eclipse.emf.edit.domain.AdapterFactoryEditingDomain;
> 
7,7c25,25
< import org.eclipse.ui.views.properties.IPropertySourceProvider;
---
> import org.eclipse.ui.views.properties.IPropertySourceProvider;
7a26,26
> 
18a9,9
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
19,19d8
< import org.eclipse.gmf.runtime.emf.core.internal.util.MSLAdapterFactoryManager;
20a11,11
> import org.eclipse.emf.transaction.util.TransactionUtil;
20,20c10,10
< 
---
> 
29,29c33,33
<     protected static AdapterFactory getAdapterFactory () {
---
>     protected static AdapterFactory getAdapterFactory (Object object) {
29a34,35
>         TransactionalEditingDomain editingDomain = TransactionUtil.getEditingDomain (object);
>         if (editingDomain instanceof AdapterFactoryEditingDomain) {
30,30c36,36
<         return MSLAdapterFactoryManager.getAdapterFactory ();
---
>             return ((AdapterFactoryEditingDomain) editingDomain).getAdapterFactory ();
30a37,38
>         }
>         return null;
36a45,48
>             AdapterFactory adapterFactory = getAdapterFactory (object);
>             if (adapterFactory == null) {
>                 return null;
>             }
37,37c49,49
<             IItemPropertySource itemPropertySource = (IItemPropertySource) (getAdapterFactory ().adapt (object, IItemPropertySource.class));
---
>             IItemPropertySource itemPropertySource = (IItemPropertySource) (adapterFactory.adapt (object, IItemPropertySource.class));
