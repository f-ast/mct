67,67c17,17
< import org.eclipse.gmf.runtime.common.core.util.Log;
---
> import org.eclipse.gmf.runtime.common.core.util.Log;
68,68c18,18
< 
---
> 
69,69c19,19
< import org.eclipse.gmf.runtime.common.core.util.Trace;
---
> import org.eclipse.gmf.runtime.common.core.util.Trace;
70,70c20,20
< 
---
> 
71,71c21,21
< import org.eclipse.gmf.runtime.common.ui.action.actions.IPrintActionHelper;
---
> import org.eclipse.gmf.runtime.common.ui.action.actions.IPrintActionHelper;
72,72c22,22
< 
---
> 
73,73c23,23
< import org.eclipse.gmf.runtime.common.ui.util.WindowUtil;
---
> import org.eclipse.gmf.runtime.common.ui.util.WindowUtil;
74,74c24,24
< 
---
> 
75,75c25,25
< import org.eclipse.gmf.runtime.diagram.core.preferences.PreferencesHint;
---
> import org.eclipse.gmf.runtime.diagram.core.preferences.PreferencesHint;
76,76c26,26
< 
---
> 
77,77c27,27
< import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart;
78,78c28,28
< 
---
> 
79,79c29,29
< import org.eclipse.gmf.runtime.diagram.ui.editparts.IDiagramPreferenceSupport;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IDiagramPreferenceSupport;
80,80c30,30
< 
---
> 
81,81c31,31
< import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper;
---
> import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper;
82,82c32,32
< 
---
> 
83,83c33,33
< import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper.PageMargins;
---
> import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper.PageMargins;
84,84c34,34
< 
---
> 
85,85c35,35
< import org.eclipse.gmf.runtime.diagram.ui.internal.properties.WorkspaceViewerProperties;
---
> import org.eclipse.gmf.runtime.diagram.ui.internal.properties.WorkspaceViewerProperties;
86,86c36,36
< 
---
> 
87,87c37,37
< import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
---
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
88,88c38,38
< 
---
> 
89,89c39,39
< import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer;
---
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer;
90,90c40,40
< 
---
> 
91,91c41,41
< import org.eclipse.gmf.runtime.diagram.ui.parts.IDiagramWorkbenchPart;
---
> import org.eclipse.gmf.runtime.diagram.ui.parts.IDiagramWorkbenchPart;
92,92c42,42
< 
---
> 
93,93c43,43
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingDebugOptions;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingDebugOptions;
94,94c44,44
< 
---
> 
95,95c45,45
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingPlugin;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingPlugin;
96,96c46,46
< 
---
> 
97,97c47,47
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingStatusCodes;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingStatusCodes;
98,98c48,48
< 
---
> 
99,99c49,49
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.l10n.DiagramPrintingResourceManager;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.l10n.DiagramPrintingResourceManager;
100,100c50,50
< 
---
> 
101,101c51,51
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.HeaderAndFooterHelper;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.HeaderAndFooterHelper;
102,102c52,52
< 
---
> 
103,103c53,53
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelper;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelper;
104,104c54,54
< 
---
> 
105,105c55,55
< import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.MapModeGraphics;
---
> import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.MapModeGraphics;
106,106c56,56
< 
---
> 
107,107c57,57
< import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.ScaledGraphics;
---
> import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.ScaledGraphics;
108,108c58,58
< 
---
> 
108a59,59
> import org.eclipse.gmf.runtime.draw2d.ui.internal.mapmode.DiagramMapModeUtil;
109,109d58
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
110,110c60,60
< 
---
> 
110a61,61
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
111,111d60
< import org.eclipse.gmf.runtime.notation.Diagram;
112a63,66
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
> 
> import org.eclipse.gmf.runtime.notation.Diagram;
> 
112,112c62,62
< 
---
> 
410a415,420
>     private IMapMode mm;
> 
>     public PrintPreviewHelper (IMapMode mm) {
>         this.mm = mm;
>     }
> 
411a422,426
>         this (MapModeUtil.getMapMode ());
>     }
> 
>     protected IMapMode getMapMode () {
>         return mm;
521,521c536,536
<             float scale = ((float) imageHeight / (float) pageSize.y) / (float) MapMode.getScale ();
---
>             float scale = ((float) imageHeight / (float) pageSize.y) / (float) DiagramMapModeUtil.getScale (getMapMode ());
590,590c605,605
<             g.drawText (headerOrFooter, (pageSize.x - MapMode.DPtoLP (gc.textExtent (headerOrFooter).x)) / 2, HeaderAndFooterHelper.TOP_MARGIN);
---
>             g.drawText (headerOrFooter, (pageSize.x - getMapMode ().DPtoLP (gc.textExtent (headerOrFooter).x)) / 2, HeaderAndFooterHelper.TOP_MARGIN);
592,592c607,607
<             g.drawText (headerOrFooter, (pageSize.x - MapMode.DPtoLP (gc.textExtent (headerOrFooter).x)) / 2, pageSize.y - HeaderAndFooterHelper.BOTTOM_MARGIN);
---
>             g.drawText (headerOrFooter, (pageSize.x - getMapMode ().DPtoLP (gc.textExtent (headerOrFooter).x)) / 2, pageSize.y - HeaderAndFooterHelper.BOTTOM_MARGIN);
640,640c655,655
<         return new MapModeGraphics (scaledGraphics);
---
>         return new MapModeGraphics (scaledGraphics, getMapMode ());
