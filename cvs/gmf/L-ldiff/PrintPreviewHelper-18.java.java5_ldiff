111,111c111,111
< import org.eclipse.swt.widgets.Button;
---
> import org.eclipse.swt.widgets.Combo;
176a177,178
>     private int [] zoomLevels = {25, 50, 75, 100, 150, 200, 250, 300, 400};
>     private static final String FIT_TO_PAGES = DiagramUIPrintingMessages.PrintPreview_FitToPage_ButtonText;
198a201,201
>         if (! fitToPage) {
199a203,203
>         }
427a432,436
>         final Combo zoomCombo = new Combo (bar, SWT.DROP_DOWN);
>         zoomCombo.add (FIT_TO_PAGES);
>         for (int i = 0;
>         i < zoomLevels.length; i ++) {
>             zoomCombo.add (getDisplayScale (zoomLevels [i]));
428,437d431
<         final Text textField = new Text (bar, SWT.SINGLE | SWT.BORDER);
<         textField.setText ("XXXXX");
<         textField.setEnabled (true);
<         textField.pack ();
<         textField.setText (getDisplayScale (PrintHelperUtil.getScale ()));
<         separator.setWidth (textField.getBounds ().width);
<         separator.setControl (textField);
<         textField.addSelectionListener (new SelectionListener () {
< 
<             public void widgetSelected (SelectionEvent e) {
438a438,444
>         if (this.fitToPage) {
>             zoomCombo.setText (FIT_TO_PAGES);
>             zoomCombo.select (0);
>         } else {
>             zoomCombo.setText (getDisplayScale (PrintHelperUtil.getScale ()));
>         }
>         zoomCombo.addSelectionListener (new SelectionAdapter () {
439a446,447
>             private void doZoom (Combo combo) {
>                 String scaleFactor = combo.getText ();
440,441d445
<             public void widgetDefaultSelected (SelectionEvent e) {
<                 String scaleFactor = ((Text) e.getSource ()).getText ();
449,449c455,455
<                 ((Text) e.getSource ()).setText (getDisplayScale (scalePercentage));
---
>                 combo.setText (getDisplayScale (scalePercentage));
454,464d461
<         );
<         new ToolItem (bar, SWT.SEPARATOR);
<         ToolItem fitToPageSeparator = new ToolItem (bar, SWT.SEPARATOR);
<         Button buttonFitToPage = new Button (bar, SWT.PUSH);
<         buttonFitToPage.setText (DiagramUIPrintingMessages.PrintPreview_FitToPage_ButtonText);
<         buttonFitToPage.setEnabled (true);
<         buttonFitToPage.pack ();
<         fitToPageSeparator.setWidth (buttonFitToPage.getBounds ().width);
<         fitToPageSeparator.setControl (buttonFitToPage);
<         buttonFitToPage.addSelectionListener (new SelectionListener () {
< 
465a463,464
>                 String selectedString = ((Combo) e.getSource ()).getText ();
>                 if (FIT_TO_PAGES.compareToIgnoreCase (selectedString) == 0) {
474,474d472
<                     textField.setText (getDisplayScale (PrintHelperUtil.getScale ()));
475a474,475
>                 } else {
>                     doZoom ((Combo) e.getSource ());
477,477d457
< 
478a459,459
>                 doZoom ((Combo) e.getSource ());
478,478c458,458
<             public void widgetDefaultSelected (SelectionEvent e) {
---
>             public void widgetDefaultSelected (SelectionEvent e) {
483a482,484
>         zoomCombo.pack ();
>         separator.setWidth (zoomCombo.getSize ().x);
>         separator.setControl (zoomCombo);
853,853c854,854
<         setUserScale (Math.min (hScale, vScale));
---
>         userScale = Math.min (hScale, vScale) / 100f;
