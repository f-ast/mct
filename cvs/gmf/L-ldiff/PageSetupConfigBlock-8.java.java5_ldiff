163,163c163,163
<                     fTextHeight.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [index].getWidth ())));
---
>                     fTextWidth.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [index].getWidth ())));
210a222,222
>         boolean marginsValid = false;
211,211d221
<         if (null == fPreferencePage) {
212a224,229
>             if (fButtonPortrait.getSelection ()) marginsValid = ((getDblFromString (fTextMarginTop.getText ()) + getDblFromString (fTextMarginBottom.getText ())) < getDblFromString (fTextHeight.getText ())) && ((getDblFromString (fTextMarginLeft.getText ()) + getDblFromString (fTextMarginRight.getText ())) < getDblFromString (fTextWidth.getText ()));
>             else marginsValid = ((getDblFromString (fTextMarginTop.getText ()) + getDblFromString (fTextMarginBottom.getText ())) < getDblFromString (fTextWidth.getText ())) && ((getDblFromString (fTextMarginLeft.getText ()) + getDblFromString (fTextMarginRight.getText ())) < getDblFromString (fTextHeight.getText ()));
> 
>         }
>         if (null == fPreferencePage) {
>             if (allValid && marginsValid) {
222,222c239,239
<             if (allValid) {
---
>             if (allValid && marginsValid) {
405a423,431
>             double value = fStore.getDouble (key);
>             text.setText (fNumberFormat.format (value));
>             if (isConversionNeeded ()) {
>                 if (fBlockPrint.fComboSize.getSelectionIndex () != PageSetupPageType.USER_DEFINED.getIndex ()) {
>                     if (text == fBlockPrint.fTextHeight) fBlockPrint.fTextHeight.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [fBlockPrint.fComboSize.getSelectionIndex ()].getHeight ())));
>                     else if (text == fBlockPrint.fTextWidth) fBlockPrint.fTextWidth.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [fBlockPrint.fComboSize.getSelectionIndex ()].getWidth ())));
>                     else text.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (value)));
> 
>                 } else text.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (value)));
405a209,213
>     private double getDblFromString (String strNum) {
>         try {
>             Number num = null;
>             num = fNumberFormat.parse (strNum);
>             return num.doubleValue ();
406,409d208
<             String value = fStore.getString (key);
<             try {
<                 Number num = fNumberFormat.parse (value);
<                 text.setText (fNumberFormat.format (num.doubleValue ()));
410,410c214,214
<             } catch (ParseException e) {
---
>         } catch (ParseException e) {
411,411c215,215
<                 e.printStackTrace ();
---
>             e.printStackTrace ();
412a217,219
>         return - 1;
>     }
> 
412,412c216,216
<             }
---
>         }
413,413d216
<             if (isConversionNeeded ()) text.setText (fNumberFormat.format (fConvertor.convertToMillimetres (controlType)));
415a434,434
>         }
473,473c492,492
<                 fStore.setValue (key, text.getText ());
---
>                 fStore.setValue (key, getDblFromString (text.getText ()));
533,533c552,552
<             return inches / 0.0394;
---
>             return inches * 25.4d;
536,536c555,555
<         private double convertMilimToInches (double milim) {
---
>         public double convertMilimToInches (double milim) {
537,537c556,556
<             return milim * 0.0394;
---
>             return milim / 25.4d;
622a642,642
>             if (fComboSize.getSelectionIndex () == PageSetupPageType.USER_DEFINED.getIndex ()) {
624a645,648
>             } else {
>                 fTextWidth.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [fComboSize.getSelectionIndex ()].getWidth ())));
>                 fTextHeight.setText (fNumberFormat.format (fConvertor.convertInchesToMilim (PageSetupPageType.pages [fComboSize.getSelectionIndex ()].getHeight ())));
>             }
