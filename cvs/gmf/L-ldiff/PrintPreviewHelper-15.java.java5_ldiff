160a161,161
>     protected double userScale = 1;
476,476c477,477
<         float numRows = ((float) getBounds ().height) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).y;
---
>         float numRows = ((float) (getBounds ().height * userScale)) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).y;
495,495c496,496
<             pageBreakBounds = PrintHelperUtil.getPageBreakBounds (getDiagramEditPart (), true);
---
>             pageBreakBounds = PrintHelperUtil.getPageBreakBounds (getDiagramEditPart (), true).getCopy ();
535,535c536,536
<         float numCols = ((float) getBounds ().width) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).x;
---
>         float numCols = ((float) (getBounds ().width * userScale)) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).x;
582a584,587
>         margins.left /= userScale;
>         margins.right /= userScale;
>         margins.bottom /= userScale;
>         margins.top /= userScale;
584,584c589,589
<             float scale = ((float) imageHeight / (float) pageSize.y) / (float) DiagramMapModeUtil.getScale (getMapMode ());
---
>             float scale = (imageHeight / (float) pageSize.y) / (float) DiagramMapModeUtil.getScale (getMapMode ());
584a590,590
>             scale *= userScale;
649a656,657
>         int scaledPageSizeWidth = (int) (pageSize.x / userScale);
>         int scaledPageSizeHeight = (int) (pageSize.y / userScale);
650,650d655
<         int translateX = (int) (0f - bounds.x * scale + ((float) getTotalNumberOfColumns () * pageSize.x - bounds.width) * scale / 2f - (((float) pageSize.x) * ((float) (col + userX)) * scale)), translateY = (int) (0f - bounds.y * scale + ((float) getTotalNumberOfRows () * pageSize.y - bounds.height) * scale / 2f - (((float) pageSize.y) * ((float) (row + userY)) * scale));
651,651c658,658
<         translateX = - bounds.x - (pageSize.x * (col + userX)) + (margins.left * (col + userX + 1)) + (margins.right * (col + userX));
---
>         int translateX = - bounds.x - (scaledPageSizeWidth * (col + userX)) + (margins.left * (col + userX + 1)) + (margins.right * (col + userX));
652,652c659,659
<         translateY = - bounds.y - (pageSize.y * (row + userY)) + (margins.top * (row + userY + 1)) + (margins.bottom * (row + userY));
---
>         int translateY = - bounds.y - (scaledPageSizeHeight * (row + userY)) + (margins.top * (row + userY + 1)) + (margins.bottom * (row + userY));
664,664c671,671
<         Rectangle clip = new Rectangle ((pageSize.x - margins.left - margins.right) * (col + userX) + bounds.x, (pageSize.y - margins.top - margins.bottom) * (row + userY) + bounds.y, pageSize.x - margins.left - margins.right, pageSize.y - margins.top - margins.bottom);
---
>         Rectangle clip = new Rectangle ((scaledPageSizeWidth - margins.left - margins.right) * (col + userX) + bounds.x, (scaledPageSizeHeight - margins.top - margins.bottom) * (row + userY) + bounds.y, scaledPageSizeWidth - margins.left - margins.right, scaledPageSizeHeight - margins.top - margins.bottom);
713a721,724
>     public void setUserScale (double userScale) {
>         this.userScale = userScale;
>     }
> 
