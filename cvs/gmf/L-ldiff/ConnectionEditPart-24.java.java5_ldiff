30a31,32
> import org.eclipse.draw2d.ConnectionLayer;
> 
668,668c670,670
<         ConnectionLayerEx cLayer = (ConnectionLayerEx) getLayer (LayerConstants.CONNECTION_LAYER);
---
>         ConnectionLayer cLayer = (ConnectionLayer) getLayer (LayerConstants.CONNECTION_LAYER);
670,670c672,672
<         if (style != null) {
---
>         if (style != null && cLayer instanceof ConnectionLayerEx) {
670a673,673
>             ConnectionLayerEx cLayerEx = (ConnectionLayerEx) cLayer;
673,673c676,676
<                 getConnectionFigure ().setConnectionRouter (cLayer.getObliqueRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getObliqueRouter ());
675,675c678,678
<                 getConnectionFigure ().setConnectionRouter (cLayer.getRectilinearRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getRectilinearRouter ());
677,677c680,680
<                 getConnectionFigure ().setConnectionRouter (cLayer.getTreeRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getTreeRouter ());
