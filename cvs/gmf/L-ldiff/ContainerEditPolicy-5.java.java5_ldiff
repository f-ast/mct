67,68d66
< import org.eclipse.gmf.runtime.diagram.ui.editparts.ShapeCompartmentEditPart;
< 
71,72d68
< import org.eclipse.gmf.runtime.diagram.ui.editparts.TopGraphicEditPart;
< 
279,282d274
<                 TopGraphicEditPart topEP = ((IGraphicalEditPart) ep).getTopGraphicEditPart ();
<                 if (topEP != null && topEP.getParent () instanceof ShapeCompartmentEditPart) {
<                     return null;
<                 }
312,312c304,304
<                 if (duplicateElementsCommand != null) {
---
>                 if (duplicateElementsCommand != null && duplicateElementsCommand.canExecute ()) {
