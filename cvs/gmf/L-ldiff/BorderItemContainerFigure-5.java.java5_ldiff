2a3,4
> import java.util.Iterator;
> 
4a7,8
> import org.eclipse.draw2d.Figure;
> 
23a28,28
>     private Rectangle extendedBounds = new Rectangle ();
126a132,136
>         Rectangle rect = _getParentRectangle ();
>         return rect.union (getExtendedBounds ());
>     }
> 
>     private Rectangle _getParentRectangle () {
179a190,231
>     public void invalidate () {
>         extendedBounds = null;
>         super.invalidate ();
>     }
> 
>     public void validate () {
>         extendedBounds = null;
>         super.validate ();
>     }
> 
>     public Rectangle getExtendedBounds () {
>         if (extendedBounds == null) extendedBounds = getExtendedBounds (getParent ()).getCopy ();
> 
>         return extendedBounds;
>     }
> 
>     private Rectangle getExtendedBounds (IFigure figure) {
>         if (figure == null) return getBounds ().getCopy ();
>         else {
>             Rectangle _bounds = figure.getBounds ().getCopy ();
>             if (figure instanceof BorderedNodeFigure) {
>                 BorderedNodeFigure borderedFigure = (BorderedNodeFigure) figure;
>                 BorderItemContainerFigure borderedItemContainer = (BorderItemContainerFigure) borderedFigure.getBorderItemContainer ();
>                 if (borderedItemContainer != null) {
>                     Iterator iterator = borderedItemContainer.getChildren ().iterator ();
>                     while (iterator.hasNext ()) {
>                         Figure element = (Figure) iterator.next ();
>                         if (element instanceof BorderedNodeFigure) {
>                             BorderedNodeFigure childbFigure = (BorderedNodeFigure) element;
>                             BorderItemContainerFigure childBorderedItemContainer = (BorderItemContainerFigure) childbFigure.getBorderItemContainer ();
>                             if (childBorderedItemContainer != null) _bounds.union (childBorderedItemContainer.getExtendedBounds ());
>                             else _bounds.union (childbFigure.getBounds ());
> 
>                         } else _bounds.union (element.getBounds ());
> 
>                     }
>                 }
>             }
>             return _bounds;
>         }
>     }
> 
