13,14d12
< import org.eclipse.gmf.gmfgraph.Layoutable;
< 
363,374d360
<         final java.util.List < org.eclipse.core.resources.IFile > files = java.util.Collections.singletonList (org.eclipse.emf.workspace.util.WorkspaceSynchronizer.getFile (getInput ().eResource ()));
<         org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand cmd = new org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand (org.eclipse.emf.transaction.util.TransactionUtil.getEditingDomain (getInput ()), "", files) {
< 
<             @Override
<             protected org.eclipse.gmf.runtime.common.core.command.CommandResult doExecuteWithResult (org.eclipse.core.runtime.IProgressMonitor monitor, org.eclipse.core.runtime.IAdaptable info) throws org.eclipse.core.commands.ExecutionException {
<                 commit ();
<                 return org.eclipse.gmf.runtime.common.core.command.CommandResult.newOKCommandResult ();
<             }
< 
<         }
< 
<         ;
376a363,363
>             commit ();
377,379d362
<             org.eclipse.core.commands.operations.OperationHistoryFactory.getOperationHistory ().execute (cmd, new org.eclipse.core.runtime.NullProgressMonitor (), null);
<         } catch (org.eclipse.core.commands.ExecutionException ex) {
<             ex.printStackTrace ();
388a373,374
>     protected Object unwrap (Object element) {
>         return element;
389,406d372
<     private Object unwrap (Object element) {
<         Object rv = null;
<         if (element instanceof org.eclipse.gef.EditPart) {
<             Object model = ((org.eclipse.gef.EditPart) element).getModel ();
<             rv = model instanceof org.eclipse.gmf.runtime.notation.View ? ((org.eclipse.gmf.runtime.notation.View) model).getElement () : null;
<         } else if (element instanceof org.eclipse.gmf.runtime.notation.View) {
<             rv = ((org.eclipse.gmf.runtime.notation.View) element).getElement ();
<         } else if (element instanceof org.eclipse.core.runtime.IAdaptable) {
<             org.eclipse.gmf.runtime.notation.View view = (org.eclipse.gmf.runtime.notation.View) ((org.eclipse.core.runtime.IAdaptable) element).getAdapter (org.eclipse.gmf.runtime.notation.View.class);
<             if (view != null) {
<                 rv = view.getElement ();
<             }
<         }
< 
<         if (rv instanceof Layoutable) {
<             return rv;
<         }
<         return null;
449,449c417,417
<     private Figure getInput () {
---
>     protected Figure getInput () {
