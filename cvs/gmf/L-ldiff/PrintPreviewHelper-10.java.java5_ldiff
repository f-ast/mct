129,130d128
<     protected int totalNumberOfRows = - 1;
<     protected int totalNumberOfColumns = - 1;
191,192d188
<         totalNumberOfRows = - 1;
<         totalNumberOfColumns = - 1;
204a201,203
>         int style = PlatformUI.getWorkbench ().getActiveWorkbenchWindow ().getShell ().getStyle ();
>         if ((style & SWT.MIRRORED) != 0) {
>             shell = new Shell (display, SWT.APPLICATION_MODAL | SWT.TITLE | SWT.CLOSE | SWT.BORDER | SWT.RIGHT_TO_LEFT);
205,205c204,204
<         shell = new Shell (display, SWT.APPLICATION_MODAL | SWT.TITLE | SWT.CLOSE | SWT.BORDER);
---
>         } else shell = new Shell (display, SWT.APPLICATION_MODAL | SWT.TITLE | SWT.CLOSE | SWT.BORDER);
205a205,205
> 
310a311,315
>         if ((style & SWT.MIRRORED) != 0) {
>             leftTool.setToolTipText (DiagramUIPrintingMessages.PrintPreview_RightToolItem);
>             leftTool.setImage (rightImage);
>             leftTool.setDisabledImage (disabledRightImage);
>         } else {
313a319,319
>         }
331a338,342
>         if ((style & SWT.MIRRORED) != 0) {
>             rightTool.setToolTipText (DiagramUIPrintingMessages.PrintPreview_LeftToolItem);
>             rightTool.setImage (leftImage);
>             rightTool.setDisabledImage (disabledLeftImage);
>         } else {
334a346,346
>         }
456,456d467
<         if (totalNumberOfRows < 0) {
457,457c468,468
<             float numRows = ((float) getBounds ().height) / PageInfoHelper.getPageSize (getPreferenceStore (), false, getMapMode ()).y;
---
>         float numRows = ((float) getBounds ().height) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).y;
458,458c469,469
<             totalNumberOfRows = Math.max (1, (int) Math.ceil (numRows));
---
>         return Math.max (1, (int) Math.ceil (numRows));
459,460d469
<         }
<         return totalNumberOfRows;
508,508d516
<         if (totalNumberOfColumns < 0) {
509,509c517,517
<             float numCols = ((float) getBounds ().width) / PageInfoHelper.getPageSize (getPreferenceStore (), false, getMapMode ()).x;
---
>         float numCols = ((float) getBounds ().width) / PageInfoHelper.getPageSize (getPreferenceStore (), true, getMapMode ()).x;
510,510c518,518
<             totalNumberOfColumns = Math.max (1, (int) Math.ceil (numCols));
---
>         return Math.max (1, (int) Math.ceil (numCols));
511,512d518
<         }
<         return totalNumberOfColumns;
605a612,614
>         GC gc = null;
>         if ((shell.getStyle () & SWT.MIRRORED) != 0) {
>             gc = new GC (image, SWT.RIGHT_TO_LEFT);
606a616,616
> 
606,606c615,615
<         GC gc = new GC (image);
---
>         } else gc = new GC (image);
