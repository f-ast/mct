214a215,215
>         double gridSpacing = 0;
215,215c216,216
<         double gridSpacing = getWorkspaceViewerPreferences ().getDouble (WorkspaceViewerProperties.GRIDSPACING);
---
>         if (getWorkspaceViewerPreferences () != null) gridSpacing = getWorkspaceViewerPreferences ().getDouble (WorkspaceViewerProperties.GRIDSPACING);
215a217,217
> 
234a237,237
>         int rulerUnits = RulerProvider.UNIT_INCHES;
235a239,239
> 
235,235c238,238
<         int rulerUnits = getWorkspaceViewerPreferences ().getInt (WorkspaceViewerProperties.RULERUNIT);
---
>         if (getWorkspaceViewerPreferences () != null) rulerUnits = getWorkspaceViewerPreferences ().getInt (WorkspaceViewerProperties.RULERUNIT);
361a366,366
> 
361,361c365,365
<         setRulers (getWorkspaceViewerPreferences ().getInt (WorkspaceViewerProperties.RULERUNIT));
---
>         if (getWorkspaceViewerPreferences () != null) setRulers (getWorkspaceViewerPreferences ().getInt (WorkspaceViewerProperties.RULERUNIT));
387a393,393
>         if (wsPrefStore != null) {
406a413,413
>     }
