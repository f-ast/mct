203,208d202
<         Rectangle rect = null;
<         Node parent = n.getParent ();
<         while (parent != null && ! (parent.data instanceof IGraphicalEditPart)) parent = parent.getParent ();
< 
<         if (parent != null) {
<             rect = new Rectangle (n.x - parent.x, n.y - parent.y, n.width, n.height);
209,209c203,203
<         } else rect = new Rectangle (n.x, n.y, n.width, n.height);
---
>         Rectangle rect = new Rectangle (n.x, n.y, n.width, n.height);
210,210d203
< 
415,415c408,408
<     Command routeThrough (Edge edge, ConnectionEditPart connectEP, Node source, Node target, PointList points, int diffX, int diffY) {
---
>     protected Command routeThrough (Edge edge, ConnectionEditPart connectEP, Node source, Node target, PointList points, int diffX, int diffY) {
428,436d420
<         Node parent = null;
<         parent = source.getParent ();
<         if (parent == null) parent = target.getParent ();
< 
<         if (parent != null) {
<             Rectangle targetExt = getNodeMetrics (parent);
<             totalEdgeDiffX += targetExt.preciseX ();
<             totalEdgeDiffY += targetExt.preciseY ();
<         }
481,481c465,465
<             resultantSourceAnchorReference = new PrecisionPoint (sourceExt.preciseWidth () * sourceRatio.preciseX () + sourceExt.preciseX (), targetExt.preciseHeight () * sourceRatio.preciseY () + sourceExt.preciseY ());
---
>             resultantSourceAnchorReference = new PrecisionPoint (sourceExt.preciseWidth () * sourceRatio.preciseX () + sourceExt.preciseX (), sourceExt.preciseHeight () * sourceRatio.preciseY () + sourceExt.preciseY ());
538,541d521
<         Rectangle start = translateFromGraph (new Rectangle (pointList.getFirstPoint ().x, pointList.getFirstPoint ().y, 0, 0));
<         points.addPoint (start.getLocation ());
<         NodeList vnodes = edge.vNodes;
<         if (vnodes != null) {
543,547d522
<             i < vnodes.size (); i ++) {
<                 Node vn = vnodes.getNode (i);
<                 Rectangle nodeExt = getNodeMetrics (vn);
<                 points.addPoint (nodeExt.getCenter ());
<             }
548a523,524
>         i < pointList.size (); i ++) {
>             Rectangle pt = translateFromGraph (new Rectangle (pointList.getPoint (i), new Dimension ()));
549,549d522
<         Rectangle end = translateFromGraph (new Rectangle (pointList.getLastPoint ().x, pointList.getLastPoint ().y, 0, 0));
550,550c525,525
<         points.addPoint (end.getLocation ());
---
>             points.addPoint (pt.getLocation ());
