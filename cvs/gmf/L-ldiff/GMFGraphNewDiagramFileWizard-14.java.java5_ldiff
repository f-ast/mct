5,6d4
< import java.util.Collections;
< 
16a53,53
> import org.eclipse.osgi.util.NLS;
17,17d52
< import org.eclipse.core.runtime.CoreException;
18,18c54,54
< 
---
> 
64,64c64,64
<     public GMFGraphNewDiagramFileWizard (org.eclipse.emf.common.util.URI domainModelURI, EObject diagramRoot, TransactionalEditingDomain editingDomain) {
---
>     public GMFGraphNewDiagramFileWizard (URI domainModelURI, EObject diagramRoot, TransactionalEditingDomain editingDomain) {
68,68c68,68
<         myFileCreationPage = new WizardNewFileCreationPage ("Initialize new diagram file", StructuredSelection.EMPTY);
---
>         myFileCreationPage = new WizardNewFileCreationPage (Messages.GMFGraphNewDiagramFileWizard_CreationPageName, StructuredSelection.EMPTY);
69,69c69,69
<         myFileCreationPage.setTitle ("Diagram file");
---
>         myFileCreationPage.setTitle (Messages.GMFGraphNewDiagramFileWizard_CreationPageTitle);
70,70c70,70
<         myFileCreationPage.setDescription ("Create new diagram based on " + CanvasEditPart.MODEL_ID + " model content");
---
>         myFileCreationPage.setDescription (NLS.bind (Messages.GMFGraphNewDiagramFileWizard_CreationPageDescription, CanvasEditPart.MODEL_ID));
82a83,85
>         diagramRootElementSelectionPage = new DiagramRootElementSelectionPage (Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageName);
>         diagramRootElementSelectionPage.setTitle (Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageTitle);
>         diagramRootElementSelectionPage.setDescription (Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageDescription);
83,85d82
<         diagramRootElementSelectionPage = new DiagramRootElementSelectionPage ("Select diagram root element");
<         diagramRootElementSelectionPage.setTitle ("Diagram root element");
<         diagramRootElementSelectionPage.setDescription ("Select semantic model element to be depicted on diagram");
97a98,98
>         GMFGraphDiagramEditorUtil.setCharset (diagramFile);
98,102d97
<         try {
<             diagramFile.setCharset ("UTF-8", new NullProgressMonitor ());
<         } catch (CoreException e) {
<             GMFGraphDiagramEditorPlugin.getInstance ().logError ("Unable to set charset for diagram file", e);
<         }
103a25,26
> import org.eclipse.emf.common.util.URI;
> 
103a100,100
>         URI diagramModelURI = URI.createPlatformResourceURI (diagramFile.getFullPath ().toString (), true);
104,104d24
<         org.eclipse.emf.common.util.URI diagramModelURI = org.eclipse.emf.common.util.URI.createPlatformResourceURI (diagramFile.getFullPath ().toString (), true);
107,107c103,103
<         AbstractTransactionalCommand command = new AbstractTransactionalCommand (myEditingDomain, "Initializing diagram contents", affectedFiles) {
---
>         AbstractTransactionalCommand command = new AbstractTransactionalCommand (myEditingDomain, Messages.GMFGraphNewDiagramFileWizard_InitDiagramCommand, affectedFiles) {
111a108,108
>                     return CommandResult.newErrorCommandResult (Messages.GMFGraphNewDiagramFileWizard_IncorrectRootError);
112,112d107
<                     return CommandResult.newErrorCommandResult ("Incorrect model object stored as a root resource object");
124,124c120,120
<             diagramResource.save (Collections.EMPTY_MAP);
---
>             diagramResource.save (GMFGraphDiagramEditorUtil.getSaveOptions ());
142a139,139
>             return Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageSelectionTitle;
143,143d138
<             return "Select diagram root element:";
147a144,144
>                 setErrorMessage (Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageNoSelectionMessage);
148,148d143
<                 setErrorMessage ("Diagram root element is not selected");
151a148,148
>             setErrorMessage (result ? null : Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageInvalidSelectionMessage);
152,152d147
<             setErrorMessage (result ? null : "Invalid diagram root element is selected");
