2a5,5
> import java.io.InputStream;
3,3d4
< import java.io.FileInputStream;
4,4c6,6
< 
---
> 
5,6d6
< import java.io.FileNotFoundException;
< 
20a19,20
> import org.eclipse.core.runtime.Path;
> 
28a29,30
> import org.osgi.framework.Bundle;
> 
65a68,72
>             Bundle bundle = Platform.getBundle (element.getDeclaringExtension ().getNamespace ());
>             assert bundle != null;
>             URL url = Platform.find (bundle, new Path (relativePath));
>             if (url == null) {
>                 Log.error (CommonCorePlugin.getDefault (), CommonCoreStatusCodes.SERVICE_FAILURE, "Couldn't find relative path " + relativePath + " in " + element.getDeclaringExtension ().getNamespace ());
66,71d67
<             URL installURL = Platform.getBundle (element.getDeclaringExtension ().getNamespace ()).getEntry ("/");
<             URL resolveURL = null;
<             try {
<                 resolveURL = Platform.resolve (installURL);
<             } catch (IOException e1) {
<                 assert (false);
72a74,74
>             InputStream is = null;
73,74d73
<             String fullPath = resolveURL.getFile () + relativePath;
<             Properties properties = new Properties ();
76,78d75
<                 FileInputStream stream = new FileInputStream (fullPath);
<                 properties.load (stream);
<             } catch (FileNotFoundException e) {
79a82,85
>             } finally {
>                 if (is != null) {
>                     try {
>                         is.close ();
80,80d81
<                 continue;
83,83d87
<                 continue;
84a89,90
>                 }
>             }
84a76,78
>                 is = url.openStream ();
>                 Properties properties = new Properties ();
>                 properties.load (is);
85,85c79,79
<             propertiesMap.putAll (properties);
---
>                 propertiesMap.putAll (properties);
85a80,80
>             } catch (IOException e) {
