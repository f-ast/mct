2a3,4
> import java.util.ArrayList;
> 
3a6,9
> 
> import java.util.List;
> 
> import org.eclipse.core.resources.IFile;
3,3c5,5
< import java.util.Collection;
---
> import java.util.Iterator;
10a17,19
> import org.eclipse.emf.ecore.resource.Resource;
> 
> import org.eclipse.emf.workspace.util.WorkspaceSynchronizer;
11,11c23,23
< import org.eclipse.gmf.runtime.common.core.command.AbstractCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand;
11a24,24
> 
17,17c27,27
< public abstract class EditElementCommand extends AbstractCommand {
---
> public abstract class EditElementCommand extends AbstractTransactionalCommand {
22a33,33
>         super (request.getEditingDomain (), label, getAffectedFiles (request));
23,23d32
<         super (label);
27a56,56
>     public boolean canExecute () {
27a38,49
>     protected static List getAffectedFiles (IEditCommandRequest request) {
>         List result = new ArrayList ();
>         List elements = request.getElementsToEdit ();
>         if (elements != null) {
>             for (Iterator i = elements.iterator ();
>             i.hasNext ();) {
>                 Resource resource = ((EObject) i.next ()).eResource ();
>                 if (resource != null) {
>                     IFile file = WorkspaceSynchronizer.getFile (resource);
>                     if (file != null) {
>                         result.add (file);
>                     }
28,28d55
<     public boolean isExecutable () {
29,29c57,57
<         if (getEClass () != null) {
---
>         if (getEClass () != null) {
30,30c58,58
<             return getEClass ().isSuperTypeOf (getEClassToEdit ());
---
>             return getEClass ().isSuperTypeOf (getEClassToEdit ());
30a59,59
>         }
31a52,52
>         }
32,32c53,53
<         return true;
---
>         return result;
34,36d51
< 
<     public boolean isUndoable () {
<         return true;
39,39d55
<     public boolean isRedoable () {
71,74d90
<     public Collection getAffectedObjects () {
<         return request.getElementsToEdit ();
<     }
< 
