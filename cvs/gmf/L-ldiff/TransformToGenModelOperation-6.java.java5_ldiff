4a5,6
> import java.text.MessageFormat;
> 
30a33,34
> import org.eclipse.emf.ecore.EObject;
> 
74,74d77
<     private URI myMapModelURI;
79a83,83
>     private IStatus myLoadMapmodelStatus = Status.CANCEL_STATUS;
80,80d82
<     private IStatus myLoadMapmodelStatus;
81,81c84,84
<     private IStatus myStaleGenmodelStatus;
---
>     private IStatus myStaleGenmodelStatus = Status.CANCEL_STATUS;
82a86,86
>     public TransformToGenModelOperation () {
83,85d85
<     public TransformToGenModelOperation (URI mapURI) {
<         assert mapURI != null;
<         this.myMapModelURI = mapURI;
93,96d93
<     public URI getMapURI () {
<         return this.myMapModelURI;
<     }
< 
101,101c98,98
<     void setGenURI (URI gmfGen) {
---
>     public void setGenURI (URI gmfGen) {
105,105c102,102
<     private GenModel getGenModel () {
---
>     public GenModel getGenModel () {
113,113c110,110
<     private void setMapping (Mapping m) {
---
>     private void setMapping (Mapping m, IStatus loadStatus) {
114a112,112
>         this.myLoadMapmodelStatus = loadStatus;
115,115c113,113
<         myGMDetector = null;
---
>         myGMDetector = (m != null) ? new GenModelDetector (m) : null;
118a117,117
>     public GenModelDetector getGenModelDetector () {
119,122d116
<     GenModelDetector getGenModelDetector () {
<         if (myGMDetector == null) {
<             myGMDetector = new GenModelDetector (getMapping ());
<         }
126,126c121,121
<     IStatus getLoadMappingStatus () {
---
>     public IStatus getLoadMappingStatus () {
130,130c125,125
<     IStatus getStaleGenmodelStatus () {
---
>     public IStatus getStaleGenmodelStatus () {
134a130,131
>         Mapping content = null;
>         IStatus status = Status.CANCEL_STATUS;
134,134c129,129
<     Mapping loadMappingModel (ResourceSet rs, URI uri, IProgressMonitor pm) throws CoreException {
---
>     public Mapping loadMappingModel (ResourceSet rs, URI uri, IProgressMonitor pm) throws CoreException {
136a134,137
>             checkResourceSet (rs);
>             if (uri == null) {
>                 throw new IllegalArgumentException (Messages.TransformToGenModelOperation_e_null_map_uri);
>             }
141a143,144
>             status = loadHelper.getStatus ();
>             if (! status.isOK ()) {
142,143d142
<             IStatus loadStatus = loadHelper.getStatus ();
<             if (! loadStatus.isOK ()) {
144,144c145,145
<                 throw new CoreException (loadStatus);
---
>                 throw new CoreException (status);
146a148,154
>             EObject root = loadHelper.getContentsRoot ();
>             if (! (root instanceof Mapping)) {
>                 String msg = MessageFormat.format (Messages.TransformToGenModelOperation_e_wrong_root_element, root.getClass ().getName ());
>                 status = Plugin.createError (msg, null);
>                 throw new CoreException (status);
>             }
>             content = (Mapping) loadHelper.getContentsRoot ();
147,147d147
<             final Mapping content = (Mapping) loadHelper.getContentsRoot ();
149a157,157
>             status = getFirst (mapIsValid);
150,150d156
<             IStatus mapStatus = getFirst (mapIsValid);
151,151c158,158
<             if (Diagnostic.CANCEL == mapStatus.getSeverity ()) {
---
>             if (Diagnostic.CANCEL == status.getSeverity ()) {
153,153c160,160
<             } else if (Diagnostic.ERROR == mapStatus.getSeverity ()) {
---
>             } else if (Diagnostic.ERROR == status.getSeverity ()) {
154,154c161,161
<                 throw new CoreException (mapStatus);
---
>                 throw new CoreException (status);
156,157d162
<                 setMapping (content);
<                 this.myLoadMapmodelStatus = mapStatus;
160a166,170
>         } catch (CoreException e) {
>             throw e;
>         } catch (Exception e) {
>             IStatus error = Plugin.createError (Messages.TransformToGenModelOperation_e_load_mapping_model, e);
>             throw new CoreException (error);
161a172,173
>             setMapping (content, status);
>             if (monitor != null) {
164a177,177
>     }
166,166c179,179
<     GenModel findGenmodel (ResourceSet rs) throws CoreException {
---
>     public GenModel findGenmodel (ResourceSet rs) throws CoreException {
167a181,182
>             checkResourceSet (rs);
>             checkMapping ();
182,182c197,197
<     GenModel loadGenModel (ResourceSet rs, URI uri, IProgressMonitor pm) throws CoreException {
---
>     public GenModel loadGenModel (ResourceSet rs, URI uri, IProgressMonitor pm) throws CoreException {
184a200,201
>             checkResourceSet (rs);
>             checkMapping ();
228,228c245,245
<     IStatus executeTransformation (ResourceSet rs, IProgressMonitor pm) {
---
>     public IStatus executeTransformation (ResourceSet rs, IProgressMonitor pm) {
230a248,252
>             checkResourceSet (rs);
>             if (getGenURI () == null) {
>                 throw new IllegalStateException (Messages.TransformToGenModelOperation_e_null_gmfgen_uri);
>             }
>             checkMapping ();
274a297,306
>     private void checkResourceSet (ResourceSet rs) {
>         if (rs == null) {
>             throw new IllegalArgumentException (Messages.TransformToGenModelOperation_e_null_resource_set);
>         }
>     }
> 
>     private void checkMapping () {
>         if (getMapping () == null) {
>             throw new IllegalStateException (Messages.TransformToGenModelOperation_e_null_mapping);
>         }
275,280d296
<     public void reset (URI uri) {
<         assert uri != null;
<         myMapModelURI = uri;
<         setMapping (null);
<         myLoadMapmodelStatus = null;
<         myStaleGenmodelStatus = null;
