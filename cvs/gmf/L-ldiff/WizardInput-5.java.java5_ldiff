10a11,14
> import org.eclipse.core.resources.IWorkspace;
> 
> import org.eclipse.core.runtime.IPath;
> 
52a57,58
> import org.eclipse.gmf.tooldef.GMFToolFactory;
> 
68a75,75
>     private boolean myIsBlankToolDef = false;
110a118,140
>     public boolean isNewBlankToolDef () {
>         return myIsBlankToolDef;
>     }
> 
>     public URI createBlankToolDef () {
>         checkUnload (myRegistry);
>         myRegistry = null;
>         IPath toolDefFile = getMappingFile ().getFullPath ().removeFileExtension ().addFileExtension ("gmftool");
>         String baseName = getMappingFile ().getFullPath ().removeFileExtension ().lastSegment ();
>         int i = 1;
>         final IWorkspace wr = getMappingFile ().getProject ().getWorkspace ();
>         while (wr.getRoot ().findMember (toolDefFile) != null) {
>             toolDefFile = toolDefFile.removeLastSegments (1).append (baseName + i).addFileExtension ("gmftool");
>             i ++;
>         }
>         URI toolDefURI = URI.createPlatformResourceURI (toolDefFile.toString ());
>         myRegistry = GMFToolFactory.eINSTANCE.createToolRegistry ();
>         myRegistry.setPalette (GMFToolFactory.eINSTANCE.createPalette ());
>         getResourceSet ().createResource (toolDefURI).getContents ().add (myRegistry);
>         myIsBlankToolDef = true;
>         return toolDefURI;
>     }
> 
113a144,144
>         myIsBlankToolDef = false;
180,180c211,211
<         myFeeder = new MapDefFeeder (this);
---
>         myFeeder = new MapDefFeeder (this, createToolDefSupplier ());
183a215,222
>     private ToolDefSupplier createToolDefSupplier () {
>         if (isNewBlankToolDef ()) {
>             return new CreateToolDef (getToolDef ());
>         } else {
>             return new ToolDefLookup (getToolDef ());
>         }
>     }
> 
