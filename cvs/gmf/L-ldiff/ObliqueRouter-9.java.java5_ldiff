189a190,192
>         IFigure sourceOwner = conn.getSourceAnchor ().getOwner ();
>         IFigure targetOwner = conn.getTargetAnchor ().getOwner ();
>         if (sourceOwner == null) return false;
190,190d189
<         if (conn.getSourceAnchor ().getOwner () == null) return false;
191a194,194
>         if (targetOwner == null) return false;
191,191c193,193
< 
---
> 
192,192d193
<         if (conn.getTargetAnchor ().getOwner () == null) return false;
193,193c195,195
< 
---
> 
193a196,198
>         Rectangle startRect = null;
>         if (! (sourceOwner instanceof Connection)) {
>             startRect = new Rectangle (sourceOwner.getBounds ());
194,194d195
<         Rectangle startRect = new Rectangle (conn.getSourceAnchor ().getOwner ().getBounds ());
195,195c199,199
<         conn.getSourceAnchor ().getOwner ().translateToAbsolute (startRect);
---
>             sourceOwner.translateToAbsolute (startRect);
196a201,204
>         }
>         Rectangle endRect = null;
>         if (! (targetOwner instanceof Connection)) {
>             endRect = new Rectangle (targetOwner.getBounds ());
197,197d200
<         Rectangle endRect = new Rectangle (conn.getTargetAnchor ().getOwner ().getBounds ());
198,198c205,205
<         conn.getTargetAnchor ().getOwner ().translateToAbsolute (endRect);
---
>             targetOwner.translateToAbsolute (endRect);
199a207,207
>         }
205,205c213,213
<             else if (! startRect.contains (pt) && ! endRect.contains (pt)) {
---
>             else if ((startRect == null || ! startRect.contains (pt)) && (endRect == null || ! endRect.contains (pt))) {
