7,10d6
< import org.eclipse.core.resources.ResourcesPlugin;
< 
< import org.eclipse.core.runtime.Path;
< 
13,13c27,27
< import org.eclipse.jface.resource.ImageDescriptor;
---
> import org.eclipse.jface.resource.ImageDescriptor;
15a30,31
> 
> import org.eclipse.ui.IPersistableElement;
15,15c29,29
< import org.eclipse.jface.util.Assert;
---
> import org.eclipse.jface.util.Assert;
17,17c9,9
< import org.eclipse.ui.IPersistableElement;
---
> import org.eclipse.emf.transaction.RunnableWithResult;
18a15,15
> import org.eclipse.emf.workspace.util.WorkspaceSynchronizer;
19,19c17,17
< import org.eclipse.gmf.runtime.common.core.util.Trace;
---
> import org.eclipse.gmf.runtime.common.core.util.Trace;
21,21d16
< import org.eclipse.gmf.runtime.diagram.core.internal.util.MEditingDomainGetter;
27,27c11,11
< import org.eclipse.gmf.runtime.emf.core.edit.MEditingDomain;
---
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
29,29c13,13
< import org.eclipse.gmf.runtime.emf.core.edit.MRunnable;
---
> import org.eclipse.emf.transaction.util.TransactionUtil;
31,31c23,23
< import org.eclipse.gmf.runtime.emf.core.util.EObjectUtil;
---
> import org.eclipse.gmf.runtime.emf.core.util.EMFCoreUtil;
33,33c25,25
< import org.eclipse.gmf.runtime.notation.Diagram;
---
> import org.eclipse.gmf.runtime.notation.Diagram;
56,56d53
<         final String [] name = new String [1];
57a55,55
>             return (String) TransactionUtil.getEditingDomain (getDiagram ()).runExclusive (new RunnableWithResult.Impl () {
58,58d54
<             MEditingDomainGetter.getMEditingDomain (getDiagram ()).runAsRead (new MRunnable () {
59a57,58
>                 public void run () {
>                     setResult (EMFCoreUtil.getQualifiedName (getDiagram (), false));
60,62d56
<                 public Object run () {
<                     name [0] = EObjectUtil.getQName (getDiagram (), false);
<                     return null;
69a66,66
>             return null;
70,70d65
<             name [0] = null;
72,72d67
<         return name [0];
76,76d70
<         final String [] name = new String [1];
77a72,72
>             return (String) TransactionUtil.getEditingDomain (getDiagram ()).runExclusive (new RunnableWithResult.Impl () {
78,78d71
<             MEditingDomainGetter.getMEditingDomain (getDiagram ()).runAsRead (new MRunnable () {
79a74,75
>                 public void run () {
>                     setResult (EMFCoreUtil.getName (getDiagram ()));
80,82d73
<                 public Object run () {
<                     name [0] = EObjectUtil.getName (getDiagram ());
<                     return null;
89a83,83
>             return null;
90,90d82
<             name [0] = null;
92,92d84
<         return name [0];
133,133d124
<         final IFile [] file = new IFile [1];
134a126,127
>             final TransactionalEditingDomain editingDomain = TransactionUtil.getEditingDomain (getDiagram ());
>             return (IFile) editingDomain.runExclusive (new RunnableWithResult.Impl () {
135,136d125
<             final MEditingDomain editingDomain = MEditingDomainGetter.getMEditingDomain (getDiagram ());
<             editingDomain.runAsRead (new MRunnable () {
138,138c129,129
<                 public Object run () {
---
>                 public void run () {
139a131,131
>                     setResult (model != null ? WorkspaceSynchronizer.getFile (model) : null);
140,142d130
<                     String path = editingDomain.getResourceFileName (model);
<                     file [0] = model != null && path != null && path.length () != 0 ? ResourcesPlugin.getWorkspace ().getRoot ().getFileForLocation (new Path (path)) : null;
<                     return null;
149a139,139
>             return null;
150,150d138
<             file [0] = null;
152,152d140
<         return file [0];
