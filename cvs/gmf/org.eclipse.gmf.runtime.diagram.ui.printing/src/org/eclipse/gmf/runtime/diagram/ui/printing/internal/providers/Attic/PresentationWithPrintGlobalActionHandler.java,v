head	1.4;
access;
symbols
	v20080911-1728:1.4
	R1_0_maintenance:1.4.0.2
	R1_0:1.4
	v20051030:1.3;
locks; strict;
comment	@# @;


1.4
date	2005.11.02.23.30.47;	author sshaw;	state dead;
branches;
next	1.3;

1.3
date	2005.10.28.14.29.43;	author sshaw;	state Exp;
branches;
next	1.2;

1.2
date	2005.09.12.21.28.04;	author sshaw;	state Exp;
branches;
next	1.1;

1.1
date	2005.08.30.03.18.46;	author sshaw;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Bugzilla#113157 gmf_head cmahoney 051102 GMF Diagram Layer Public API Name Changes
@
text
@/******************************************************************************
 * Copyright (c) 2005 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    IBM Corporation - initial API and implementation 
 ****************************************************************************/

package org.eclipse.gmf.runtime.diagram.ui.printing.internal.providers;

import org.eclipse.gef.RootEditPart;
import org.eclipse.gmf.runtime.common.core.command.ICommand;
import org.eclipse.gmf.runtime.common.ui.action.global.GlobalActionId;
import org.eclipse.gmf.runtime.common.ui.services.action.global.IGlobalActionContext;
import org.eclipse.gmf.runtime.diagram.core.preferences.PreferencesHint;
import org.eclipse.gmf.runtime.diagram.ui.editparts.IDiagramPreferenceSupport;
import org.eclipse.gmf.runtime.diagram.ui.parts.IDiagramWorkbenchPart;
import org.eclipse.gmf.runtime.diagram.ui.printing.actions.DefaultPrintActionHelper;
import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.DiagramPrinter;
import org.eclipse.gmf.runtime.diagram.ui.providers.PresentationGlobalActionHandler;
import org.eclipse.ui.IEditorPart;

/**
 * Concrete class that implements the <code>IGlobalActionHandler</code>
 * interface and provides a command for <code>GlobalActionId.PRINT</code>.
 * 
 * @@author tmacdoug
 */
public class PresentationWithPrintGlobalActionHandler
	extends PresentationGlobalActionHandler  {

	/**
	 * Constructor for PresentationWithPrintGlobalActionHandler.
	 */
	public PresentationWithPrintGlobalActionHandler() {
		super();
	}

	/**
	 * @@see com.ibm.xtools.common.clipboard.AbstractGlobalActionHandler#getCommand(IGlobalActionContext)
	 */
	public ICommand getCommand(IGlobalActionContext cntxt) {
		ICommand command = null;

		/* Check the action id and create the command */
		String actionId = cntxt.getActionId();
		if(actionId.equals(GlobalActionId.PRINT)) {
			doPrint(cntxt);
		} else {
			command = super.getCommand(cntxt);
		}
		
		return command;
	}

	/**
	 * @@param cntxt
	 */
	protected void doPrint(IGlobalActionContext cntxt) {
		DefaultPrintActionHelper.doRun((IEditorPart) cntxt.getActivePart(),
			new DiagramPrinter(getPreferencesHint((IEditorPart) cntxt
				.getActivePart()), getMapMode(cntxt)));
	}

	/**
	 * Checks if we will allow a print
	 * 
	 * @@return boolean true
	 */
	private boolean canPrint() {
		return true;
	}

	/**
	 * @@see org.eclipse.gmf.runtime.common.ui.action.AbstractGlobalActionHandler#canHandle(IGlobalActionContext)
	 */
	public boolean canHandle(IGlobalActionContext cntxt) {
		boolean result = false;

		/* Check the action id */
        String actionId = cntxt.getActionId();
		if(actionId.equals(GlobalActionId.PRINT)) {
			result = canPrint();
		} else {
			result = super.canHandle(cntxt);
		}
		return result;
	}
	
	/**
	 * Gets the preferences hint that is to be used to find the appropriate
	 * preference store from which to retrieve diagram preference values. The
	 * preference hint is mapped to a preference store in the preference
	 * registry <@@link DiagramPreferencesRegistry>.
	 * 
	 * @@return the preferences hint
	 */
	protected PreferencesHint getPreferencesHint(IEditorPart editorPart) {
		if (editorPart instanceof IDiagramWorkbenchPart) {
			RootEditPart rootEP = ((IDiagramWorkbenchPart) editorPart)
				.getDiagramGraphicalViewer().getRootEditPart();
			if (rootEP instanceof IDiagramPreferenceSupport) {
				return ((IDiagramPreferenceSupport) rootEP)
					.getPreferencesHint();
			}
		}
		return PreferencesHint.USE_DEFAULTS;
	}
}
@


1.3
log
@bugzilla 112788 gmf-head sshaw 051029 API: Encapsulate MapMode / HiMetric coordinate system from clients

First phase delivery...
@
text
@@


1.2
log
@Bugzilla 108765 gmf_head tmacdoug 050912 - Update copyrights of GMF and EMFT plugins content to Eclipse copyright (EPL)
@
text
@a14 2
import org.eclipse.ui.IEditorPart;

d24 1
d65 1
a65 1
				.getActivePart())));
@


1.1
log
@Refactoring of the IBM gmf runtime contribution to the org.eclipse.gmf.runtime namespace.
@
text
@d1 11
a11 9
/*
 *+------------------------------------------------------------------------+
 *| Licensed Materials - Property of IBM                                   |
 *| (C) Copyright IBM Corp. 2005.  All Rights Reserved.              |
 *|                                                                        |
 *| US Government Users Restricted Rights - Use, duplication or disclosure |
 *| restricted by GSA ADP Schedule Contract with IBM Corp.                 |
 *+------------------------------------------------------------------------+
 */
@

