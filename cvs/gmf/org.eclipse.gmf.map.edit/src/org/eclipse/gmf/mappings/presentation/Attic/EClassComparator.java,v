head	1.2;
access;
symbols
	v20080813-1520:1.2
	R1_0_maintenance:1.2.0.2
	R1_0:1.2
	I20060424-0500:1.1
	I20060424-0300:1.1;
locks; strict;
comment	@# @;
expand	@k@;


1.2
date	2006.04.26.17.55.01;	author ashatalin;	state dead;
branches;
next	1.1;

1.1
date	2006.04.20.14.35.50;	author ashatalin;	state Exp;
branches;
next	;


desc
@@


1.2
log
@#119034 Show only valid feature in "containment feature" property of ChildNodeMapping
#138606 hide inappropriate entries in selection dialogs
@
text
@/**
 * Copyright (c) 2006 Eclipse.org
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    vano - initial API and implementation
 */
package org.eclipse.gmf.mappings.presentation;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;

import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EReference;
import org.eclipse.gmf.mappings.MappingEntry;
import org.eclipse.gmf.mappings.NodeReference;

public class EClassComparator extends ENamedElementsComparator {

	private EClass myProposedSuperType;

	public static List getSortedList(Collection eStructuralFeatures, MappingEntry mappingEntry) {
		EClass proposedSuperType = null;
		if (mappingEntry.eContainer() instanceof NodeReference) {
			NodeReference nodeReference = (NodeReference) mappingEntry.eContainer();
			EReference modelReference = nodeReference.getChildrenFeature() != null ? nodeReference.getChildrenFeature() : nodeReference.getContainmentFeature();
			if (modelReference != null) {
				proposedSuperType = modelReference.getEReferenceType();
			}
		}
		List validStructuralFeatures = new ArrayList(eStructuralFeatures);
		Collections.sort(validStructuralFeatures, new EClassComparator(proposedSuperType));
		return validStructuralFeatures;
	}

	private EClassComparator(EClass proposedSuperType) {
		myProposedSuperType = proposedSuperType;
	}

	public int compare(Object o1, Object o2) {
		EClass firstEClass = (EClass) o1;
		EClass secondEClass = (EClass) o2;
		int result = getValue(firstEClass) - getValue(secondEClass);
		if (result != 0) {
			return result;
		}
		return super.compare(o1, o2);
	}

	private int getValue(EClass eClass) {
		if (eClass == null || myProposedSuperType == null) {
			return -1;
		}
		return myProposedSuperType.isSuperTypeOf(eClass) ? 0 : 1;
	}

}
@


1.1
log
@#137735 Sort features/attributes/eclasses alphabetically in all EMF editor for .gmfmap
@
text
@@

