16a17,17
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
30,30c31,31
< import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
81a83,83
>         TransactionalEditingDomain editingDomain = null;
81,81c82,82
< 		CompositeModelCommand command = null;
---
> 		CompositeTransactionalCommand command = null;
86a89,91
>                     if (editingDomain == null) {
>                         editingDomain = ((IGraphicalEditPart) editPart).getEditingDomain();
>                     }
96,96c101,101
< 				if (command2 != null) {
---
> 				if (command2 != null && editingDomain != null) {
98,98c103,103
< 						command = new CompositeModelCommand(command2.getLabel());
---
> 						command = new CompositeTransactionalCommand(editingDomain, command2.getLabel());
105,105c110,110
< 		if ((command != null)&&(command.getCommands().size() > 0))
---
> 		if ((command != null)&&(command.size() > 0))
