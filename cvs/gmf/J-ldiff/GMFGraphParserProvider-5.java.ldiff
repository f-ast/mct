4,4d9
< import org.eclipse.emf.ecore.EObject;
5,5c10,10
< import org.eclipse.gmf.runtime.common.core.service.AbstractProvider;
---
> import org.eclipse.gmf.runtime.common.core.service.AbstractProvider;
6,6c11,11
< import org.eclipse.gmf.runtime.common.core.service.IOperation;
---
> import org.eclipse.gmf.runtime.common.core.service.IOperation;
7,7c12,12
< import org.eclipse.gmf.runtime.common.ui.services.parser.GetParserOperation;
---
> import org.eclipse.gmf.runtime.common.ui.services.parser.GetParserOperation;
8,8c13,13
< import org.eclipse.gmf.runtime.common.ui.services.parser.IParser;
---
> import org.eclipse.gmf.runtime.common.ui.services.parser.IParser;
9,9c14,14
< import org.eclipse.gmf.runtime.common.ui.services.parser.IParserProvider;
---
> import org.eclipse.gmf.runtime.common.ui.services.parser.IParserProvider;
10,10d14
< import org.eclipse.gmf.runtime.emf.type.core.ElementTypeRegistry;
11,11c15,15
< import org.eclipse.gmf.runtime.emf.type.core.IElementType;
---
> import org.eclipse.gmf.runtime.notation.View;
13,13d4
< 
18,18d8
< 
121,121c117,117
< 	protected IParser getParser(IElementType type, int visualID) {
---
> 	protected IParser getParser(int visualID) {
121a118,118
> 		switch (visualID) {
122,122d117
< 		if (GMFGraphElementTypes.Compartment_1001 == type) {
123,123c119,119
< 			if (Compartment_nameEditPart.VISUAL_ID == visualID) {
---
> 		case Compartment_nameEditPart.VISUAL_ID:
124a121,121
> 		case Node_nameEditPart.VISUAL_ID:
125,128d120
< 			}
< 		}
< 		if (GMFGraphElementTypes.Node_1002 == type) {
< 			if (Node_nameEditPart.VISUAL_ID == visualID) {
129a123,123
> 		case Connection_nameEditPart.VISUAL_ID:
130,133d122
< 			}
< 		}
< 		if (GMFGraphElementTypes.Connection_1003 == type) {
< 			if (Connection_nameEditPart.VISUAL_ID == visualID) {
134a125,125
> 		case FigureGallery_nameEditPart.VISUAL_ID:
135,138d124
< 			}
< 		}
< 		if (GMFGraphElementTypes.FigureGallery_1004 == type) {
< 			if (FigureGallery_nameEditPart.VISUAL_ID == visualID) {
141,141d127
< 		}
148a135,135
> 		String vid = (String) hint.getAdapter(String.class);
149,150d134
< 		int visualID = GMFGraphVisualIDRegistry.getVisualID((String) hint.getAdapter(String.class));
< 		IElementType type = (IElementType) hint.getAdapter(IElementType.class);
151a137,138
> 			return getParser(GMFGraphVisualIDRegistry.getVisualID(vid));
> 		}
151,151c136,136
< 		if (type == null) {
---
> 		if (vid != null) {
152a140,141
> 		if (view != null) {
> 			return getParser(GMFGraphVisualIDRegistry.getVisualID(view));
152,152c139,139
< 			EObject element = (EObject) hint.getAdapter(EObject.class);
---
> 		View view = (View) hint.getAdapter(View.class);
153,153d139
< 			type = ElementTypeRegistry.getInstance().getElementType(element);
154a143,143
> 		return null;
155,155d142
< 		return getParser(type, visualID);
