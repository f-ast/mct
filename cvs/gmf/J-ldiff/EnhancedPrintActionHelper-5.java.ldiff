2,2c2,2
<  * Copyright (c) 2005, 2006 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2008 IBM Corporation and others.
20a21,21
> import org.eclipse.core.runtime.Platform;
30a34,34
> import org.eclipse.gmf.runtime.diagram.ui.printing.render.internal.JPSDiagramPrinter;
31,31c35,35
< import org.eclipse.gmf.runtime.diagram.ui.printing.actions.DefaultPrintActionHelper;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.render.internal.JPSDiagramPrinterHelper;
37a40,40
> import org.eclipse.gmf.runtime.notation.Diagram;
88,93d91
< 		
< 		if (!System.getProperty("os.name").toUpperCase().startsWith("WIN")) { //$NON-NLS-1$ //$NON-NLS-2$
< 			//do default action when not Windows and this action is enabled
< 			DefaultPrintActionHelper.doRun(diagramEditor,
< 				new RenderedDiagramPrinter(preferencesHint, mapMode));
< 			return;
94a92,103
> 		//
> 		// Eventually the windows based printing will be replaced with the
> 		// JPSDiagramPrinter.
> 		//
> 		if (Platform.getOS().startsWith(Platform.OS_WIN32)) {
> 			DiagramPrinterUtil.printWithSettings(diagramEditor,
> 					createDiagramMap(), new RenderedDiagramPrinter(
> 							preferencesHint, mapMode));
> 		}
> 		else {
> 			JPSDiagramPrinterHelper.getDiagramPrinterHelper()
> 					.printWithSettings(diagramEditor, createDiagramMap(),
95,96d91
< 		
< 		DiagramPrinterUtil.printWithSettings(diagramEditor, createDiagramMap(),
97,97c104,104
< 			new RenderedDiagramPrinter(preferencesHint, mapMode));
---
> 							new JPSDiagramPrinter(preferencesHint, mapMode));
108,108c116,116
< 	private Map createDiagramMap() {
---
> 	protected Map<String, Diagram> createDiagramMap() {
110,110c118,118
< 		Map diagramMap = new HashMap();
---
> 		Map<String, Diagram> diagramMap = new HashMap<String, Diagram>();
126a64,64
> 	
127,127d63
<                 
