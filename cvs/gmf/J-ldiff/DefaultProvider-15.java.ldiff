2,2c2,2
<  * Copyright (c) 2002, 2004 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
619,619c619,619
<         if (source.data != connectEP.getSource()) {
---
>         if (source.data == connectEP.getTarget()) {
626a627,639
>         int totalEdgeDiffX = diffX ;
>         int totalEdgeDiffY = diffY ;
>         Node parent=  null;
>         parent = source.getParent();
>         if (parent==null)
>             parent = target.getParent();
>         if (parent!=null){
>             Rectangle targetExt = getNodeMetrics(parent);
>             totalEdgeDiffX += targetExt.x;
>             totalEdgeDiffY += targetExt.y;
>         }
>         
>         
629,629c642,642
<             allPoints.addPoint(routePoints.getPoint(i).x + diffX, routePoints
---
>             allPoints.addPoint(routePoints.getPoint(i).x + totalEdgeDiffX, routePoints
630a644,644
>                 + totalEdgeDiffY);
631,631d643
<                 + diffY);
