20a21,21
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
41,41c42,42
< import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
137a139,140
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
> 		CompositeTransactionalCommand cmc = new CompositeTransactionalCommand(editingDomain, DiagramUIMessages.Command_AdjustRatioCommand_Label);
138,138d138
< 		CompositeModelCommand cmc = new CompositeModelCommand(DiagramUIMessages.Command_AdjustRatioCommand_Label);
143,143c145,145
< 				cmc.compose(new SetCompartmentRatioCommand(new EObjectAdapter((View)child.getModel()), NULL_CONSTRAINT));
---
> 				cmc.compose(new SetCompartmentRatioCommand(editingDomain, new EObjectAdapter((View)child.getModel()), NULL_CONSTRAINT));
146,146c148,148
< 		return cmc.isEmpty() ? null : new EtoolsProxyCommand(cmc.unwrap());
---
> 		return cmc.isEmpty() ? null : new EtoolsProxyCommand(cmc.reduce());
152a155,156
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
>         CompositeTransactionalCommand cmc = new CompositeTransactionalCommand(editingDomain, DiagramUIMessages.Command_AdjustRatioCommand_Label);
153,153d154
< 		CompositeModelCommand cmc = new CompositeModelCommand(DiagramUIMessages.Command_AdjustRatioCommand_Label);
182,182c185,185
< 				cmc.compose(new SetCompartmentRatioCommand(new EObjectAdapter((View)part.getModel()), r));
---
> 				cmc.compose(new SetCompartmentRatioCommand(editingDomain, new EObjectAdapter((View)part.getModel()), r));
