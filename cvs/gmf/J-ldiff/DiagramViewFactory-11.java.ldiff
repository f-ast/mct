2,2c2,2
<  * Copyright (c) 2005 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2006 IBM Corporation and others.
20a25,25
> import org.eclipse.gmf.runtime.notation.FontStyle;
21,21c26,26
< import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
---
> import org.eclipse.gmf.runtime.notation.LineStyle;
74a76,78
> 		Diagram diagram = NotationFactory.eINSTANCE.createDiagram();
> 		List styles = createStyles(diagram);
> 		if (styles.size() > 0) {
75,77d75
< 
< 		Diagram diagram = (Diagram)  NotationPackage.eINSTANCE.getDiagram().getEPackage().getEFactoryInstance().create(
< 			NotationPackage.eINSTANCE.getDiagram());
78a80,80
> 		}
78,78c79,79
< 		diagram.getStyles().addAll(createStyles(diagram));
---
> 			diagram.getStyles().addAll(styles);
146a149,152
> 		
> 		LineStyle lineStyle = (LineStyle) view
> 			.getStyle(NotationPackage.Literals.LINE_STYLE);
> 		if (lineStyle != null) {
148,148d153
< 		RGB lineRGB =
149,149c154,154
< 			PreferenceConverter.getColor(
---
> 			RGB lineRGB = PreferenceConverter.getColor(store,
150,150d154
< 				store,
152,152d155
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getLineStyle_LineColor(), FigureUtilities.RGBToInteger(lineRGB));
153a157,159
> 			lineStyle.setLineColor(FigureUtilities.RGBToInteger(lineRGB)
> 				.intValue());
> 		}
153a162,166
> 		FontStyle fontStyle = (FontStyle) view
> 			.getStyle(NotationPackage.Literals.FONT_STYLE);
> 		if (fontStyle != null) {
> 			// default font
> 			FontData fontData = PreferenceConverter.getFontData(store,
154,157d161
< 		//default font
< 		FontData fontData =
< 			PreferenceConverter.getFontData(
< 				store,
158a168,171
> 			fontStyle.setFontName(fontData.getName());
> 			fontStyle.setFontHeight(fontData.getHeight());
> 			fontStyle.setBold((fontData.getStyle() & SWT.BOLD) != 0);
> 			fontStyle.setItalic((fontData.getStyle() & SWT.ITALIC) != 0);
158,158c167,167
< 				IPreferenceConstants.PREF_DEFAULT_FONT);
---
> 				IPreferenceConstants.PREF_DEFAULT_FONT);
160,163d160
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontName(), fontData.getName());
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontHeight(), new Integer(fontData.getHeight()));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Bold(), Boolean.valueOf((fontData.getStyle() & SWT.BOLD) != 0));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Italic(), Boolean.valueOf((fontData.getStyle() & SWT.ITALIC) != 0));
166,166d172
< 		RGB fontRGB =
167,167c173,173
< 			PreferenceConverter.getColor(
---
> 			RGB fontRGB = PreferenceConverter.getColor(store,
168,168d173
< 				store,
169a175,177
> 			fontStyle.setFontColor(FigureUtilities.RGBToInteger(fontRGB)
> 				.intValue());
> 		}
170,170d174
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontColor(), FigureUtilities.RGBToInteger(fontRGB));
