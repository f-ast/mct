16a17,17
> import java.util.List;
20a25,25
> import org.eclipse.emf.ecore.EPackage;
22a21,22
> import org.eclipse.emf.ecore.EClass;
> import org.eclipse.emf.ecore.EClassifier;
23,23c23,23
< import org.eclipse.emf.ecore.EcorePackage;
---
> import org.eclipse.emf.ecore.EFactory;
25,25d28
< import org.eclipse.gmf.codegen.gmfgen.GMFGenFactory;
27,35d29
< import org.eclipse.gmf.codegen.gmfgen.GenAuditContainer;
< import org.eclipse.gmf.codegen.gmfgen.GenAuditContext;
< import org.eclipse.gmf.codegen.gmfgen.GenAuditRoot;
< import org.eclipse.gmf.codegen.gmfgen.GenAuditRule;
< import org.eclipse.gmf.codegen.gmfgen.GenAuditable;
< import org.eclipse.gmf.codegen.gmfgen.GenEditorGenerator;
< import org.eclipse.gmf.codegen.gmfgen.GenExpressionInterpreter;
< import org.eclipse.gmf.codegen.gmfgen.GenExpressionProviderContainer;
< import org.eclipse.gmf.codegen.gmfgen.GenPlugin;
37a32,35
> /**
>  * Migration from old, 2005-styled GMF models to instances of dynamic 2006 model 
>  * (should be updated further to normal 2008 using CustomCopier)
>  */
43a42,42
> 	private EObject myRootContainer;
44,44d41
< 	private GenAuditContainer myRootContainer;
45,45c43,43
< 	private Map<GenExpressionInterpreter, Collection<String>> myRequiredPlugins;
---
> 	private LinkedHashMap<EObject, Collection<String>> myRequiredPlugins;
46,46c44,44
< 	private GenExpressionProviderContainer myProvidersContainer;
---
> 	private EObject myProvidersContainer;
47,48d44
< 	private EAttribute myGenAuditRule_ContextSelectorLocalClassName;
< 	private Map<GenAuditRule, String> myAuditContexts;
52a49,84
> 	private EPackage gmfgen2006 = get2006GenModelPackage();
> 	private EFactory factory2006 = gmfgen2006.getEFactoryInstance();
> 	private GMFGenPackage gmfgen2008 = GMFGenPackage.eINSTANCE;
> 
> 	private EClassifier class_editorCandies = gmfgen2006.getEClassifier(gmfgen2008.getEditorCandies().getName());
> 	private EClassifier class_providerClassNames = gmfgen2006.getEClassifier(gmfgen2008.getProviderClassNames().getName());
> 	private EClassifier class_editPartCandies = gmfgen2006.getEClassifier(gmfgen2008.getEditPartCandies().getName());
> 	private EClassifier class_typeLinkModelFacet = gmfgen2006.getEClassifier(gmfgen2008.getTypeLinkModelFacet().getName());
> 	private EClass class_genPlugin = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenPlugin().getName());
> 	private EClass class_genExpressionInterpreter = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenExpressionInterpreter().getName());
> 	private EClass class_featureLabelModelFacet = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getFeatureLabelModelFacet().getName());
> 	private EClass class_genAuditRule = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenAuditRule().getName());
> 	private EClass class_genAuditContainer = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenAuditContainer().getName());
> 	private EClass class_genAuditRoot = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenAuditRoot().getName());
> 	private EClass class_genFeatureValueSpec = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenFeatureValueSpec().getName());
> 	private EClass class_genExpressionProviderBase = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenExpressionProviderBase().getName());
> 	private EClass class_genExpressionProviderContainer = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenExpressionProviderContainer().getName());
> 	private EClass class_genEditorGenerator = (EClass) gmfgen2006.getEClassifier(gmfgen2008.getGenEditorGenerator().getName());
> 
> 	private EStructuralFeature feature_genExpressionProviderBase_container = class_genExpressionProviderBase.getEStructuralFeature(gmfgen2008.getGenExpressionProviderBase_Container().getName());
> 	private EStructuralFeature feature_genExpressionProviderContainer_providers = class_genExpressionProviderContainer.getEStructuralFeature(gmfgen2008.getGenExpressionProviderContainer_Providers().getName());
> 	private EStructuralFeature feature_genExpressionProviderContainer_editorGen = class_genExpressionProviderContainer.getEStructuralFeature(gmfgen2008.getGenExpressionProviderContainer_EditorGen().getName());
> 	private EStructuralFeature feature_genEditorGenerator_expressionProviders = class_genEditorGenerator.getEStructuralFeature(gmfgen2008.getGenEditorGenerator_ExpressionProviders().getName());
> 	private EStructuralFeature feature_genEditorGenerator_plugin = class_genEditorGenerator.getEStructuralFeature(gmfgen2008.getGenEditorGenerator_Plugin().getName());
> 	private EStructuralFeature feature_genPlugin_requiredPlugins = class_genPlugin.getEStructuralFeature(gmfgen2008.getGenPlugin_RequiredPlugins().getName());
> 	private EStructuralFeature feature_featureLabelModelFacet_metaFeatures = class_featureLabelModelFacet.getEStructuralFeature(gmfgen2008.getFeatureLabelModelFacet_MetaFeatures().getName());
> 	private EStructuralFeature feature_genAuditContainer_path = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Path().getName());
> 	private EStructuralFeature feature_genAuditContainer_id = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Id().getName());
> 	private EStructuralFeature feature_genAuditContainer_name = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Name().getName());
> 	private EStructuralFeature feature_genAuditContainer_description = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Description().getName());
> 	private EStructuralFeature feature_genAuditContainer_audits = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Audits().getName());
> 	private EStructuralFeature feature_genAuditContainer_root = class_genAuditContainer.getEStructuralFeature(gmfgen2008.getGenAuditContainer_Root().getName());
> 	private EStructuralFeature feature_genAuditRoot_categories = class_genAuditRoot.getEStructuralFeature(gmfgen2008.getGenAuditRoot_Categories().getName());
> 	private EStructuralFeature feature_genAuditRoot_rules = class_genAuditRoot.getEStructuralFeature(gmfgen2008.getGenAuditRoot_Rules().getName());
> 	private EStructuralFeature feature_genAuditRule_category = class_genAuditRule.getEStructuralFeature(gmfgen2008.getGenAuditRule_Category().getName());
> 
53a86,86
> 		registerDeletedAttributes(class_editorCandies,
54,54d85
< 		registerDeletedAttributes(GMFGenPackage.eINSTANCE.getEditorCandies(),
57a90,90
> 		registerDeletedAttributes(class_providerClassNames, 
58,58d89
< 		registerDeletedAttributes(GMFGenPackage.eINSTANCE.getProviderClassNames(), 
66a99,99
> 		registerDeletedAttributes(class_editPartCandies, 
67,67d98
< 		registerDeletedAttributes(GMFGenPackage.eINSTANCE.getEditPartCandies(), 
71,71c103,103
< 		registerDeletedAttributes(GMFGenPackage.eINSTANCE.getTypeLinkModelFacet(), "createCommandClassName"); //$NON-NLS-1$
---
> 		registerDeletedAttributes(class_typeLinkModelFacet, "createCommandClassName"); //$NON-NLS-1$
74,74c106,106
< 			renamings.put("requiredPluginIDs", GMFGenPackage.eINSTANCE.getGenPlugin_RequiredPlugins()); //$NON-NLS-1$
---
> 			renamings.put("requiredPluginIDs", feature_genPlugin_requiredPlugins); //$NON-NLS-1$
75,75c107,107
< 			registerRenamedAttributes(GMFGenPackage.eINSTANCE.getGenExpressionInterpreter(), renamings);
---
> 			registerRenamedAttributes(class_genExpressionInterpreter, renamings);
79,79c111,111
< 			renamings.put("metaFeature", GMFGenPackage.eINSTANCE.getFeatureLabelModelFacet_MetaFeatures()); //$NON-NLS-1$
---
> 			renamings.put("metaFeature", feature_featureLabelModelFacet_metaFeatures); //$NON-NLS-1$
80,80c112,112
< 			registerRenamedAttributes(GMFGenPackage.eINSTANCE.getFeatureLabelModelFacet(), renamings);
---
> 			registerRenamedAttributes(class_featureLabelModelFacet, renamings);
81a114,114
> 		registerRenamedType("CompositeFeatureLabelModelFacet", class_featureLabelModelFacet); //$NON-NLS-1$
82,82d113
< 		registerRenamedType("CompositeFeatureLabelModelFacet", GMFGenPackage.eINSTANCE.getFeatureLabelModelFacet()); //$NON-NLS-1$
83,83c115,115
< 		myGenAuditContainer_ChildContainers = createNewReference("childContainers", GMFGenPackage.eINSTANCE.getGenAuditContainer(), true); //$NON-NLS-1$
---
> 		myGenAuditContainer_ChildContainers = createNewReference("childContainers", class_genAuditContainer, true); //$NON-NLS-1$
87,87c119,119
< 			registerRenamedAttributes(GMFGenPackage.eINSTANCE.getGenAuditContainer(), renamings);
---
> 			registerRenamedAttributes(class_genAuditContainer, renamings);
88a121,122
> 		myGenAuditRoot_Id = (EAttribute) EcoreUtil.copy(gmfgen2008.getGenAuditContainer_Id());
> 		myGenAuditRoot_Name = (EAttribute) EcoreUtil.copy(gmfgen2008.getGenAuditContainer_Name());
89,90d120
< 		myGenAuditRoot_Id = (EAttribute) EcoreUtil.copy(GMFGenPackage.eINSTANCE.getGenAuditContainer_Id());
< 		myGenAuditRoot_Name = (EAttribute) EcoreUtil.copy(GMFGenPackage.eINSTANCE.getGenAuditContainer_Name());
91,91c123,123
< 		myGenAuditRoot_Description = (EAttribute) EcoreUtil.copy(GMFGenPackage.eINSTANCE.getGenAuditContainer_Description());
---
> 		myGenAuditRoot_Description = (EAttribute) EcoreUtil.copy(gmfgen2008.getGenAuditContainer_Description());
92,92c124,124
< 		myGenAuditRoot_Audits = createNewReference("audits", GMFGenPackage.eINSTANCE.getGenAuditRule(), true); //$NON-NLS-1$
---
> 		myGenAuditRoot_Audits = createNewReference("audits", class_genAuditRule, true); //$NON-NLS-1$
100,100c132,132
< 			registerRenamedAttributes(GMFGenPackage.eINSTANCE.getGenAuditRoot(), renamings);
---
> 			registerRenamedAttributes(class_genAuditRoot, renamings);
102,104d133
< 
< 		myGenAuditRule_ContextSelectorLocalClassName = createNewAttribute("contextSelectorLocalClassName", EcorePackage.eINSTANCE.getEString(), false);
< 		registerRenamedAttribute(GMFGenPackage.eINSTANCE.getGenAuditRule(), myGenAuditRule_ContextSelectorLocalClassName.getName(), myGenAuditRule_ContextSelectorLocalClassName);
106,106c135,135
< 		registerNarrowedAbstractType("GenFeatureInitializer", GMFGenPackage.eINSTANCE.getGenFeatureValueSpec()); //$NON-NLS-1$
---
> 		registerNarrowedAbstractType("GenFeatureInitializer", class_genFeatureValueSpec); //$NON-NLS-1$
111,111d139
< 		myAuditContexts = null;
113a142,142
> 	@SuppressWarnings("unchecked")
115a145,148
> 		if (!gmfgen2006.equals(object.eClass().getEPackage())) {
> 			return super.setValue(object, feature, value, position);
> 		}
> 		if (feature_genPlugin_requiredPlugins.equals(feature) && class_genExpressionInterpreter.isInstance(object)) {
116,117d144
< 		if (GMFGenPackage.eINSTANCE.getGenPlugin_RequiredPlugins().equals(feature) && object instanceof GenExpressionInterpreter) {
< 			GenExpressionInterpreter expressionInterpreter = (GenExpressionInterpreter) object;
119,119c150,150
< 			saveRequiredPlugin(expressionInterpreter, requiredPlugin);
---
> 			saveRequiredPlugin(object, requiredPlugin);
121,121c152,152
< 			GenAuditRoot root = (GenAuditRoot) object;
---
> 			EObject root = object;
123,123c154,154
< 			GenAuditContainer rootContainer = getOrCreateRootContainerOnce(root);
---
> 			EObject rootContainer = getOrCreateRootContainerOnce(root);
124,124c155,155
< 			rootContainer.setId(id);
---
> 			rootContainer.eSet(feature_genAuditContainer_id, id);
127,127c158,158
< 			GenAuditRoot root = (GenAuditRoot) object;
---
> 			EObject root = object;
129,129c160,160
< 			GenAuditContainer rootContainer = getOrCreateRootContainerOnce(root);
---
> 			EObject rootContainer = getOrCreateRootContainerOnce(root);
130,130c161,161
< 			rootContainer.setName(name);
---
> 			rootContainer.eSet(feature_genAuditContainer_name, name);
133,133c164,164
< 			GenAuditRoot root = (GenAuditRoot) object;
---
> 			EObject root = object;
135,135c166,166
< 			GenAuditContainer rootContainer = getOrCreateRootContainerOnce(root);
---
> 			EObject rootContainer = getOrCreateRootContainerOnce(root);
136,136c167,167
< 			rootContainer.setDescription(description);
---
> 			rootContainer.eSet(feature_genAuditContainer_description, description);
138,138c169,169
< 		} else if (myGenAuditContainer_ChildContainers.equals(feature) && object instanceof GenAuditRoot) {
---
> 		} else if (myGenAuditContainer_ChildContainers.equals(feature) && class_genAuditRoot.isInstance(object)) {
138a170,170
> 			EObject root = object;
139,139d169
< 			GenAuditRoot root = (GenAuditRoot)object;
140,140c171,171
< 			GenAuditContainer container = (GenAuditContainer)value;
---
> 			EObject container = (EObject)value;
142,142c173,173
< 				container.getPath().add(myRootContainer);
---
> 				((List<EObject>)container.eGet(feature_genAuditContainer_path)).add(myRootContainer);
144,144c175,175
< 			root.getCategories().add(container);
---
> 			((List<EObject>)root.eGet(feature_genAuditRoot_categories)).add(container);
146a178,178
> 			EObject root = object;
146,146c177,177
< 		} else if (myGenAuditRoot_Audits.equals(feature) && object instanceof GenAuditRoot) {
---
> 		} else if (myGenAuditRoot_Audits.equals(feature) && class_genAuditRoot.isInstance(object)) {
147,147d177
< 			GenAuditRoot root = (GenAuditRoot)object;
148,148c179,179
< 			GenAuditRule rule = (GenAuditRule)value;
---
> 			EObject rule = (EObject)value;
150,150c181,181
< 				rule.setCategory(myRootContainer);
---
> 				rule.eSet(feature_genAuditRule_category, myRootContainer);
152a184,184
> 			((List<EObject>)root.eGet(feature_genAuditRoot_rules)).add(rule);
153,153d183
< 			root.getRules().add(rule);
154a186,189
> 			EObject parent = object;
> 			EObject container = (EObject)value;
> 			((List<EObject>)container.eGet(feature_genAuditContainer_path)).addAll(((List<EObject>)parent.eGet(feature_genAuditContainer_path)));
> 			((List<EObject>)container.eGet(feature_genAuditContainer_path)).add(parent);
154,154c185,185
< 		} else if (myGenAuditContainer_ChildContainers.equals(feature) && object instanceof GenAuditContainer) {
---
> 		} else if (myGenAuditContainer_ChildContainers.equals(feature) && class_genAuditContainer.isInstance(object)) {
155,158d185
< 			GenAuditContainer parent = (GenAuditContainer)object;
< 			GenAuditContainer container = (GenAuditContainer)value;
< 			container.getPath().addAll(parent.getPath());
< 			container.getPath().add(parent);
159,159c190,190
< 			getOrCreateRoot(parent).getCategories().add(container);
---
> 			((List<EObject>)getOrCreateRoot(parent).eGet(feature_genAuditRoot_categories)).add(container);
160a192,195
> 		} else if (feature_genAuditContainer_audits.equals(feature) && class_genAuditContainer.isInstance(object)) {
> 			EObject container = object;
> 			EObject rule = (EObject)value;
> 			rule.eSet(feature_genAuditRule_category, container);
161,164d191
< 		} else if (GMFGenPackage.eINSTANCE.getGenAuditContainer_Audits().equals(feature) && object instanceof GenAuditContainer) {
< 			GenAuditContainer container = (GenAuditContainer)object;
< 			GenAuditRule rule = (GenAuditRule)value;
< 			rule.setCategory(container);
165,165c196,196
< 			getOrCreateRoot(container).getRules().add(rule);
---
> 			((List<EObject>)getOrCreateRoot(container).eGet(feature_genAuditRoot_rules)).add(rule);
166,169d196
< 		} else if (myGenAuditRule_ContextSelectorLocalClassName.equals(feature)) {
< 			GenAuditRule rule = (GenAuditRule) object;
< 			String className = (String) value;
< 			saveAuditContext(rule, className);
177,187d203
< 	private void saveAuditContext(GenAuditRule rule, String className) {
< 		if (myAuditContexts == null) {
< 			myAuditContexts = new LinkedHashMap<GenAuditRule, String>();
< 		}
< 		myAuditContexts.put(rule, className);
< 	}
< 	
< 	private Map<GenAuditRule, String> getSavedAuditContexts() {
< 		return myAuditContexts;
< 	}
< 
188,188c204,204
< 	private void saveRequiredPlugin(GenExpressionInterpreter expressionProvider, String requiredPlugin) {
---
> 	private void saveRequiredPlugin(EObject expressionProvider, String requiredPlugin) {
190,190c206,206
< 			myRequiredPlugins = new LinkedHashMap<GenExpressionInterpreter, Collection<String>>();
---
> 			myRequiredPlugins = new LinkedHashMap<EObject, Collection<String>>();
200,200c216,216
< 	private Map<GenExpressionInterpreter, Collection<String>> getSavedRequiredPlugins() {
---
> 	private Map<EObject, Collection<String>> getSavedRequiredPlugins() {
203a220,220
> 	@SuppressWarnings("unchecked")
207,207c224,224
< 			for (GenExpressionInterpreter expressionProvider : getSavedRequiredPlugins().keySet()) {
---
> 			for (EObject expressionProvider : getSavedRequiredPlugins().keySet()) {
208,208c225,225
< 				GenExpressionProviderContainer container = expressionProvider.getContainer();
---
> 				EObject container = (EObject) expressionProvider.eGet(feature_genExpressionProviderBase_container);
211,211c228,228
< 					container.getProviders().add(expressionProvider);
---
> 					((List<EObject>)container.eGet(feature_genExpressionProviderContainer_providers)).add(expressionProvider);
212a230,230
> 				EObject editor = (EObject) container.eGet(feature_genExpressionProviderContainer_editorGen);
213,213d229
< 				GenEditorGenerator editor = container.getEditorGen();
214a232,232
> 					editor = factory2006.create(class_genEditorGenerator);
215,215d231
< 					editor = GMFGenFactory.eINSTANCE.createGenEditorGenerator();
216,216c233,233
< 					container.eResource().getContents().add(editor);
---
> 					container.eResource().getContents().add(editor); //XXX!!!
217,217c234,234
< 					editor.setExpressionProviders(container);
---
> 					editor.eSet(feature_genEditorGenerator_expressionProviders, container);
218a236,236
> 				EObject plugin = (EObject) editor.eGet(feature_genEditorGenerator_plugin);
219,219d235
< 				GenPlugin plugin = editor.getPlugin();
220a238,239
> 					plugin = factory2006.create(class_genPlugin);
> 					editor.eSet(feature_genEditorGenerator_plugin, plugin);
221,222d237
< 					plugin = GMFGenFactory.eINSTANCE.createGenPlugin();
< 					editor.setPlugin(plugin);
224,224c241,241
< 				plugin.getRequiredPlugins().addAll(getSavedRequiredPlugins().get(expressionProvider));
---
> 				((List<String>)plugin.eGet(feature_genPlugin_requiredPlugins)).addAll(getSavedRequiredPlugins().get(expressionProvider));
229,262d245
< 		if (getSavedAuditContexts() != null) {
< 			for (GenAuditRule rule : getSavedAuditContexts().keySet()) {
< 				GenAuditRoot root = getOrCreateRoot(rule);
< 				String className = getSavedAuditContexts().get(rule);
< 				GenAuditContext context = getOrCreateContext(root, className);
< 				GenAuditable target = rule.getTarget();
< 				if (target != null) {
< 					target.setContextSelector(context);
< 					fireMigrationApplied(true);
< 				}
< 			}
< 			getSavedAuditContexts().clear();
< 		}
< 	}
< 	
< 	private GenAuditContext getOrCreateContext(GenAuditRoot root, String className) {
< 		GenAuditContext context = null;
< 		for (GenAuditContext next : root.getClientContexts()) {
< 			String explicit = next.getClassName();
< 			if (className.equals(explicit) || (explicit == null && className.equals(next.getId()))) {
< 				context = next;
< 				break;
< 			}
< 		}
< 		if (context == null) {
< 			context = GMFGenFactory.eINSTANCE.createGenAuditContext();
< 			String id = generateUnique(root, className);
< 			context.setId(id);
< 			if (!id.equals(className)) {
< 				context.setClassName(className);
< 			}
< 			root.getClientContexts().add(context);
< 		}
< 		return context;
264a248,248
> 	private EObject getOrCreateParenlessProvidersContainerOnce(EObject expressionProvider) {
265,282d247
< 	private String generateUnique(GenAuditRoot root, String defaultId) {
< 		String id = defaultId;
< 		int i = 0;
< 		boolean haveSuchId = false;
< 		do {
< 			haveSuchId = false;
< 			for (GenAuditContext next : root.getClientContexts()) {
< 				if (id.equals(next.getId())) {
< 					haveSuchId = true;
< 					id = defaultId + (++i);
< 					break;
< 				}
< 			}
< 		} while (haveSuchId);
< 		return id;
< 	}
< 
< 	private GenExpressionProviderContainer getOrCreateParenlessProvidersContainerOnce(GenExpressionInterpreter expressionProvider) {
283a250,250
> 			myProvidersContainer = factory2006.create(class_genExpressionProviderContainer);
284,284d249
< 			myProvidersContainer = GMFGenFactory.eINSTANCE.createGenExpressionProviderContainer();
289a256,257
> 	@SuppressWarnings("unchecked")
> 	private EObject getOrCreateRootContainerOnce(EObject root) {
290,290d255
< 	private GenAuditContainer getOrCreateRootContainerOnce(GenAuditRoot root) {
291a259,260
> 			myRootContainer = factory2006.create(class_genAuditContainer);
> 			((List<EObject>) root.eGet(feature_genAuditRoot_categories)).add(myRootContainer);
292,293d258
< 			myRootContainer = GMFGenFactory.eINSTANCE.createGenAuditContainer();
< 			root.getCategories().add(myRootContainer);
297a265,267
> 	@SuppressWarnings("unchecked")
> 	private EObject getOrCreateRoot(EObject auditContainer) {
> 		EObject result = (EObject) auditContainer.eGet(feature_genAuditContainer_root);
298,299d264
< 	private GenAuditRoot getOrCreateRoot(GenAuditContainer auditContainer) {
< 		GenAuditRoot result = auditContainer.getRoot();
301a270,270
> 			((List<EObject>) result.eGet(feature_genAuditRoot_categories)).add(auditContainer);
302,311d269
< 			result.getCategories().add(auditContainer);
< 		}
< 		return result;
< 	}
< 
< 	private GenAuditRoot getOrCreateRoot(GenAuditRule auditRule) {
< 		GenAuditRoot result = auditRule.getRoot();
< 		if (result == null) {
< 			result = createRoot(auditRule);
< 			result.getRules().add(auditRule);
316,316c275,275
< 	private GenAuditRoot createRoot(EObject child) {
---
> 	private EObject createRoot(EObject child) {
317,317c276,276
< 		GenAuditRoot result = GMFGenFactory.eINSTANCE.createGenAuditRoot();
---
> 		EObject result = factory2006.create(class_genAuditRoot);
323a283,305
> 
> 	/**
> 	 * Allows us to use dynamic 2006 factory to create all instances,
> 	 * i.e. factory of {@link #get2006GenModelPackage()} package.
> 	 */
> 	public String getURI(String prefix, String uri) {
> 		if (is2005GenModel(prefix, uri)) {
> 			return get2006GenModelURI();
> 		}
> 		return super.getURI(prefix, uri);
> 	}
> 	
> 	static boolean is2005GenModel(String prefix, String uri) {
> 		return "gmfgen".equals(prefix) && ("http://www.eclipse.org/gmf/2005/GenModel".equals(uri) || "http://www.eclipse.org/gmf/2005/GenModel/2.0".equals(uri)); //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$
> 	}
> 	
> 	static String get2006GenModelURI() {
> 		return "http://www.eclipse.org/gmf/2006/GenModel"; //$NON-NLS-1$
> 	}
> 
> 	private EPackage get2006GenModelPackage() {
> 		return EPackage.Registry.INSTANCE.getEPackage(get2006GenModelURI());
> 	}
