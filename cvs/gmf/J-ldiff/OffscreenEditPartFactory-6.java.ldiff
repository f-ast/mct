13a14,14
> import org.eclipse.gef.RootEditPart;
13a22,22
> import org.eclipse.jface.preference.IPreferenceStore;
14,14d21
< import org.eclipse.gef.GraphicalViewer;
15,15c23,23
< import org.eclipse.jface.util.Assert;
---
> import org.eclipse.jface.util.Assert;
16,16c24,24
< import org.eclipse.swt.widgets.Shell;
---
> import org.eclipse.swt.widgets.Shell;
17,17d24
< 
18a16,16
> import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramRootEditPart;
55,55c56,56
< 		GraphicalViewer customViewer = new DiagramGraphicalViewer();
---
> 		DiagramGraphicalViewer customViewer = new DiagramGraphicalViewer();
63a65,66
> 		// hook in preferences
> 		RootEditPart rep = EditPartService.getInstance()
64,64d64
< 		customViewer.setRootEditPart(EditPartService.getInstance()
65a68,75
> 		if (rep instanceof DiagramRootEditPart) {
> 			DiagramRootEditPart drep = (DiagramRootEditPart)rep;
> 			IPreferenceStore fPreferences = (IPreferenceStore) drep.getPreferencesHint().getPreferenceStore();
> 
> 			customViewer.hookWorkspacePreferenceStore(fPreferences);
> 		}
> 		
> 		customViewer.setRootEditPart(rep);
65,65c67,67
< 			.createRootEditPart(diagram));
---
> 		.createRootEditPart(diagram);
72a83,83
> 		
