12a13,14
> import java.util.Iterator;
> 
13,13c15,15
< import org.eclipse.emf.ecore.EObject;
---
> import org.eclipse.emf.ecore.EAnnotation;
16,18d17
< import org.eclipse.gef.commands.UnexecutableCommand;
< import org.eclipse.gmf.gmfgraph.DiagramElement;
< import org.eclipse.gmf.gmfgraph.FigureHandle;
19a19,19
> import org.eclipse.gmf.graphdef.editor.edit.commands.ChildAccessCreateCommand;
20,20c20,20
< import org.eclipse.gmf.graphdef.editor.edit.commands.DiagramElementFigureReorientCommand;
---
> import org.eclipse.gmf.graphdef.editor.edit.commands.ChildAccessReorientCommand;
24a25,25
> import org.eclipse.gmf.graphdef.editor.edit.parts.ChildAccessEditPart;
25,25c26,26
< import org.eclipse.gmf.graphdef.editor.edit.parts.DiagramElementFigureEditPart;
---
> import org.eclipse.gmf.graphdef.editor.edit.parts.EllipseEditPart;
25a27,30
> import org.eclipse.gmf.graphdef.editor.edit.parts.PolylineEditPart;
> import org.eclipse.gmf.graphdef.editor.edit.parts.Rectangle2EditPart;
> import org.eclipse.gmf.graphdef.editor.edit.parts.RoundedRectangleEditPart;
> import org.eclipse.gmf.graphdef.editor.part.GMFGraphVisualIDRegistry;
28,28d32
< import org.eclipse.gmf.runtime.emf.type.core.commands.SetValueCommand;
32,32c36,36
< import org.eclipse.gmf.runtime.emf.type.core.requests.ReorientReferenceRelationshipRequest;
---
> import org.eclipse.gmf.runtime.emf.type.core.requests.ReorientRelationshipRequest;
33,33c37,37
< import org.eclipse.gmf.runtime.emf.type.core.requests.SetRequest;
---
> import org.eclipse.gmf.runtime.notation.Node;
33a38,38
> import org.eclipse.gmf.runtime.notation.View;
44,44c49,49
< 		if (GMFGraphElementTypes.Rectangle_3002 == req.getElementType()) {
---
> 		if (GMFGraphElementTypes.Rectangle_3011 == req.getElementType()) {
46,46c51,51
< 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getFigure_Children());
---
> 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getRealFigure_Children());
48,48c53,53
< 			return getMSLWrapper(new Rectangle2CreateCommand(req));
---
> 			return getGEFWrapper(new Rectangle2CreateCommand(req));
50,50c55,55
< 		if (GMFGraphElementTypes.Ellipse_3003 == req.getElementType()) {
---
> 		if (GMFGraphElementTypes.Ellipse_3012 == req.getElementType()) {
52,52c57,57
< 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getFigure_Children());
---
> 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getRealFigure_Children());
54,54c59,59
< 			return getMSLWrapper(new EllipseCreateCommand(req));
---
> 			return getGEFWrapper(new EllipseCreateCommand(req));
56,56c61,61
< 		if (GMFGraphElementTypes.RoundedRectangle_3004 == req.getElementType()) {
---
> 		if (GMFGraphElementTypes.RoundedRectangle_3013 == req.getElementType()) {
58,58c63,63
< 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getFigure_Children());
---
> 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getRealFigure_Children());
60,60c65,65
< 			return getMSLWrapper(new RoundedRectangleCreateCommand(req));
---
> 			return getGEFWrapper(new RoundedRectangleCreateCommand(req));
62,62c67,67
< 		if (GMFGraphElementTypes.Polyline_3005 == req.getElementType()) {
---
> 		if (GMFGraphElementTypes.Polyline_3014 == req.getElementType()) {
64,64c69,69
< 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getFigure_Children());
---
> 				req.setContainmentFeature(GMFGraphPackage.eINSTANCE.getRealFigure_Children());
66,66c71,71
< 			return getMSLWrapper(new PolylineCreateCommand(req));
---
> 			return getGEFWrapper(new PolylineCreateCommand(req));
74a80,82
> 		CompoundCommand cc = getDestroyEdgesCommand();
> 		addDestroyChildNodesCommand(cc);
> 		addDestroyShortcutsCommand(cc);
75,75d79
< 		CompoundCommand cc = getDestroyEdgesCommand(req.isConfirmationRequired());
76,76c83,83
< 		cc.add(getMSLWrapper(new DestroyElementCommand(req)));
---
> 		cc.add(getGEFWrapper(new DestroyElementCommand(req)));
82a122,125
> 
> 	/**
> 	 * @generated
> 	 */
82a90,111
> 	protected void addDestroyChildNodesCommand(CompoundCommand cmd) {
> 		View view = (View) getHost().getModel();
> 		EAnnotation annotation = view.getEAnnotation("Shortcut"); //$NON-NLS-1$
> 		if (annotation != null) {
> 			return;
> 		}
> 		for (Iterator it = view.getChildren().iterator(); it.hasNext();) {
> 			Node node = (Node) it.next();
> 			switch (GMFGraphVisualIDRegistry.getVisualID(node)) {
> 			case Rectangle2EditPart.VISUAL_ID:
> 				cmd.add(getDestroyElementCommand(node));
> 				break;
> 			case EllipseEditPart.VISUAL_ID:
> 				cmd.add(getDestroyElementCommand(node));
> 				break;
> 			case RoundedRectangleEditPart.VISUAL_ID:
> 				cmd.add(getDestroyElementCommand(node));
> 				break;
> 			case PolylineEditPart.VISUAL_ID:
> 				cmd.add(getDestroyElementCommand(node));
> 				break;
> 			}
83,83c126,126
< 	protected Command getCreateRelationshipCommand(CreateRelationshipRequest req) {
---
> 	protected Command getStartCreateRelationshipCommand(CreateRelationshipRequest req) {
84,84c127,127
< 		if (GMFGraphElementTypes.DiagramElementFigure_4001 == req.getElementType()) {
---
> 		if (GMFGraphElementTypes.ChildAccess_4002 == req.getElementType()) {
84a128,128
> 			return null;
85,85d127
< 			return req.getTarget() == null ? null : getCreateCompleteIncomingDiagramElementFigure_4001Command(req);
87,87c154,154
< 		return super.getCreateRelationshipCommand(req);
---
> 		return super.getReorientRelationshipCommand(req);
92a118,120
> 	protected Command getCreateRelationshipCommand(CreateRelationshipRequest req) {
> 		Command command = req.getTarget() == null ? getStartCreateRelationshipCommand(req) : getCompleteCreateRelationshipCommand(req);
> 		return command != null ? command : super.getCreateRelationshipCommand(req);
93,97d117
< 	protected Command getCreateCompleteIncomingDiagramElementFigure_4001Command(CreateRelationshipRequest req) {
< 		EObject sourceEObject = req.getSource();
< 		EObject targetEObject = req.getTarget();
< 		if (false == sourceEObject instanceof DiagramElement || false == targetEObject instanceof FigureHandle) {
< 			return UnexecutableCommand.INSTANCE;
99,102d121
< 		DiagramElement source = (DiagramElement) sourceEObject;
< 		FigureHandle target = (FigureHandle) targetEObject;
< 		if (!GMFGraphBaseItemSemanticEditPolicy.LinkConstraints.canCreateDiagramElementFigure_4001(source, target)) {
< 			return UnexecutableCommand.INSTANCE;
103a130,130
> 		return null;
104,105d129
< 		SetRequest setReq = new SetRequest(sourceEObject, GMFGraphPackage.eINSTANCE.getDiagramElement_Figure(), target);
< 		return getMSLWrapper(new SetValueCommand(setReq));
108a134,143
> 	 * @generated
> 	 */
> 	protected Command getCompleteCreateRelationshipCommand(CreateRelationshipRequest req) {
> 		if (GMFGraphElementTypes.ChildAccess_4002 == req.getElementType()) {
> 			return getGEFWrapper(new ChildAccessCreateCommand(req, req.getSource(), req.getTarget()));
> 		}
> 		return null;
> 	}
> 
> 	/**
109,109c144,144
< 	 * Returns command to reorient EReference based link. New link target or source
---
> 	 * Returns command to reorient EClass based link. New link target or source
114,114c149,149
< 	protected Command getReorientReferenceRelationshipCommand(ReorientReferenceRelationshipRequest req) {
---
> 	protected Command getReorientRelationshipCommand(ReorientRelationshipRequest req) {
115a151,151
> 		case ChildAccessEditPart.VISUAL_ID:
116,116d150
< 		case DiagramElementFigureEditPart.VISUAL_ID:
117,117c152,152
< 			return getMSLWrapper(new DiagramElementFigureReorientCommand(req));
---
> 			return getGEFWrapper(new ChildAccessReorientCommand(req));
119,119d153
< 		return super.getReorientReferenceRelationshipCommand(req);
120a156,156
> 
