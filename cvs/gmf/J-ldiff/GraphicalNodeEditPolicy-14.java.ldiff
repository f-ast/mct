17a18,18
> import org.eclipse.core.commands.ExecutionException;
25a27,27
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
136a139,142
> 		protected CommandResult doExecuteWithResult(
>                 IProgressMonitor progressMonitor, IAdaptable info)
>             throws ExecutionException {
>             
137,137d138
< 		protected CommandResult doExecute(IProgressMonitor progressMonitor) {
138,138c143,143
< 			CommandResult cmdResult = super.doExecute(progressMonitor);
---
> 			CommandResult cmdResult = super.doExecuteWithResult(progressMonitor, info);
149,149c154,154
< 			return newOKCommandResult();
---
> 			return CommandResult.newOKCommandResult();
151a157,157
> 		protected CommandResult doUndoWithResult(IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
152,152d156
< 		protected CommandResult doUndo() {
156,156c161,161
< 			return super.doUndo();
---
> 			return super.doUndoWithResult(progressMonitor, info);
158a164,164
> 		protected CommandResult doRedoWithResult(IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
159,159d163
< 		protected CommandResult doRedo() {
163,163c168,168
< 			return super.doRedo();
---
> 			return super.doRedoWithResult(progressMonitor, info);
325a331,331
> 
328,328c334,334
< 			ICommand spc = new SetPropertyCommand(connection,
---
> 			ICommand spc = new SetPropertyCommand(
328a335,335
>                 getEditingDomain(), connection,
346a354,355
>         TransactionalEditingDomain editingDomain = getEditingDomain();
> 		
352,352c361,361
< 		SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(null);
---
> 		SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(editingDomain, null);
356,356c365,365
< 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(null);
---
> 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(editingDomain, null);
384a394,394
>             
385,385c395,395
< 			SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand();
---
> 			SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand(editingDomain);
405a416,417
>         TransactionalEditingDomain editingDomain = getEditingDomain();
>         
407,407c419,419
< 		SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(null);
---
> 		SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(editingDomain, null);
412,412c424,424
< 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(null);
---
> 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(editingDomain, null);
446a459,460
>         Iterator commandItr = cc.iterator();
>         commandItr.next(); //0
447,447c461,461
< 		SetConnectionEndsCommand sceCommand = (SetConnectionEndsCommand) cc
---
> 		SetConnectionEndsCommand sceCommand = (SetConnectionEndsCommand) commandItr.next(); //1
448,448d461
< 			.getCommands().get(1);
450,450c463,463
< 		SetConnectionAnchorsCommand scaCommand = (SetConnectionAnchorsCommand) cc
---
> 		SetConnectionAnchorsCommand scaCommand = (SetConnectionAnchorsCommand) commandItr.next(); //2
451,451d463
< 		.getCommands().get(2);
468,468c480,480
< 		SetConnectionBendpointsCommand sbbCommand = (SetConnectionBendpointsCommand) cc
---
> 		SetConnectionBendpointsCommand sbbCommand = (SetConnectionBendpointsCommand) commandItr.next(); //3
469,469d480
< 			.getCommands().get(3);
499a511,511
>         TransactionalEditingDomain editingDomain = getEditingDomain();
500,500c512,512
< 		CreateCommand createCommand = new CreateCommand(req
---
>         CreateCommand createCommand = new CreateCommand(editingDomain, req
503a516,517
>         
>         
504,504c518,518
< 		SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(null);
---
>         SetConnectionEndsCommand sceCommand = new SetConnectionEndsCommand(editingDomain, null);
509,509c523,523
< 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(null);
---
> 		SetConnectionAnchorsCommand scaCommand = new SetConnectionAnchorsCommand(editingDomain, null);
513,513c527,527
< 		SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand();
---
> 		SetConnectionBendpointsCommand sbbCommand = new SetConnectionBendpointsCommand(editingDomain);
873a888,891
>     private TransactionalEditingDomain getEditingDomain() {
>         return ((IGraphicalEditPart) getHost()).getEditingDomain();
>     }
> 
