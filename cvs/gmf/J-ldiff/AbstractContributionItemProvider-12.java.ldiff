61,61c37,37
< import org.eclipse.ui.PlatformUI;
---
> import org.eclipse.gmf.runtime.common.ui.util.ActivityUtil;
63,65d62
< import org.eclipse.ui.activities.IIdentifier;
< import org.eclipse.ui.activities.IWorkbenchActivitySupport;
< import org.eclipse.ui.activities.WorkbenchActivityHelper;
1020,1025d1016
<         if (!WorkbenchActivityHelper.isFiltering())
<             return true;
< 
<         IWorkbenchActivitySupport workbenchActivitySupport = PlatformUI
<             .getWorkbench().getActivitySupport();
< 
1026a1018,1019
>         if (!ActivityUtil.isEnabled(getPluginContribution().getLocalId(),
>             getPluginContribution().getPluginId())) {
1027,1031d1017
<         IIdentifier id = workbenchActivitySupport.getActivityManager()
<             .getIdentifier(
<                 WorkbenchActivityHelper
<                     .createUnifiedId(getPluginContribution()));
<         if (id != null && !id.isEnabled()) {
1035a1024,1025
>         if (!ActivityUtil.isEnabled(itemID, getPluginContribution()
>             .getPluginId())) {
1036,1047d1023
<         id = workbenchActivitySupport.getActivityManager().getIdentifier(
<             WorkbenchActivityHelper.createUnifiedId(new IPluginContribution() {
< 
<                 public String getLocalId() {
<                     return itemID;
<                 }
< 
<                 public String getPluginId() {
<                     return getPluginContribution().getPluginId();
<                 }
<             }));
<         if (id != null && !id.isEnabled()) {
