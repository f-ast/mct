2,2c2,2
<  * Copyright (c) 2002, 2005 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
24a25,25
> import org.eclipse.gmf.runtime.common.ui.action.AbstractActionHandler;
35a37,37
> import org.eclipse.gmf.runtime.common.ui.util.IPartSelector;
246a249,249
> 							item),
246,246c248,248
< 							partDescriptor),
---
> 							partDescriptor, 
255,255c258,258
< 						partDescriptor),
---
> 						partDescriptor, 
255a259,259
> 						item),
375,375c379,379
< 						partDescriptor),
---
> 						partDescriptor,
375a380,380
> 						item),
802a808,808
> 		private final IPartSelector partSelector;
808a815,815
>          * @param partSelector selects parts that match this contribution item
812,812c819,819
< 			IWorkbenchPartDescriptor partDescriptor) {
---
> 			IWorkbenchPartDescriptor partDescriptor,
812a820,821
> 			IPartSelector partSelector) {
> 			
814a824,824
> 			this.partSelector = partSelector;
820,820c830,830
< 				if (action != null)
---
> 				if (action != null) {
821,821c831,831
< 					return new PluginActionContributionItem(action);
---
> 					PluginActionContributionItem item = new PluginActionContributionItem(action);
821a832,837
> 					// set the part selector to minimize action refresh on parts that are not relevant
> 					if (partSelector != null) {
> 						item.setPartSelector(partSelector);
> 					}
> 					return item;
> 				}
1256a1273,1290
> 		
> 		/**
> 		 * Sets the part selector for this action. The part selector is used by
> 		 * the <code>AbstractActionHandler</code> to determine whether or not
> 		 * the action is applicable to a given selected part. If the part is not
> 		 * applicable, the action will not be refreshed when selection changes
> 		 * in the part.
> 		 * 
> 		 * @param partSelector
> 		 *            the part selector
> 		 */
> 		public void setPartSelector(IPartSelector partSelector) {
> 			IAction action = getAction();
> 			
> 			if (action instanceof AbstractActionHandler) {
> 				((AbstractActionHandler) action).setPartSelector(partSelector);
> 			}
> 		}
