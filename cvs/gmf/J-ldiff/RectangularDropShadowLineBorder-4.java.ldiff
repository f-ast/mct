18,18d17
< 
21,21c20,20
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
---
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
21a21,21
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
97,97c97,97
< 		insetsNew.bottom = MapMode.DPtoLP(insetsNew.bottom + getShadowHeight());
---
> 		insetsNew.bottom = MapModeUtil.getMapMode(figure).DPtoLP(insetsNew.bottom + getShadowHeight());
98,98c98,98
< 		insetsNew.right = MapMode.DPtoLP(insetsNew.right + getShadowWidth());
---
> 		insetsNew.right = MapModeUtil.getMapMode(figure).DPtoLP(insetsNew.right + getShadowWidth());
134,134c134,134
< 		insetsNew.bottom = MapMode.DPtoLP(getShadowHeight());
---
> 		insetsNew.bottom = MapModeUtil.getMapMode(figure).DPtoLP(getShadowHeight());
135,135c135,135
< 		insetsNew.right = MapMode.DPtoLP(getShadowWidth());
---
> 		insetsNew.right = MapModeUtil.getMapMode(figure).DPtoLP(getShadowWidth());
176a177,178
> 		IMapMode mm = MapModeUtil.getMapMode(figure);
> 		
180a183,183
> 			tempRect.width -= mm.DPtoLP(getShadowWidth());
181,181d182
< 			tempRect.width -= MapMode.DPtoLP(getShadowWidth());
182,182c184,184
< 			tempRect.height -= MapMode.DPtoLP(getShadowHeight());
---
> 			tempRect.height -= mm.DPtoLP(getShadowHeight());
183a186,186
> 				tempRect.width -= mm.DPtoLP(1);
184,184d185
< 				tempRect.width -= MapMode.DPtoLP(1);
185,185c187,187
< 				tempRect.height -= MapMode.DPtoLP(1);
---
> 				tempRect.height -= mm.DPtoLP(1);
187,187c189,189
< 			tempRect.shrink(MapMode.DPtoLP(getWidth() / 2), MapMode.DPtoLP(getWidth() / 2));
---
> 			tempRect.shrink(mm.DPtoLP(getWidth() / 2), mm.DPtoLP(getWidth() / 2));
