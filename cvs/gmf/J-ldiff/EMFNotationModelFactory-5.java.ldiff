20a23,23
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
21,21d22
< 
23,23d24
< import org.eclipse.gmf.runtime.diagram.core.internal.util.MEditingDomainGetter;
26,26d18
< import org.eclipse.gmf.runtime.emf.core.edit.MEditingDomain;
27,27c19,19
< import org.eclipse.gmf.runtime.emf.core.util.ResourceUtil;
---
> import org.eclipse.emf.common.util.EList;
27a20,20
> import org.eclipse.emf.common.util.URI;
43,46d41
< 	static public Diagram load(final IFile file) throws EmfNotationException {
< 		return load(file, MEditingDomain.INSTANCE);
< 	}
< 	
47,47c42,42
< 	static public Diagram load(final IFile file, MEditingDomain editingDomain) throws EmfNotationException {
---
> 	static public Diagram load(final IFile file, TransactionalEditingDomain editingDomain) throws EmfNotationException {
72a68,70
> 		EList contents = notationModel.getContents();
> 		if (!contents.isEmpty()) {
> 			Object element = contents.get(0);
73,73d67
< 		EObject element = ResourceUtil.getFirstRoot(notationModel);
74,74c71,71
< 		return (element instanceof Diagram) ? (Diagram)element : null;
---
> 			return (element instanceof Diagram) ? (Diagram) element
74a72,74
> 				: null;
> 		}
> 		return null;
82a83,85
> //            URI uri = URI.createPlatformResourceURI(fFile.getFullPath().toString(), true);
> 			notationModel.setURI(URI.createURI((fileName)));
> 			notationModel.save(null);
83,83d82
<             MEditingDomainGetter.getMEditingDomain(notationModel).saveResourceAs(notationModel, fileName);
84a87,87
> 			notationModel.save(null);
85,85d86
<         	MEditingDomainGetter.getMEditingDomain(notationModel).saveResource(notationModel);
