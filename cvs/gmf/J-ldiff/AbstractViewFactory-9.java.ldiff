2,2c2,2
<  * Copyright (c) 2005 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2006 IBM Corporation and others.
22a26,26
> import org.eclipse.gmf.runtime.notation.FontStyle;
23,23c27,27
< import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
---
> import org.eclipse.gmf.runtime.notation.LineStyle;
42a44,44
> 
78,78d79
< 		EObject semanticElement = null;
80,80c81,81
< 			semanticElement = (EObject)semanticAdapter.getAdapter(EObject.class);
---
> 			return requiresElement((EObject)semanticAdapter.getAdapter(EObject.class),view);
81,81d81
< 			return requiresElement(semanticElement,view);
95,95c95,95
< 		EObject containerSemanticElement = view.getElement();
---
> 		return !(semanticElement == view.getElement());		
96,98d95
< 		if (containerSemanticElement==semanticElement)
< 			return false;
< 		return true;
111a109,111
>         LineStyle lineStyle = (LineStyle) view
> 			.getStyle(NotationPackage.Literals.LINE_STYLE);
> 		if (lineStyle != null) {
113,113d112
< 		RGB lineRGB =
114,114c113,113
< 			PreferenceConverter.getColor(
---
> 			RGB lineRGB = PreferenceConverter.getColor(store,
115,115d113
< 				store,
117,117d114
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getLineStyle_LineColor(), FigureUtilities.RGBToInteger(lineRGB));
118a116,123
> 			lineStyle.setLineColor(FigureUtilities.RGBToInteger(lineRGB)
> 				.intValue());
> 		}
> 
> 		FontStyle fontStyle = (FontStyle) view
> 			.getStyle(NotationPackage.Literals.FONT_STYLE);
> 
> 		if (fontStyle != null) {
120,120d124
< 		FontData fontData =
121,121c125,125
< 			PreferenceConverter.getFontData(
---
> 			FontData fontData = PreferenceConverter.getFontData(store,
122,122d125
< 				store,
123a127,130
> 			fontStyle.setFontName(fontData.getName());
> 			fontStyle.setFontHeight(fontData.getHeight());
> 			fontStyle.setBold((fontData.getStyle() & SWT.BOLD) != 0);
> 			fontStyle.setItalic((fontData.getStyle() & SWT.ITALIC) != 0);
124,128d126
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontName(), fontData.getName());
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontHeight(), new Integer(fontData.getHeight()));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Bold(), Boolean.valueOf((fontData.getStyle() & SWT.BOLD) != 0));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Italic(), Boolean.valueOf((fontData.getStyle() & SWT.ITALIC) != 0));
< 
130,130d131
< 		RGB fontRGB =
131,131c132,132
< 			PreferenceConverter.getColor(
---
> 			RGB fontRGB = PreferenceConverter.getColor(store,
132,132d132
< 				store,
133a134,137
> 			fontStyle.setFontColor(FigureUtilities.RGBToInteger(fontRGB)
> 				.intValue());
> 		}
> 
134,134d133
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontColor(), FigureUtilities.RGBToInteger(fontRGB));
