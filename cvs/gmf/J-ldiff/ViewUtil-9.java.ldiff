20a21,21
> import org.eclipse.core.commands.ExecutionException;
24a26,26
> import org.eclipse.emf.transaction.impl.InternalTransactionalEditingDomain;
25a28,32
> import org.eclipse.gmf.runtime.common.core.util.Log;
> import org.eclipse.gmf.runtime.common.core.util.Trace;
> import org.eclipse.gmf.runtime.diagram.core.internal.DiagramDebugOptions;
> import org.eclipse.gmf.runtime.diagram.core.internal.DiagramPlugin;
> import org.eclipse.gmf.runtime.diagram.core.internal.DiagramStatusCodes;
82a90,90
>         
83,83d89
< 		if (editingDomain.isUndoIntervalOpen() &&
84,84c91,91
< 			!view.isMutable()) {
---
> 		if (!view.isMutable()) {
89a97,110
> 					new PersistElementCommand(editingDomain, viewToPersist);
>                 
>                 try {
>                     pvc.execute( new NullProgressMonitor(), null );
>                     
>                 } catch (ExecutionException e) {
>                     Trace.catching(DiagramPlugin.getInstance(),
>                         DiagramDebugOptions.EXCEPTIONS_CATCHING,
>                         ViewUtil.class, "persistElement", e); //$NON-NLS-1$
>                     Log.error(DiagramPlugin.getInstance(),
>                         DiagramStatusCodes.IGNORED_EXCEPTION_WARNING, e
>                             .getLocalizedMessage(), e);
>                 }
>                 
90,91d96
< 					new PersistElementCommand(viewToPersist);
< 				pvc.execute( new NullProgressMonitor() );
