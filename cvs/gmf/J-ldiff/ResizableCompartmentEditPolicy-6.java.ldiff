29a30,30
> import org.eclipse.gmf.runtime.diagram.ui.editparts.ResizableCompartmentEditPart;
37,37c38,38
<  * A resizable editpolicy for resizable compartments. The editpolicy could be vertical
---
>  * A resizable editpolicy for resizable compartments. The editpolicy could be
38,38c39,39
<  * or horizontal
---
>  * vertical or horizontal
42a44,44
> 	extends ResizableEditPolicyEx {
42,42c43,43
< public class ResizableCompartmentEditPolicy extends ResizableEditPolicyEx {
---
> public class ResizableCompartmentEditPolicy
53,53c57,57
< 	
---
> 	 * 
70,70c72,72
< 	 * This method is used to get the collapse handle(s). Subclasses can override
---
> 	 * This method is used to get the collapse handle(s). Subclasses can
71,71c73,73
< 	 * to provide different collapse handles 
---
> 	 * override to provide different collapse handles
88a91,91
> 			: PositionConstants.NORTH;
88,88c90,90
< 		int d1 = isHorizontal() ? PositionConstants.WEST : PositionConstants.NORTH;
---
> 		int d1 = isHorizontal() ? PositionConstants.WEST
89,89c92,92
< 		int d2 = isHorizontal() ? PositionConstants.EAST : PositionConstants.SOUTH;
---
> 		int d2 = isHorizontal() ? PositionConstants.EAST
89a93,93
> 			: PositionConstants.SOUTH;
102a102,123
> 	 * @return the <code>ResizableCompartmentFigure</code> that is the
> 	 *         corresponding figure for the host edit part.
> 	 */
> 	private ResizableCompartmentFigure getCompartmentFigure() {
> 		ResizableCompartmentFigure compartmentFigure = null;
> 		if (getGraphicalEditPart() instanceof ResizableCompartmentEditPart) {
> 			compartmentFigure = ((ResizableCompartmentEditPart) getGraphicalEditPart())
> 				.getCompartmentFigure();
> 		} else if (getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure) {
> 			compartmentFigure = (ResizableCompartmentFigure) getGraphicalEditPart()
> 				.getFigure();
> 		}
> 		// TODO: remove later. this is a temporary fix for defect
> 		// RATLC00522565
> 		// eventually we will put the GatedPaneFigure inside the resizable
> 		// compartment
> 		else if (getGraphicalEditPart().getFigure() instanceof GatedPaneFigure) {
> 			GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart()
> 				.getFigure();
> 			IFigure f = gpf.getElementPane();
> 			if (f instanceof ResizableCompartmentFigure) {
> 				compartmentFigure = (ResizableCompartmentFigure) f;
102a136,138
> 			ResizableCompartmentFigure compartmentFigure = getCompartmentFigure();
> 			if (compartmentFigure != null) {
> 				compartmentFigure.setSelected(true);
103,106d101
< 			if ( getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure){
< 			ResizableCompartmentFigure f = 
< 				(ResizableCompartmentFigure) getGraphicalEditPart().getFigure();
< 			f.setSelected(true);
107,107c124,124
< 			}
---
> 			}
108,114d124
< 			// TODO: remove later.  this is a temporary fix for defect RATLC00522565
< 			// eventually we will put the GatedPaneFigure inside the resizable compartment
< 			if ( getGraphicalEditPart().getFigure() instanceof GatedPaneFigure){
< 				GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart().getFigure();
< 				IFigure f = gpf.getElementPane();
< 				if( f instanceof ResizableCompartmentFigure ) {
< 					((ResizableCompartmentFigure)f).setSelected(true);
115,115c125,125
< 				}
---
> 		}
115a126,130
> 
> 		return compartmentFigure;
> 	}
> 
> 	/**
125a149,151
> 			ResizableCompartmentFigure compartmentFigure = getCompartmentFigure();
> 			if (compartmentFigure != null) {
> 				compartmentFigure.setSelected(false);
126,138d148
< 			if ( getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure){
< 				ResizableCompartmentFigure f =
< 					(ResizableCompartmentFigure) getGraphicalEditPart().getFigure();
< 				f.setSelected(false);
< 			}
< 			//TODO: remove later.  this is a temporary fix for defect RATLC00522565
< 			// eventually we will put the GatedPaneFigure inside the resizable compartment
< 			if ( getGraphicalEditPart().getFigure() instanceof GatedPaneFigure){
< 				GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart().getFigure();
< 				IFigure f = gpf.getElementPane();
< 				if( f instanceof ResizableCompartmentFigure ) {
< 					((ResizableCompartmentFigure)f).setSelected(false);
< 				}
143a157,157
> 
144a159,159
> 
151a167,167
> 
159a176,176
> 
166a184,184
> 
168a187,187
> 					notification.getFeature()))
168,168c186,186
< 				if (NotationPackage.eINSTANCE.getView_Visible().equals(notification.getFeature()))
---
> 				if (NotationPackage.eINSTANCE.getView_Visible().equals(
172,172c191,191
< 		PresentationListener.getInstance().addNotificationListener(getGraphicalEditPart().getNotationView(),propertyListener);
---
> 		PresentationListener.getInstance().addNotificationListener(
172a192,192
> 			getGraphicalEditPart().getNotationView(), propertyListener);
179,179c199,199
< 		PresentationListener.getInstance().removeNotificationListener(getGraphicalEditPart().getNotationView(),propertyListener);
---
> 		PresentationListener.getInstance().removeNotificationListener(
179a200,200
> 			getGraphicalEditPart().getNotationView(), propertyListener);
184a206,207
> 	 * Determine the select state of the policy based on: 1- The select state of
> 	 * the compartment editpart 2- The select state of the parent graphic
185,187d205
< 	 * Determine the select state of the policy based on:
< 	 * 1- The select state of the compartment editpart
< 	 * 2- The select state of the parent graphic editpart
188,188c208,208
< 	 * 3- The visibility state of the compartment editpart 
---
> 	 * editpart 3- The visibility state of the compartment editpart
194,194c214,214
< 		if (((GraphicalEditPart)getGraphicalEditPart()).getTopGraphicEditPart()!=null){
---
> 		if (((GraphicalEditPart) getGraphicalEditPart())
194a215,215
> 			.getTopGraphicEditPart() != null) {
195a217,217
> 				.getTopGraphicEditPart().getSelected();
195,195c216,216
< 			topState = ((GraphicalEditPart)getGraphicalEditPart()).getTopGraphicEditPart().getSelected();	
---
> 			topState = ((GraphicalEditPart) getGraphicalEditPart())
201,201c223,223
< 			&& ((hostState != EditPart.SELECTED_NONE || 
---
> 			&& ((hostState != EditPart.SELECTED_NONE || topState != EditPart.SELECTED_NONE)))
202,202d223
< 			topState != EditPart.SELECTED_NONE)))
232,232c253,253
< 	 * Creates a new ChangeBoundsRequest that respects the min and max of the resize deltas
---
> 	 * Creates a new ChangeBoundsRequest that respects the min and max of the
232a254,254
> 	 * resize deltas
237,237d258
< 		ResizableCompartmentFigure f =
238a260,260
> 		
238,238c259,259
< 			(ResizableCompartmentFigure) getHostFigure();
---
> 		ResizableCompartmentFigure f = getCompartmentFigure();
243,243d264
< 		boolean moved =
244,244c265,265
< 			(r.getResizeDirection() & PositionConstants.NORTH_WEST) != 0;
---
> 		boolean moved = (r.getResizeDirection() & PositionConstants.NORTH_WEST) != 0;
