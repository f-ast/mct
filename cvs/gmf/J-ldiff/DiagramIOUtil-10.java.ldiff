2,2c2,2
<  * Copyright (c) 2002, 2003 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
32a33,33
> import org.eclipse.gmf.runtime.common.core.util.Log;
87a89,91
> 			
> 			logResourceErrorsAndWarnings(resource);
> 						
91a96,108
> 	private static void logResourceErrorsAndWarnings(Resource resource) {
> 		for (Iterator iter = resource.getErrors().iterator(); iter.hasNext();) {
> 			Resource.Diagnostic diagnostic = (Resource.Diagnostic) iter.next();
> 			Log.error(EditorPlugin.getInstance(), EditorStatusCodes.ERROR, diagnostic.getMessage());				
> 		}
> 
> 		for (Iterator iter = resource.getWarnings().iterator(); iter.hasNext();) {
> 			Resource.Diagnostic diagnostic = (Resource.Diagnostic) iter.next();
> 			Log.warning(EditorPlugin.getInstance(), EditorStatusCodes.WARNING, diagnostic.getMessage());				
> 		}
> 	}
> 
> 	
101a119,123
>             String storageName = fStorage.getName();
>             URI uri = URI.createPlatformResourceURI(storageName);
>             Resource resource = editingDomain.getResourceSet().getResource(uri,false);
>             if (resource == null) {
>                 resource = editingDomain.getResourceSet().createResource(uri);
102a125,128
>             if (!resource.isLoaded()) {
>                 resource.load(fStorage.getContents(), loadOptions);
>             }
> 			logResourceErrorsAndWarnings(resource);
102,102c124,124
<             
---
>             }
103,106d124
< 			String storagePath = fStorage.getFullPath().toString();
<  
< 			Resource resource = editingDomain.getResourceSet().getResource(
< 				URI.createPlatformResourceURI(storagePath, true), true);
141,141c163,163
< 					Throwable causeError = e.getWrappedException();
---
> 					Throwable causeError = e.getCause();
149,149c171,171
< 						Exception exc = ((Resource.IOWrappedException) causeError)
---
> 						Exception exc = (Exception)((Resource.IOWrappedException) causeError)
150,150c172,172
< 							.getWrappedException();
---
> 							.getCause();
172a195,195
>                         throw e;
173,173d194
< 						throw new CoreException(new Status(IStatus.ERROR, EditorPlugin.getPluginId(), EditorStatusCodes.ERROR, UNABLE_TO_LOAD_DIAGRAM, causeError));
194a217,219
>             } else {
>                 String exceptionMessage = e.getLocalizedMessage();
>                 thrownExcp = new CoreException(new Status(IStatus.ERROR,
195,195d216
< 			} else
196a221,223
>                     exceptionMessage != null ? exceptionMessage
>                         : "load(IFile, boolean)", e)); //$NON-NLS-1$
>             }
196,196c220,220
< 				thrownExcp = new CoreException(new Status(IStatus.ERROR, EditorPlugin.getPluginId(), EditorStatusCodes.ERROR, e.getMessage(), e));
---
>                     EditorPlugin.getPluginId(), EditorStatusCodes.ERROR,
227a255,256
> 		
> 		logResourceErrorsAndWarnings(notationModel);
248,248d276
< 
