14a15,15
> import org.eclipse.draw2d.geometry.Dimension;
25,25c26,26
< import org.eclipse.gmf.runtime.diagram.ui.editparts.BorderItemEditPart;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IBorderItemEditPart;
25a27,27
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart;
26,26c28,28
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure;
---
> import org.eclipse.gmf.runtime.diagram.ui.figures.IBorderItemLocator;
27,27d28
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure.BorderItemLocator;
34,34c35,35
<  * Edit policy to restrict border item movement along border of bordered item.
---
>  * Edit policy to restrict border item movement.
36,36c37,37
<  * @author jbruck
---
>  * @author jbruck, cmahoney
66a68,71
> 		IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost();
> 		IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator();
> 		
> 		if (borderItemLocator != null) {
67,69d67
< 		BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost();
< 		BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP
< 			.getLocator();
77a80,80
> 				.getCopy(), borderItemEP.getFigure());
77,77c79,79
< 		Rectangle realLocation = borderItemLocator.locateOnBorder(rect
---
> 			Rectangle realLocation = borderItemLocator.getValidLocation(rect
78,78d79
< 			.getCopy());
82a85,85
> 	}
91a95,96
> 		IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost();
> 		IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator();
92,94d94
< 		BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost();
< 		BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP
< 			.getLocator();
95a98,98
> 		if (borderItemLocator != null) {
103,103c106,106
< 		Rectangle realLocation = borderItemLocator.locateOnBorder(rect
---
> 			Rectangle realLocation = borderItemLocator.getValidLocation(rect
103a107,112
> 				.getCopy(), borderItemEP.getFigure());
> 
> 			Point parentOrigin = ((IGraphicalEditPart) borderItemEP.getParent())
> 				.getFigure().getBounds().getTopLeft();
> 			Dimension d = realLocation.getTopLeft().getDifference(parentOrigin);
> 			Point location = new Point(d.width, d.height);
104,106d106
< 			.getCopy());
< 		Point location = borderItemLocator.getRelativeToBorder(realLocation
< 			.getTopLeft());
112a119,120
> 		return null;
> 	}
117a126,126
> 
