36a37,37
> import org.eclipse.gmf.runtime.diagram.ui.render.util.CopyToHTMLImageUtil;
132,132d132
< 
134a135,143
> 		runCopyToImageUI(dialog);
> 	}
> 	
> 	/**
> 	 * Displays the dialog and performs <code>OutOfMemoryError</code> checking
> 	 * 
> 	 * @param dialog the copy to image dialog
> 	 */
> 	private void runCopyToImageUI(CopyToImageDialog dialog) {
161a171,171
> 							.getTargetException());
161,161c170,170
< 					.getTargetException().getMessage(), e.getTargetException());
---
> 							.getTargetException().getMessage(), e
163a174,174
> 				if (dialog.exportToHTML()) {
164a176,184
> 				} else {
> 					if (MessageDialog
> 							.openQuestion(
> 									Display.getDefault().getActiveShell(),
> 									DiagramUIRenderMessages.CopyToImageOutOfMemoryDialog_title,
> 									DiagramUIRenderMessages.CopyToImageOutOfMemoryDialog_message)) {
> 						runCopyToImageUI(dialog);
> 					}
> 				}					
169a190,190
> 				if (dialog.exportToHTML()) {
171a193,201
> 					if (MessageDialog
> 							.openQuestion(
> 									Display.getDefault().getActiveShell(),
> 									DiagramUIRenderMessages.CopyToImageOutOfMemoryDialog_title,
> 									DiagramUIRenderMessages.CopyToImageOutOfMemoryDialog_message)) {
> 						runCopyToImageUI(dialog);
> 					}
> 				}					
> 			} else {
206a237,242
> 					CopyToImageUtil copyToImageUtil = null;
> 					if (dialog.exportToHTML()) {
> 						copyToImageUtil = new CopyToHTMLImageUtil();
> 					} else {
> 						copyToImageUtil = new CopyToImageUtil();
> 					}
215a252,252
> 						copyToImageUtil.copyToImage(
216,216d251
< 						new CopyToImageUtil().copyToImage(
228,228c264,264
< 						new CopyToImageUtil().copyToImage(getDiagramEditPart(),
---
> 						copyToImageUtil.copyToImage(getDiagramEditPart(),
