47a48,48
> import org.eclipse.swt.widgets.Shell;
231a233,234
>         Shell shell = new Shell();
>         try {
236,236c239,239
<             DiagramEditPart dgrmEP = PrintHelper.createDiagramEditPart((Diagram) obj, preferencesHint);
---
>                 DiagramEditPart dgrmEP = PrintHelper.createDiagramEditPart((Diagram) obj, preferencesHint, shell);
263a267,269
>         } finally {
>             shell.dispose();
>         }        
264,264d266
<         
