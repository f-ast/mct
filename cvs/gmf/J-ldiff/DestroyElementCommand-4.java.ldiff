2,2c2,2
<  * Copyright (c) 2005 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2006 IBM Corporation and others.
13a14,15
> import org.eclipse.core.commands.ExecutionException;
> import org.eclipse.core.runtime.IAdaptable;
14,15d13
< import java.util.Collection;
< 
18,18c19,19
< import org.eclipse.emf.ecore.EReference;
---
> import org.eclipse.gmf.runtime.emf.core.util.EMFCoreUtil;
19,19d19
< 
47a47,48
> 	protected CommandResult doExecuteWithResult(IProgressMonitor monitor, IAdaptable info)
> 	    throws ExecutionException {
48,50d46
< 	protected CommandResult doExecute(IProgressMonitor progressMonitor) {
< 
< 		EReference reference = getElementToDestroy().eContainmentFeature();
51a50,51
> 		if (getElementToDestroy().eResource() != null) {
> 			EMFCoreUtil.destroy(getElementToDestroy());
52,57d49
< 		if (reference.isMany()) {
< 			((Collection) getElementToEdit().eGet(reference))
< 				.remove(getElementToDestroy());
< 			
< 		} else {
< 			getElementToEdit().eSet(reference, null);
59,59c53,53
< 		return newOKCommandResult();
---
> 		return CommandResult.newOKCommandResult();
69a64,64
> 	public boolean canExecute() {
70,75d63
< 	/*
< 	 * (non-Javadoc)
< 	 * 
< 	 * @see org.eclipse.gmf.runtime.emf.commands.core.internal.commands.EditElementCommand#isExecutable()
< 	 */
< 	public boolean isExecutable() {
