20,20c20,20
< import org.eclipse.emf.common.util.BasicDiagnostic;
---
> import org.eclipse.emf.common.util.Diagnostic;
97,97c97,97
< 			IStatus loadStatus = loadGenModel();
---
> 			Diagnostic loadStatus = loadGenModel();
102a103,104
> 			Diagnostic isGenModelValid = validateGenModel();
> 			if (!ValidationHelper.isOK(isGenModelValid)) {
103,106d102
< 			IStatus isGenModelValid = validateGenModel();
< 			if (!isGenModelValid.isOK()) {
< 				final String[] buttons = new String[] { IDialogConstants.PROCEED_LABEL, IDialogConstants.CANCEL_LABEL };
< 				final int[] buttonIDs = new int[] { IDialogConstants.PROCEED_ID, IDialogConstants.CANCEL_ID };
108,108c106,106
< 				ErrorDialogEx dlg = new ErrorDialogEx(getShell(), getName(), msg, isGenModelValid, buttons, buttonIDs, 0);
---
> 				if (DiagnosticsDialog.openProceedCancel(getShell(), getName(), msg, isGenModelValid) == IDialogConstants.CANCEL_ID) {
109,109d106
< 				if (dlg.open() == IDialogConstants.CANCEL_ID) {
148a146,147
> 		if (!ValidationHelper.isOK(loadStatus)) {
> 			boolean disableProceed = myGenModel == null; // we cannot proceed further as there is no gmfgen, disable proceed button
148,148c145,145
< 	private boolean canProcessGMFGenModel(IStatus loadStatus) {
---
> 	private boolean canProcessGMFGenModel(Diagnostic loadStatus) {
149,158d145
< 		if (!loadStatus.isOK()) {
< 			String[] buttons = new String[] { IDialogConstants.PROCEED_LABEL, IDialogConstants.CANCEL_LABEL };
< 			int[] buttonIDs = new int[] { IDialogConstants.PROCEED_ID, IDialogConstants.CANCEL_ID };
< 			if (myGenModel == null) {
< 				// we cannot proceed further as there is no gmfgen, allow only cancel
< 				buttons = new String[] { buttons[1] };
< 				buttonIDs = new int[] { buttonIDs[1] };
< 			}
< 			ErrorDialogEx dlg = new ErrorDialogEx(getShell(), getName(), CodeGenUIPlugin.getBundleString("generatecode.badsrc"), //$NON-NLS-1$ 
< 					loadStatus, buttons, buttonIDs, 0);
159a149,149
> 				DiagnosticsDialog.openProceedCancel(getShell(), getName(), null, loadStatus, disableProceed)) {
159,159c148,148
< 			if (dlg.open() == IDialogConstants.CANCEL_ID) {
---
> 			if (IDialogConstants.CANCEL_ID == 
197,197c187,187
< 	private IStatus loadGenModel() {
---
> 	private Diagnostic loadGenModel() {
209,209c199,199
< 		return loadHelper.getStatus();
---
> 		return loadHelper.getDiagnostics();
219,219c209,209
< 	private IStatus validateGenModel() {
---
> 	private Diagnostic validateGenModel() {
220,220c210,210
< 		return BasicDiagnostic.toIStatus(ValidationHelper.validate(getGenModel(), true));
---
> 		return ValidationHelper.validate(getGenModel(), true);
