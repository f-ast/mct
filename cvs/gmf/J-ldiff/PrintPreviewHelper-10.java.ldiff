121,130d120
< 	 * Total number of rows taken required for the diagram
< 	 */
< 	protected int totalNumberOfRows = -1;
< 
< 	/**
< 	 * Total number of columns required for the diagram
< 	 */
< 	protected int totalNumberOfColumns = -1;
< 
< 	/**
352,354d341
< 		totalNumberOfRows = -1;
< 		totalNumberOfColumns = -1;
< 		
368a356,363
> 		
>         //check for rtl orientation...
>         int style = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell().getStyle();
>         if ((style & SWT.MIRRORED) != 0) {
>             shell = new Shell(display, SWT.APPLICATION_MODAL | SWT.TITLE
>                 | SWT.CLOSE | SWT.BORDER | SWT.RIGHT_TO_LEFT);
>         }
>         else
371a367,368
> 		
> 
512a510,516
>         if ((style & SWT.MIRRORED) != 0) {
>             //switch left and right for RTL...
>             leftTool.setToolTipText(DiagramUIPrintingMessages.PrintPreview_RightToolItem);
>             leftTool.setImage(rightImage);
>             leftTool.setDisabledImage(disabledRightImage);
>         }
>         else { 
515a520,521
>         }
> 		
538a545,551
>         if ((style & SWT.MIRRORED) != 0) {
>             //switch left and right for RTL
>             rightTool.setToolTipText(DiagramUIPrintingMessages.PrintPreview_LeftToolItem);
>             rightTool.setImage(leftImage);
>             rightTool.setDisabledImage(disabledLeftImage);
>         }
>         else { 
541a555,556
>         }
> 		
712,712d726
< 		if (totalNumberOfRows < 0) {
715,715c729,729
< 					.getPageSize(getPreferenceStore(), false, getMapMode()).y;
---
> 				.getPageSize(getPreferenceStore(), true, getMapMode()).y;
716,716c730,730
< 			totalNumberOfRows = Math.max(1, (int) Math.ceil(numRows));
---
> 		return Math.max(1, (int) Math.ceil(numRows));
717,719d730
< 		}
< 
< 		return totalNumberOfRows;
819,819d829
< 		if (totalNumberOfColumns < 0) {
822,822c832,832
< 					.getPageSize(getPreferenceStore(), false, getMapMode()).x;
---
> 				.getPageSize(getPreferenceStore(), true, getMapMode()).x;
823,823c833,833
< 			totalNumberOfColumns = Math.max(1, (int) Math.ceil(numCols));
---
> 		return Math.max(1, (int) Math.ceil(numCols));
824,826d833
< 		}
< 
< 		return totalNumberOfColumns;
1023a1031,1037
>         GC gc = null;
>         
>         //check for rtl orientation...
>         if ((shell.getStyle() & SWT.MIRRORED) != 0) {
>             gc = new GC(image, SWT.RIGHT_TO_LEFT);
>         }
>         else
1024,1024c1038,1038
< 		GC gc = new GC(image);
---
>             gc = new GC(image);
