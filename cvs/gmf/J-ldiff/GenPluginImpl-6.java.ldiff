27,27c28,28
< import org.eclipse.gmf.codegen.gmfgen.GenLink;
---
> import org.eclipse.gmf.codegen.gmfgen.ValueExpression;
28,28d28
< import org.eclipse.gmf.codegen.gmfgen.GenNode;
30,32d27
< import org.eclipse.gmf.codegen.gmfgen.LinkModelFacet;
< import org.eclipse.gmf.codegen.gmfgen.TypeLinkModelFacet;
< import org.eclipse.gmf.codegen.gmfgen.TypeModelFacet;
326a323,328
> 		for(Iterator it = getDiagram().eAllContents(); it.hasNext();) {
> 			Object nextObj = it.next();
> 			if(nextObj instanceof ValueExpression) {				
> 				String lang = ((ValueExpression)nextObj).getLanguage();
> 				if("ocl".equals(lang)) { //$NON-NLS-1$
> 					requiredIDs.add("org.eclipse.emf.query.ocl"); //$NON-NLS-1$
327,347d322
< 		for (Iterator it = getDiagram().getAllNodes().iterator(); it.hasNext();) {
< 			GenNode nextNode = (GenNode) it.next();
< 			TypeModelFacet modelFacet = nextNode.getModelFacet();
< 			if(modelFacet.getModelElementInitializer() != null) {
< 				requiredIDs.addAll(modelFacet.getModelElementInitializer().getRequiredPluginIDs());
< 			}
< 			if(modelFacet.getModelElementSelector() != null) {
< 				requiredIDs.addAll(modelFacet.getModelElementSelector().getRequiredPluginIDs());				
< 			}
< 		}
< 		
< 		for (Iterator it = getDiagram().getLinks().iterator(); it.hasNext();) {
< 			GenLink nextLink = (GenLink) it.next();
< 			LinkModelFacet modelFacet = nextLink.getModelFacet();
< 			if(modelFacet instanceof TypeLinkModelFacet) {
< 				TypeLinkModelFacet  typeModelFacet = (TypeLinkModelFacet)modelFacet;
< 				if(typeModelFacet.getModelElementInitializer() != null) {
< 					requiredIDs.addAll(typeModelFacet.getModelElementInitializer().getRequiredPluginIDs());
< 				}
< 				if(typeModelFacet.getModelElementSelector() != null) {
< 					requiredIDs.addAll(typeModelFacet.getModelElementSelector().getRequiredPluginIDs());
350a332,332
> 		
