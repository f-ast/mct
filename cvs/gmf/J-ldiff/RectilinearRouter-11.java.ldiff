65a67,67
> 		if (sourceFigure == null)
66,66c65,65
< 		if (conn.getSourceAnchor().getOwner() == null)
---
>         IFigure sourceFigure = conn.getSourceAnchor().getOwner();
68a70,70
> 		PointList startPolygon = getFigurePolygon(sourceFigure,conn);
69,72d69
< 		Rectangle startRect =
< 			new Rectangle(conn.getSourceAnchor().getOwner().getBounds());
< 		conn.getSourceAnchor().getOwner().translateToAbsolute(startRect);
< 		conn.translateToRelative(startRect);
74a73,73
>             boolean in1 = PointListUtilities.containsPoint(startPolygon, newPoints.getPoint(i));
75,75d72
< 			boolean in1 = startRect.contains(newPoints.getPoint(i));
76,76c74,74
< 			boolean in2 = startRect.contains(newPoints.getPoint(i + 1));
---
>  			boolean in2 = PointListUtilities.containsPoint(startPolygon, newPoints.getPoint(i+1));
98,98d95
< 
99,99c96,96
< 		if (conn.getTargetAnchor().getOwner() == null)
---
> 		IFigure targetFigure = conn.getTargetAnchor().getOwner();
99a97,97
> 		if (targetFigure == null)
101a100,100
>         PointList endPolygon = getFigurePolygon(targetFigure,conn);
102,106d99
< 		Rectangle endRect =
< 			new Rectangle(conn.getTargetAnchor().getOwner().getBounds());
< 		conn.getTargetAnchor().getOwner().translateToAbsolute(endRect);
< 		conn.translateToRelative(endRect);
< 
107a102,102
> 		    boolean in1 = PointListUtilities.containsPoint(endPolygon,newPoints.getPoint(i));
108,108d101
< 			boolean in1 = endRect.contains(newPoints.getPoint(i));
109,109c103,103
< 			boolean in2 = endRect.contains(newPoints.getPoint(i - 1));
---
> 			boolean in2 = PointListUtilities.containsPoint(endPolygon,newPoints.getPoint(i - 1));
674a669,669
>    
