42,42c56,56
< import org.eclipse.jface.util.Assert;
---
> import org.eclipse.jface.util.Assert;
43,43d56
< 
55,55c53,53
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
---
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
55a54,54
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
69a259,259
> 	 *      
70,70d258
< 
71a71,72
>     private int layoutDefaultMargin = 0;
>     private IMapMode mm;
72,73d70
< 
< 	protected static final int LAYOUTDEFAULTMARGIN = MapMode.DPtoLP(25);
78a78,86
> 	
> 	/**
> 	 * @return the <code>IMapMode</code> that maps coordinates from
> 	 * device to logical and vice-versa.
> 	 */
> 	protected IMapMode getMapMode() {
> 		return mm;
> 	}
> 
101a110,110
> 		mm = MapModeUtil.getMapMode(containerEditPart.getFigure());
133a143,144
> 		mm = MapModeUtil.getMapMode(containerEditPart.getFigure());
> 		
624a637,637
> 		layoutDefaultMargin = MapModeUtil.getMapMode(diagramEP.getFigure()).DPtoLP(25);
625,625d636
< 
667,667c679,679
< 				PointListUtilities.normalizeSegments(points, MapMode.DPtoLP(3));
---
> 				PointListUtilities.normalizeSegments(points, MapModeUtil.getMapMode(cep.getFigure()).DPtoLP(3));
765,765c777,777
< 		return new Point(LAYOUTDEFAULTMARGIN, LAYOUTDEFAULTMARGIN);
---
> 		return new Point(layoutDefaultMargin, layoutDefaultMargin);
