2,2c2,2
<  * Copyright (c) 2006 IBM Corporation and others.
---
>  * Copyright (c) 2006, 2007 IBM Corporation and others.
128a129,133
> 	 * the path argument passed into the dialog.
> 	 */
> 	private IPath path;
> 
> 	/**
203a209,213
> 	 * The string with a html file extension.
> 	 */
> 	private static final String HTML_STRING = "html"; //$NON-NLS-1$
> 
> 	/**
236a247,249
> 		
> 		this.path = path;
> 		
237,237c250,250
< 		initDialogSettings(path);
---
> 		initDialogSettings();
359,359c372,372
< 		String extension = exportToHTML ? "html" : imageFormat.getName().toLowerCase();
---
> 		String extension = exportToHTML ? HTML_STRING : imageFormat.getName().toLowerCase();
480,480c493,493
< 			extension.append("html");
---
> 			extension.append(HTML_STRING);
520,520c533,533
< 			File path = new File(dirName);
---
> 			File aPath = new File(dirName);
521,521c534,534
< 			if (path.exists())
---
> 			if (aPath.exists())
541a555,555
> 		IPath aPath = new Path(EMPTY_STRING);
542,542d554
< 		IPath path = new Path(EMPTY_STRING);
543,543c556,556
< 		if (!path.isValidPath(folderText.getText())) {
---
> 		if (!aPath.isValidPath(folderText.getText())) {
633,636d645
< 	 * 
< 	 * @param path
< 	 *            the default path to use for the diagram file or null if the
< 	 *            dialog should use some default path.
638,638c647,647
< 	private void initDialogSettings(IPath path) {
---
> 	private void initDialogSettings() {
640a653,654
> 		} else {
> 
641,644d652
< 		// By defualt, the folder will be the root of the filesystem, where ever
< 		//  that may be on a system.
< 		folder = "/"; //$NON-NLS-1$
< 		
645,645c655,655
< 		if (path == null) {
---
> 			if (path == null) {
645a656,658
> 				// By default, the folder will be the root of the filesystem,
> 				// where ever that may be on a system.
> 				folder = "/"; //$NON-NLS-1$
649,649c662,662
< 			}
---
> 		}
673a684,689
> 		if (! path.toOSString().equals(folder)) {
> 			// only persist the folder if the user changed the value.
> 			// We like to save diagrams in a folder different to the 
> 			// <workspace>/project_name folder and have the Save As 
> 			// Image File dialog remember this setting and display 
> 			// it as the new default. 
674a691,691
> 		}
