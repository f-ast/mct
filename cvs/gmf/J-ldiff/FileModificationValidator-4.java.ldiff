23a24,24
> import org.eclipse.ui.PlatformUI;
112a114,114
> 	 * 
138a141,146
> 	public boolean okToEdit(final IFile[] files, final String modificationReason) {
> 		final boolean result[] = new boolean[] {false};
> 
> 		PlatformUI.getWorkbench().getDisplay().syncExec(new Runnable() {
> 
> 			public void run() {
139,139d140
< 	public boolean okToEdit(IFile[] files, String modificationReason) {
140a148,148
> 					files,
140,140c147,147
< 		IStatus status = ResourcesPlugin.getWorkspace().validateEdit(files,
---
> 				IStatus status = ResourcesPlugin.getWorkspace().validateEdit(
141,141c149,149
< 			Display.getCurrent().getActiveShell());
---
> 					PlatformUI.getWorkbench().getActiveWorkbenchWindow()
141a150,150
> 						.getShell());
142a152,152
> 					result[0] = true;
143,143d151
< 			return true;
144a154,157
> 
> 					MessageDialog.openError(PlatformUI.getWorkbench()
> 						.getActiveWorkbenchWindow().getShell(), MessageFormat
> 						.format(editProblemDialogTitle,
145,146d153
< 			MessageDialog.openError(Display.getCurrent().getActiveShell(),
< 				MessageFormat.format(editProblemDialogTitle,
147,147c158,158
< 					new Object[] {modificationReason}), MessageFormat.format(
---
> 							new Object[] {modificationReason}), MessageFormat
148,148c159,159
< 					editProblemDialogMessage_part1,
---
> 						.format(editProblemDialogMessage_part1,
154a166,167
> 					result[0] = false;
> 				}
155,155d165
< 			return false;
156a169,170
> 		});
> 		return result[0];
