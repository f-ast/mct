44,44d43
< import org.eclipse.gmf.gmfgraph.Shape;
160a160,161
> 		RealFigure realFigure = getRealFigure();
> 		if (realFigure == null || realFigure.getLayoutData() == null) {
161,162d159
< 		Shape shape = getShape();
< 		if (shape == null || shape.getLayoutData() == null) {
165,165c164,164
< 		LayoutData layoutData = shape.getLayoutData();
---
> 		LayoutData layoutData = realFigure.getLayoutData();
376a376,376
> 	protected RealFigure getRealFigure() {
377,377d375
< 	protected Shape getShape() {
379,379c378,378
< 		if (view != null && view.getElement() instanceof Shape) {
---
> 		if (view != null && view.getElement() instanceof RealFigure) {
380,380c379,379
< 			return (Shape) view.getElement();
---
> 			return (RealFigure) view.getElement();
393,393c392,392
< 		Font modelFont = getShape().getFont();
---
> 		Font modelFont = getRealFigure().getFont();
