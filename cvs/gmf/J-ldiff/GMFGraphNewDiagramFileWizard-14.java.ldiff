14,14d13
< import java.util.Collections;
21,21c39,39
< import org.eclipse.core.runtime.CoreException;
---
> import org.eclipse.osgi.util.NLS;
66,66c66,66
< 	public GMFGraphNewDiagramFileWizard(org.eclipse.emf.common.util.URI domainModelURI, EObject diagramRoot, TransactionalEditingDomain editingDomain) {
---
> 	public GMFGraphNewDiagramFileWizard(URI domainModelURI, EObject diagramRoot, TransactionalEditingDomain editingDomain) {
71,71c71,71
< 		myFileCreationPage = new WizardNewFileCreationPage("Initialize new diagram file", StructuredSelection.EMPTY);
---
> 		myFileCreationPage = new WizardNewFileCreationPage(Messages.GMFGraphNewDiagramFileWizard_CreationPageName, StructuredSelection.EMPTY);
72,72c72,72
< 		myFileCreationPage.setTitle("Diagram file");
---
> 		myFileCreationPage.setTitle(Messages.GMFGraphNewDiagramFileWizard_CreationPageTitle);
73,73c73,73
< 		myFileCreationPage.setDescription("Create new diagram based on " + CanvasEditPart.MODEL_ID + " model content");
---
> 		myFileCreationPage.setDescription(NLS.bind(Messages.GMFGraphNewDiagramFileWizard_CreationPageDescription, CanvasEditPart.MODEL_ID));
82,82c82,82
< 			throw new IllegalArgumentException("Unsupported URI: " + domainModelURI);
---
> 			throw new IllegalArgumentException("Unsupported URI: " + domainModelURI); //$NON-NLS-1$
86a87,89
> 		diagramRootElementSelectionPage = new DiagramRootElementSelectionPage(Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageName);
> 		diagramRootElementSelectionPage.setTitle(Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageTitle);
> 		diagramRootElementSelectionPage.setDescription(Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageDescription);
87,89d86
< 		diagramRootElementSelectionPage = new DiagramRootElementSelectionPage("Select diagram root element");
< 		diagramRootElementSelectionPage.setTitle("Diagram root element");
< 		diagramRootElementSelectionPage.setDescription("Select semantic model element to be depicted on diagram");
108a109,109
> 		GMFGraphDiagramEditorUtil.setCharset(diagramFile);
109,113d108
< 		try {
< 			diagramFile.setCharset("UTF-8", new NullProgressMonitor()); //$NON-NLS-1$
< 		} catch (CoreException e) {
< 			GMFGraphDiagramEditorPlugin.getInstance().logError("Unable to set charset for diagram file", e); //$NON-NLS-1$
< 		}
114a25,25
> import org.eclipse.emf.common.util.URI;
114a111,111
> 		URI diagramModelURI = URI.createPlatformResourceURI(diagramFile.getFullPath().toString(), true);
115,115d24
< 		org.eclipse.emf.common.util.URI diagramModelURI = org.eclipse.emf.common.util.URI.createPlatformResourceURI(diagramFile.getFullPath().toString(), true);
118,118c114,114
< 		AbstractTransactionalCommand command = new AbstractTransactionalCommand(myEditingDomain, "Initializing diagram contents", affectedFiles) { //$NON-NLS-1$
---
> 		AbstractTransactionalCommand command = new AbstractTransactionalCommand(myEditingDomain, Messages.GMFGraphNewDiagramFileWizard_InitDiagramCommand, affectedFiles) {
122a119,119
> 					return CommandResult.newErrorCommandResult(Messages.GMFGraphNewDiagramFileWizard_IncorrectRootError);
123,123d118
< 					return CommandResult.newErrorCommandResult("Incorrect model object stored as a root resource object"); //$NON-NLS-1$
132,132c128,128
< 			diagramResource.save(Collections.EMPTY_MAP);
---
> 			diagramResource.save(GMFGraphDiagramEditorUtil.getSaveOptions());
159a156,156
> 			return Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageSelectionTitle;
160,160d155
< 			return "Select diagram root element:";
167a164,164
> 				setErrorMessage(Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageNoSelectionMessage);
168,168d163
< 				setErrorMessage("Diagram root element is not selected");
172a169,169
> 			setErrorMessage(result ? null : Messages.GMFGraphNewDiagramFileWizard_RootSelectionPageInvalidSelectionMessage);
173,173d168
< 			setErrorMessage(result ? null : "Invalid diagram root element is selected");
