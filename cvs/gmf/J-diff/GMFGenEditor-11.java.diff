1148c1148
< 						// Save the resource to the file system.
---
> 						// Save the resources to the file system.
1150,1152c1150,1158
< 						Resource savedResource = (Resource)editingDomain.getResourceSet().getResources().get(0);
< 						savedResources.add(savedResource);
< 						savedResource.save(Collections.EMPTY_MAP);
---
> 						boolean first = true;
> 						for (Iterator i = editingDomain.getResourceSet().getResources().iterator(); i.hasNext(); ) {
> 							Resource resource = (Resource)i.next();
> 							if ((first || !resource.getContents().isEmpty()) && !editingDomain.isReadOnly(resource)) {
> 								savedResources.add(resource);
> 								resource.save(Collections.EMPTY_MAP);
> 							}
> 							first = false;
> 						}
