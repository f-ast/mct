14d13
< import java.awt.Graphics2D;
23a23
> import org.apache.batik.bridge.BridgeContext;
38a39
> import org.eclipse.swt.graphics.Color;
41a43
> import org.w3c.dom.Element;
48a51
> 	private ImageTranscoderEx transcoder;
70a74
> 		transcoder = null;
79a84
> 			transcoder = new ImageTranscoderEx();
122a128,148
> 	/**
> 	 * Reads color value from the document.
> 	 */
> 	protected Color getColor(Element element, String attributeName) {
> 		Document document = getDocument();
> 		if (document == null || transcoder == null) {
> 			return null;
> 		}
> 		Color color = null;
> 		// Make sure that CSSEngine is available.
> 		BridgeContext ctx = transcoder.initCSSEngine(document);
> 		try {
> 			color = SVGUtils.toSWTColor(element, attributeName);
> 		} finally {
> 			if (ctx != null) {
> 				ctx.dispose();
> 			}
> 		}
> 		return color;
> 	}
> 
165,171c191
< 		ImageTranscoderEx transcoder = new ImageTranscoderEx() {
< 
< 			@Override
< 			protected Graphics2D createGraphics(int w, int h) {
< 				return new SVGGraphics2D(graphics);
< 			}
< 		};
---
> 		transcoder.setDraw2DGraphics(graphics);
178,179c198
< 			// SimpleImageTranscoder transcoder = new SimpleImageTranscoder();
< 			ImageTranscoderEx transcoder = new ImageTranscoderEx();
---
> 			transcoder.setDraw2DGraphics(null);
