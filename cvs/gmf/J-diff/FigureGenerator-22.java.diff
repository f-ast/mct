82a83
> 	private final boolean myIsInnerClassCode;
84,85c85,86
< 	public FigureGenerator(FigureQualifiedNameSwitch figureNameSwitch) {
< 		this(figureNameSwitch, new MapModeCodeGenStrategy.RuntimeUnspecifiedMapMode());
---
> 	public FigureGenerator(FigureQualifiedNameSwitch figureNameSwitch, boolean asInnerClass) {
> 		this(figureNameSwitch, new MapModeCodeGenStrategy.RuntimeUnspecifiedMapMode(), asInnerClass);
88c89,90
< 	public FigureGenerator(FigureQualifiedNameSwitch figureNameSwitch, MapModeCodeGenStrategy mapModeStrategy) {
---
> 	public FigureGenerator(FigureQualifiedNameSwitch figureNameSwitch, MapModeCodeGenStrategy mapModeStrategy, boolean placeStaticFieldsOutsideClassBody) {
> 		myIsInnerClassCode = placeStaticFieldsOutsideClassBody;
180,182c182,184
< 		myTopDispatcher.setImportManager(importManager);
< 		myInnerDispatcher.setImportManager(importManager);
< 		Object args = new Object[] {fig, importManager, myTopDispatcher.getFQNSwitch(), myInnerDispatcher};
---
> 		myTopDispatcher.resetForNewClass(importManager);
> 		myInnerDispatcher.resetForNewClass(importManager);
> 		Object args = new Object[] {fig, importManager, myTopDispatcher.getFQNSwitch(), myInnerDispatcher, Boolean.valueOf(myIsInnerClassCode)};
