22a23
> import org.eclipse.emf.ecore.EDataType;
29c30
< import org.eclipse.emf.ecore.xmi.XMLResource;
---
> import org.eclipse.emf.ecore.resource.Resource;
46,47c47,48
< 	private Map<EClass, Map<String, EStructuralFeature>> myRenamedParentAttributes = new HashMap<EClass, Map<String, EStructuralFeature>>();
< 	private XMLResource myResource;
---
> 	private Map<EClass, Map<String, EStructuralFeature>> myTracedHierarchyFeatures = new HashMap<EClass, Map<String, EStructuralFeature>>();
> 	private Resource myResource;
58,59c59,64
< 	public void registerRenamedParentAttributes(EClass eClass, Map<String, EStructuralFeature> renamedAttributes) {
< 		myRenamedParentAttributes.put(eClass, renamedAttributes);
---
> 	/**
> 	 * Traced feature is a feature you use through the hierarchy as a marker, catching it in setValue and notifying of
> 	 * whether migration has happened or not
> 	 */
> 	public void registerTracedFeatureForHierarchy(EClass eClass, Map<String, EStructuralFeature> tracedFeature) {
> 		myTracedHierarchyFeatures.put(eClass, tracedFeature);
79,82c84,91
< 	public void registerRenamedParentAttribute(EClass eClass, String oldName, EStructuralFeature newStructuralFeature) {
< 		Map<String, EStructuralFeature> renamedAttributes = myRenamedParentAttributes.get(eClass);
< 		if (renamedAttributes == null) {
< 			renamedAttributes = new HashMap<String, EStructuralFeature>();
---
> 	/**
> 	 * Traced feature is a feature you use through the hierarchy as a marker, catching it in setValue and notifying of
> 	 * whether migration has happened or not
> 	 */
> 	public void registerTracedFeatureForHierarchy(EClass eClass, String xmlName, EStructuralFeature tracerFeature) {
> 		Map<String, EStructuralFeature> tracedFeatures = myTracedHierarchyFeatures.get(eClass);
> 		if (tracedFeatures == null) {
> 			tracedFeatures = new HashMap<String, EStructuralFeature>();
84,85c93,94
< 		renamedAttributes.put(oldName, newStructuralFeature);
< 		registerRenamedParentAttributes(eClass, renamedAttributes);
---
> 		tracedFeatures.put(xmlName, tracerFeature);
> 		registerTracedFeatureForHierarchy(eClass, tracedFeatures);
107,109c116,118
< 	public EStructuralFeature getRenamedParentFeatureFor(EClass clazz, String name) {
< 	    Map<String, EStructuralFeature> renamings = myRenamedParentAttributes.get(clazz);
< 	    EStructuralFeature result = renamings != null ? renamings.get(name) : null;
---
> 	public EStructuralFeature getTracedParentFeatureFor(EClass clazz, String name) {
> 	    Map<String, EStructuralFeature> tracings = myTracedHierarchyFeatures.get(clazz);
> 	    EStructuralFeature result = tracings != null ? tracings.get(name) : null;
112c121
< 			result = getRenamedParentFeatureFor(nextParent, name);
---
> 			result = getTracedParentFeatureFor(nextParent, name);
131,133d139
< 		} else if ((rename = getRenamedParentFeatureFor(eClass, name)) != null) {
< 			result = rename;
< 			fireMigrationApplied(true);
136a143,146
> 		} else if ((rename = getTracedParentFeatureFor(eClass, name)) != null) {
> 			result = rename;
> 			// if somebody has provided a feature to trace, it is his own business to notify us of whether 
> 			// a migration is required and has happened, cause it is not necessary that anything has been actually changed.
159,160c169
< 	public String getID(EObject obj) {
< 		return null;
---
> 	public void preResolve() {
163c172
< 	public void postProcess() {
---
> 	public void processObject(EObject result) {
166c175,176
< 	public void processObject(EObject result) {
---
> 	public boolean setManyReference(EObject object, EStructuralFeature feature, Object[] values) {
> 		return false;
191c201
< 	protected static EAttribute createNewAttribute(String name, EClassifier eType, boolean isMany) {
---
> 	protected static EAttribute createNewAttribute(String name, EDataType eType, boolean isMany) {
195c205
< 	protected static EAttribute createNewAttribute(String name, EClassifier eType, boolean isMany, boolean isObligatory) {
---
> 	protected static EAttribute createNewAttribute(String name, EDataType eType, boolean isMany, boolean isObligatory) {
204c214
< 	public void setResource(XMLResource resource) {
---
> 	public void setResource(Resource resource) {
208c218
< 	protected XMLResource getResource() {
---
> 	protected Resource getResource() {
210a221,223
> 
> 	public void postLoad(){
> 	}
