2c2
<  * Copyright (c) 2006 Borland Software Corporation and others.
---
>  * Copyright (c) 2006, 2007 Borland Software Corporation and others.
38a39,42
> import org.eclipse.emf.ecore.util.FeatureMap;
> 
> import org.eclipse.emf.edit.provider.IWrapperItemProvider;
> 
80,81d83
< import org.eclipse.ui.ide.IDE;
< 
172c174
< 		final Resource diagramResource = resourceSet.createResource(URI.createPlatformResourceURI(diagramFile.getFullPath().toString()));
---
> 		final Resource diagramResource = resourceSet.createResource(URI.createPlatformResourceURI(diagramFile.getFullPath().toString(), true));
194c196
< 			IDE.openEditor(myWorkbenchPage, diagramFile);
---
> 			GMFGraphDiagramEditorUtil.openDiagram(diagramResource);
266,267c268,278
< 				if (selection.size() == 1 && selection.getFirstElement() instanceof EObject) {
< 					myDiagramRoot = (EObject) selection.getFirstElement();
---
> 				if (selection.size() == 1) {
> 					Object selectedElement = selection.getFirstElement();
> 					if (selectedElement instanceof IWrapperItemProvider) {
> 						selectedElement = ((IWrapperItemProvider) selectedElement).getValue();
> 					}
> 					if (selectedElement instanceof FeatureMap.Entry) {
> 						selectedElement = ((FeatureMap.Entry) selectedElement).getValue();
> 					}
> 					if (selectedElement instanceof EObject) {
> 						myDiagramRoot = (EObject) selectedElement;
> 					}
