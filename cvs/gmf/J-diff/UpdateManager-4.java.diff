2c2
<  * Copyright (c) 2006 Eclipse.org
---
>  * Copyright (c) 2006, 2007 Borland Software Corporation
16d15
< import java.util.Iterator;
38,40c37,45
< 		Collection affectedEditParts = findAffectedParts(msg);
< 		for(Iterator it = affectedEditParts.iterator(); it.hasNext(); ) {
< 			IUpdatableEditPart next = (IUpdatableEditPart) it.next();
---
> 		Collection<IUpdatableEditPart> affectedEditParts = findAffectedParts(msg);
> 		for(IUpdatableEditPart next : affectedEditParts) {
> 			if (next instanceof IExternallyUpdatableEditPart) {
> 				for (IExternallyUpdatableEditPart.ExternalRefresher nextExternalRefresher : ((IExternallyUpdatableEditPart) next).getExternalRefreshers()) {
> 					if (nextExternalRefresher.isAffectingEvent(msg)) {
> 						nextExternalRefresher.refresh();
> 					}
> 				}
> 			}
48c53
< 	private Collection/*<IUpdatableEditPart>*/ findAffectedParts(Notification msg) {
---
> 	private Collection<IUpdatableEditPart> findAffectedParts(Notification msg) {
54,55c59,60
< 				if (affectedEditPart != null) {
< 					return Collections.singleton(affectedEditPart);
---
> 				if (affectedEditPart instanceof IUpdatableEditPart) {
> 					return Collections.singleton((IUpdatableEditPart) affectedEditPart);
59c64
< 		return Collections.EMPTY_LIST;
---
> 		return Collections.emptyList();
