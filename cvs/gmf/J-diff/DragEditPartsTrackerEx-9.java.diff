28a29
> import org.eclipse.gmf.runtime.diagram.ui.editparts.GroupEditPart;
200a202,239
>     protected boolean handleButtonDown(int button) {
> 
>         // If the group is selected, and the user clicks on a shape, defer the
>         // selection of the shape until the mouse button is released instead of
>         // selecting on mouse down because if the user does a drag they will
>         // move the entire group and not the shape.
>         if (button == 1
>             && getSourceEditPart().getParent() instanceof GroupEditPart
>             && getSourceEditPart().getParent().getSelected() != EditPart.SELECTED_NONE) {
> 
>             stateTransition(STATE_INITIAL, STATE_DRAG);
>             return true;
>         }
> 
>         return super.handleButtonDown(button);
>     }
> 
>     protected boolean handleDoubleClick(int button) {
>         // If the user double-clicks a shape in a group and the shape is not
>         // selected, select the shape.
>         if (getSourceEditPart().getParent() instanceof GroupEditPart
>             && getSourceEditPart().getSelected() == EditPart.SELECTED_NONE) {
>             performSelection();
>             return true;
>         } else {
>             return super.handleDoubleClick(button);
>         }
>     }
> 
>     protected void performSelection() {
>         super.performSelection();
> 
>         // If the new selection is a child of a group, we want to deselect the group.
>         if (getSourceEditPart().getParent() instanceof GroupEditPart
>             && getSourceEditPart().getParent().getSelected() != EditPart.SELECTED_NONE) {
>             getCurrentViewer().deselect(getSourceEditPart().getParent());
>         }
>     }
