21,25d20
< import org.eclipse.jface.operation.IRunnableContext;
< import org.eclipse.ui.IEditorInput;
< import org.eclipse.ui.PlatformUI;
< import org.osgi.framework.Bundle;
< 
29a25,28
> import org.eclipse.jface.operation.IRunnableContext;
> import org.eclipse.ui.IEditorInput;
> import org.eclipse.ui.PlatformUI;
> import org.osgi.framework.Bundle;
54a54,55
> 		public DiagramModificationListener fListener = null;
> 
61c62
< 		public DiagramResourceInfo(IDocument document) {
---
> 		public DiagramResourceInfo(IDocument document, DiagramModificationListener listener) {
62a64
> 			fListener = listener;
120c122,123
< 			ElementInfo info= new DiagramResourceInfo(document);
---
> 			DiagramModificationListener listener = new DiagramModificationListener(this, (DiagramDocument)document);
> 			ElementInfo info= new DiagramResourceInfo(document, listener);
121a125
> 			listener.startListening();
128a133,138
> 	protected void disposeElementInfo(Object element, ElementInfo info) {
> 		super.disposeElementInfo(element, info);
> 		
> 		((DiagramResourceInfo)info).fListener.stopListening();
> 	}
> 
