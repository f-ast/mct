17a18
> import org.eclipse.draw2d.RectangleFigure;
18a20
> import org.eclipse.draw2d.XYLayout;
21a24
> import org.eclipse.emf.ecore.EObject;
25c28
< import org.eclipse.gmf.gmfgraph.Shape;
---
> import org.eclipse.gmf.graphdef.editor.edit.policies.Polyline3CanonicalEditPolicy;
27c30
< import org.eclipse.gmf.graphdef.editor.edit.polocies.DomainBasedXYLayoutEditPolicy;
---
> import org.eclipse.gmf.graphdef.editor.edit.polocies.PointContainerXYLayoutEditPolicy;
30a34,35
> import org.eclipse.gmf.runtime.diagram.ui.editpolicies.CreationEditPolicy;
> import org.eclipse.gmf.runtime.diagram.ui.editpolicies.DragDropEditPolicy;
31a37
> import org.eclipse.gmf.runtime.draw2d.ui.figures.ConstrainedToolbarLayout;
67a74
> 		installEditPolicy(EditPolicyRoles.CREATION_ROLE, new CreationEditPolicy());
69a77,78
> 		installEditPolicy(EditPolicyRoles.DRAG_DROP_ROLE, new DragDropEditPolicy());
> 		installEditPolicy(EditPolicyRoles.CANONICAL_ROLE, new Polyline3CanonicalEditPolicy());
79c88
< 		return new DomainBasedXYLayoutEditPolicy(getMapMode());
---
> 		return new PointContainerXYLayoutEditPolicy(getMapMode());
118c127,132
< 		contentPane = setupContentPane(shape);
---
> 		RectangleFigure childContainer = new RectangleFigure();
> 		childContainer.setFill(false);
> 		childContainer.setOutline(false);
> 		figure.add(childContainer);
> 		childContainer.setLayoutManager(new XYLayout());
> 		contentPane = childContainer;
128a143,147
> 		if (nodeShape.getLayoutManager() == null) {
> 			ConstrainedToolbarLayout layout = new ConstrainedToolbarLayout();
> 			layout.setSpacing(getMapMode().DPtoLP(5));
> 			nodeShape.setLayoutManager(layout);
> 		}
163,166c182,189
< 	private org.eclipse.gmf.gmfgraph.Polyline getModelFigureElement() {
< 		Shape shape = getShape();
< 		if (shape instanceof org.eclipse.gmf.gmfgraph.Polyline) {
< 			org.eclipse.gmf.gmfgraph.Polyline modelFigureElement = (org.eclipse.gmf.gmfgraph.Polyline) shape;
---
> 	private org.eclipse.gmf.gmfgraph.Polyline getGmfgraphElement() {
> 		View view = getNotationView();
> 		if (view == null) {
> 			return null;
> 		}
> 		EObject element = view.getElement();
> 		if (element instanceof org.eclipse.gmf.gmfgraph.Polyline) {
> 			org.eclipse.gmf.gmfgraph.Polyline modelFigureElement = (org.eclipse.gmf.gmfgraph.Polyline) element;
176c199
< 		org.eclipse.gmf.gmfgraph.Polyline modelElement = (org.eclipse.gmf.gmfgraph.Polyline) getModelFigureElement();
---
> 		org.eclipse.gmf.gmfgraph.Polyline modelElement = getGmfgraphElement();
189c212
< 		org.eclipse.gmf.gmfgraph.Polyline modelElement = (org.eclipse.gmf.gmfgraph.Polyline) getModelFigureElement();
---
> 		org.eclipse.gmf.gmfgraph.Polyline modelElement = getGmfgraphElement();
213c236
< 		final org.eclipse.gmf.gmfgraph.Polyline modelElement = (org.eclipse.gmf.gmfgraph.Polyline) getModelFigureElement();
---
> 		final org.eclipse.gmf.gmfgraph.Polyline modelElement = getGmfgraphElement();
