42,43d41
< import org.eclipse.jface.util.Assert;
< 
55c53,54
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
---
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
56a56
> import org.eclipse.jface.util.Assert;
70d69
< 
72,73c71,72
< 
< 	protected static final int LAYOUTDEFAULTMARGIN = MapMode.DPtoLP(25);
---
>     private int layoutDefaultMargin = 0;
>     private IMapMode mm;
78a78,86
> 	
> 	/**
> 	 * @return the <code>IMapMode</code> that maps coordinates from
> 	 * device to logical and vice-versa.
> 	 */
> 	protected IMapMode getMapMode() {
> 		return mm;
> 	}
> 
101a110
> 		mm = MapModeUtil.getMapMode(containerEditPart.getFigure());
133a143,144
> 		mm = MapModeUtil.getMapMode(containerEditPart.getFigure());
> 		
247a259
> 	 *      
625c637
< 
---
> 		layoutDefaultMargin = MapModeUtil.getMapMode(diagramEP.getFigure()).DPtoLP(25);
667c679
< 				PointListUtilities.normalizeSegments(points, MapMode.DPtoLP(3));
---
> 				PointListUtilities.normalizeSegments(points, MapModeUtil.getMapMode(cep.getFigure()).DPtoLP(3));
765c777
< 		return new Point(LAYOUTDEFAULTMARGIN, LAYOUTDEFAULTMARGIN);
---
> 		return new Point(layoutDefaultMargin, layoutDefaultMargin);
