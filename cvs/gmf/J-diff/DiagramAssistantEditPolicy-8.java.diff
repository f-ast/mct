2c2
<  * Copyright (c) 2005 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2006 IBM Corporation and others.
17c17
< import org.eclipse.emf.transaction.RunnableWithResult;
---
> import org.eclipse.emf.ecore.EObject;
21,23d20
< import org.eclipse.gmf.runtime.common.core.util.Log;
< import org.eclipse.gmf.runtime.common.core.util.Trace;
< import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
26,28d22
< import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIDebugOptions;
< import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIPlugin;
< import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIStatusCodes;
58c52
< 		 * Creates a new instance.
---
> 		 * Sets mouse location
63c57
< 		protected ShowDiagramAssistantRunnable(Point originalMouseLocation) {
---
> 		public void setOriginalMouseLocation(Point originalMouseLocation) {
89c83,84
< 	private Runnable hideDiagramAssistantRunnable = new Runnable() {
---
> 	private class HideDiagramAssistantRunnable implements Runnable
> 	{
101c96
< 	};
---
> 	}
155a151,153
> 	private ShowDiagramAssistantRunnable showDiagramAssistantRunnable = new ShowDiagramAssistantRunnable();
> 	private HideDiagramAssistantRunnable hideDiagramAssistantRunnable = new HideDiagramAssistantRunnable();
> 
257,278c255,257
< 		if (view.getElement() != null) {
< 			Boolean retval;
< 			try {
< 				retval = (Boolean) ((IGraphicalEditPart) getHost())
< 					.getEditingDomain().runExclusive(
< 						new RunnableWithResult.Impl() {
< 
< 					public void run() {
< 						setResult(ViewUtil.resolveSemanticElement(view) != null ? Boolean.TRUE
< 							: Boolean.FALSE);
< 					}
< 				});
< 				return retval.booleanValue();
< 			} catch (InterruptedException e) {
< 				   Trace.catching(DiagramUIPlugin.getInstance(),
< 						DiagramUIDebugOptions.EXCEPTIONS_CATCHING, getClass(),
< 						"isHostResolvable", e); //$NON-NLS-1$
< 					Log.error(DiagramUIPlugin.getInstance(),
< 						DiagramUIStatusCodes.IGNORED_EXCEPTION_WARNING,
< 						"isHostResolvable", e); //$NON-NLS-1$
< 				   return false;
< 			}
---
>         EObject element = view.getElement();
> 		if (element != null) {
> 			return !element.eIsProxy();
314,317c293,294
< 		if (shouldShowDiagramAssistant()) {
< 			Display.getCurrent().timerExec(delay,
< 				new ShowDiagramAssistantRunnable(getMouseLocation()));
< 		}
---
> 		showDiagramAssistantRunnable.setOriginalMouseLocation(getMouseLocation());
> 		Display.getCurrent().timerExec(delay,showDiagramAssistantRunnable);
