15d14
< import org.eclipse.draw2d.Graphics;
19d17
< import org.eclipse.draw2d.geometry.Rectangle;
30a29,36
> import org.eclipse.gef.Request;
> 
> import org.eclipse.gef.commands.Command;
> 
> import org.eclipse.gef.editpolicies.LayoutEditPolicy;
> import org.eclipse.gef.editpolicies.NonResizableEditPolicy;
> 
> import org.eclipse.gef.requests.CreateRequest;
42d47
< import org.eclipse.gmf.graphdef.editor.edit.policies.GMFGraphTextSelectionEditPolicy;
51,54d55
< import org.eclipse.gmf.runtime.diagram.ui.editparts.GraphicalEditPart;
< import org.eclipse.gmf.runtime.diagram.ui.editparts.ITextAwareEditPart;
< 
< import org.eclipse.gmf.runtime.diagram.ui.editpolicies.ConstrainedToolbarLayoutEditPolicy;
451c452,459
< 		installEditPolicy(EditPolicy.LAYOUT_ROLE, new ConstrainedToolbarLayoutEditPolicy() {
---
> 		installEditPolicy(EditPolicy.LAYOUT_ROLE, createLayoutEditPolicy());
> 	}
> 
> 	/**
> 	 * @generated
> 	 */
> 	protected LayoutEditPolicy createLayoutEditPolicy() {
> 		return new LayoutEditPolicy() {
454,456c462,464
< 				if (child.getEditPolicy(EditPolicy.PRIMARY_DRAG_ROLE) == null) {
< 					if (child instanceof ITextAwareEditPart) {
< 						return new GMFGraphTextSelectionEditPolicy();
---
> 				EditPolicy result = child.getEditPolicy(EditPolicy.PRIMARY_DRAG_ROLE);
> 				if (result == null) {
> 					result = new NonResizableEditPolicy();
457a466
> 				return result;
459c468,470
< 				return super.createChildEditPolicy(child);
---
> 
> 			protected Command getMoveChildrenCommand(Request request) {
> 				return null;
462,463c473,474
< 			protected org.eclipse.draw2d.geometry.Point getLayoutOrigin() {
< 				return ((GraphicalEditPart) getHost()).getContentPane().getClientArea().getLocation();
---
> 			protected Command getCreateCommand(CreateRequest request) {
> 				return null;
465c476
< 		});
---
> 		};
569,570d579
< 		private Rectangle myBounds;
< 
585,630d593
< 		protected void outlineShape(Graphics g) {
< 			Rectangle bounds = getBounds();
< 			g.translate(bounds.x, bounds.y);
< 			super.outlineShape(g);
< 			g.translate(-bounds.x, -bounds.y);
< 		}
< 
< 		public Rectangle getBounds() {
< 			if (myBounds == null) {
< 				myBounds = new Rectangle(0, 0, 0, 0);
< 			}
< 			return myBounds;
< 		}
< 
< 		public void primTranslate(int dx, int dy) {
< 			getBounds().x += dx;
< 			getBounds().y += dy;
< 			if (useLocalCoordinates()) {
< 				fireCoordinateSystemChanged();
< 				return;
< 			}
< 		}
< 
< 		public void setBounds(Rectangle rect) {
< 			boolean resize = (rect.width != getBounds().width) || (rect.height != getBounds().height), translate = (rect.x != getBounds().x) || (rect.y != getBounds().y);
< 
< 			if ((resize || translate) && isVisible())
< 				erase();
< 			if (translate) {
< 				int dx = rect.x - getBounds().x;
< 				int dy = rect.y - getBounds().y;
< 				primTranslate(dx, dy);
< 			}
< 
< 			getBounds().width = rect.width;
< 			getBounds().height = rect.height;
< 
< 			if (translate || resize) {
< 				if (resize)
< 					invalidate();
< 				fireFigureMoved();
< 				repaint();
< 			}
< 
< 		}
< 
