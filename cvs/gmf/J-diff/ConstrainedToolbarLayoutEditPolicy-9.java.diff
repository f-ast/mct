20a21
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
41c42
< import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
138c139,140
< 		CompositeModelCommand cmc = new CompositeModelCommand(DiagramUIMessages.Command_AdjustRatioCommand_Label);
---
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
> 		CompositeTransactionalCommand cmc = new CompositeTransactionalCommand(editingDomain, DiagramUIMessages.Command_AdjustRatioCommand_Label);
143c145
< 				cmc.compose(new SetCompartmentRatioCommand(new EObjectAdapter((View)child.getModel()), NULL_CONSTRAINT));
---
> 				cmc.compose(new SetCompartmentRatioCommand(editingDomain, new EObjectAdapter((View)child.getModel()), NULL_CONSTRAINT));
146c148
< 		return cmc.isEmpty() ? null : new EtoolsProxyCommand(cmc.unwrap());
---
> 		return cmc.isEmpty() ? null : new EtoolsProxyCommand(cmc.reduce());
153c155,156
< 		CompositeModelCommand cmc = new CompositeModelCommand(DiagramUIMessages.Command_AdjustRatioCommand_Label);
---
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
>         CompositeTransactionalCommand cmc = new CompositeTransactionalCommand(editingDomain, DiagramUIMessages.Command_AdjustRatioCommand_Label);
182c185
< 				cmc.compose(new SetCompartmentRatioCommand(new EObjectAdapter((View)part.getModel()), r));
---
> 				cmc.compose(new SetCompartmentRatioCommand(editingDomain, new EObjectAdapter((View)part.getModel()), r));
