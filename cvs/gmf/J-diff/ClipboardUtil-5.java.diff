26c26
< 
---
> import org.eclipse.emf.ecore.resource.Resource;
176a177,214
> 		return pasteElementsFromStringDelagate(string, new PasteTarget(targetElement), hints, monitor);
> 	}
> 	
> 	/**
> 	 * Deerializes elements from a string (obtained from the system clipboard)
> 	 * and pastes them into the specified target element.
> 	 * 
> 	 * @param string the string containing the elements to be pasted
> 	 * @param targetElement the element into which the new elements are to be
> 	 *     pasted
> 	 * @param hints a mapping of hints (defined as constants on this class), or
> 	 *     <code>null</code> to provide no hints
> 	 * @param monitor a progress monitor to track progress, or
> 	 *     <code>null</code> if no progress feedback is required
> 	 * 
> 	 * @return the newly pasted {@link EObject}s
> 	 */
> 	public static Collection pasteElementsFromString(String string,
> 			Resource targetElement, final Map hints, IProgressMonitor monitor) {
> 		return pasteElementsFromStringDelagate(string, new PasteTarget(targetElement), hints, monitor);
> 	}
> 
> 	/**
> 	 * Deerializes elements from a string (obtained from the system clipboard)
> 	 * and pastes them into the specified target element.
> 	 * 
> 	 * @param string the string containing the elements to be pasted
> 	 * @param targetElement the element into which the new elements are to be
> 	 *     pasted
> 	 * @param hints a mapping of hints (defined as constants on this class), or
> 	 *     <code>null</code> to provide no hints
> 	 * @param monitor a progress monitor to track progress, or
> 	 *     <code>null</code> if no progress feedback is required
> 	 * 
> 	 * @return the newly pasted {@link EObject}s
> 	 */
> 	private static Collection pasteElementsFromStringDelagate(String string,
> 			PasteTarget targetElement, final Map hints, IProgressMonitor monitor) {
186c224,226
< 			IClipboardSupport helper = createClipboardSupport(targetElement.eClass());
---
> 			IClipboardSupport helper = targetElement.isResource()
> 				? DefaultClipboardSupport.getInstance()
> 				: createClipboardSupport(((EObject)targetElement.getObject()).eClass());
