111,114d110
< 			activityManagerListener = new ActivityManagerListener();
< 			PlatformUI.getWorkbench().getActivitySupport().getActivityManager()
< 				.addActivityManagerListener(activityManagerListener);
< 			
353a350,353
> 		if (getEditDomain() != null
> 			&& getEditDomain().getPaletteViewer() != null
> 			&& getEditDomain().getPaletteViewer().getPaletteRoot() != null) {
> 			
357a358
> 	}
548a550,556
> 	protected void startListening() {
> 		super.startListening();
> 		activityManagerListener = new ActivityManagerListener();
> 		PlatformUI.getWorkbench().getActivitySupport().getActivityManager()
> 			.addActivityManagerListener(activityManagerListener);
> 	}
> 
