39a40,43
> 	boolean isEnabled() {
> 		return !myIsDelegateDisabled;
> 	}
> 	
107,109c111,116
< 	protected EStructuralFeature getOriginalFeature(EStructuralFeature feature) {
< 		if (myNarrowedFeatureTypes == null) {
< 			myNarrowedFeatureTypes = new HashMap<EStructuralFeature, EStructuralFeature>();
---
> 	@Override
> 	public void addPrefix(String prefix, String uri) {
> 		super.addPrefix(prefix, uri);
> 		if (myDelegate.isOldVersionDetected(uri)) {
> 			enableDelegate(true);
> 		}
111c118,120
< 		return myNarrowedFeatureTypes.get(feature);
---
> 
> 	protected EStructuralFeature getOriginalFeature(EStructuralFeature feature) {
> 		return myNarrowedFeatureTypes == null ? null : myNarrowedFeatureTypes.get(feature);
