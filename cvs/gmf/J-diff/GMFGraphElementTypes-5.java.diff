2c2
<  * Copyright (c) 2006 Borland Software Corporation and others.
---
>  *  Copyright (c) 2006, 2007 Borland Software Corporation and others.
16a17
> 
18a20
> import org.eclipse.emf.ecore.EClassifier;
20a23,24
> import org.eclipse.gmf.gmfgraph.GMFGraphPackage;
> import org.eclipse.gmf.graphdef.editor.part.GMFGraphDiagramEditorPlugin;
26,28d29
< import org.eclipse.gmf.gmfgraph.GMFGraphPackage;
< 
< import org.eclipse.gmf.graphdef.editor.part.GMFGraphDiagramEditorPlugin;
33c34
< public class GMFGraphElementTypes {
---
> public class GMFGraphElementTypes extends ElementInitializers {
73c74,81
< 			element = ((EStructuralFeature) element).getEContainingClass();
---
> 			EStructuralFeature feature = ((EStructuralFeature) element);
> 			EClass eContainingClass = feature.getEContainingClass();
> 			EClassifier eType = feature.getEType();
> 			if (eContainingClass != null && !eContainingClass.isAbstract()) {
> 				element = eContainingClass;
> 			} else if (eType instanceof EClass && !((EClass) eType).isAbstract()) {
> 				element = eType;
> 			}
148a157
> 
149a159,167
> 
> 			elements.put(Compartment_2001, GMFGraphPackage.eINSTANCE.getCompartment());
> 
> 			elements.put(Node_2002, GMFGraphPackage.eINSTANCE.getNode());
> 
> 			elements.put(Connection_2003, GMFGraphPackage.eINSTANCE.getConnection());
> 
> 			elements.put(FigureGallery_2004, GMFGraphPackage.eINSTANCE.getFigureGallery());
> 
150a169
> 
151a171
> 
152a173
> 
153a175
> 
154a177
> 
155a179
> 
156a181
> 
158,161c183
< 			elements.put(Compartment_2001, GMFGraphPackage.eINSTANCE.getCompartment());
< 			elements.put(Node_2002, GMFGraphPackage.eINSTANCE.getNode());
< 			elements.put(Connection_2003, GMFGraphPackage.eINSTANCE.getConnection());
< 			elements.put(FigureGallery_2004, GMFGraphPackage.eINSTANCE.getFigureGallery());
---
> 
175c197
< 	public static final IElementType Rectangle_3001 = getElementType("org.eclipse.gmf.graphdef.editor.Rectangle_3001"); //$NON-NLS-1$
---
> 	public static final IElementType Compartment_2001 = getElementType("org.eclipse.gmf.graphdef.editor.Compartment_2001"); //$NON-NLS-1$
180c202
< 	public static final IElementType Rectangle_3002 = getElementType("org.eclipse.gmf.graphdef.editor.Rectangle_3002"); //$NON-NLS-1$
---
> 	public static final IElementType Node_2002 = getElementType("org.eclipse.gmf.graphdef.editor.Node_2002"); //$NON-NLS-1$
185c207
< 	public static final IElementType Ellipse_3003 = getElementType("org.eclipse.gmf.graphdef.editor.Ellipse_3003"); //$NON-NLS-1$
---
> 	public static final IElementType Connection_2003 = getElementType("org.eclipse.gmf.graphdef.editor.Connection_2003"); //$NON-NLS-1$
190c212
< 	public static final IElementType RoundedRectangle_3004 = getElementType("org.eclipse.gmf.graphdef.editor.RoundedRectangle_3004"); //$NON-NLS-1$
---
> 	public static final IElementType FigureGallery_2004 = getElementType("org.eclipse.gmf.graphdef.editor.FigureGallery_2004"); //$NON-NLS-1$
195c217
< 	public static final IElementType Polyline_3005 = getElementType("org.eclipse.gmf.graphdef.editor.Polyline_3005"); //$NON-NLS-1$
---
> 	public static final IElementType Rectangle_3001 = getElementType("org.eclipse.gmf.graphdef.editor.Rectangle_3001"); //$NON-NLS-1$
200c222
< 	public static final IElementType Ellipse_3006 = getElementType("org.eclipse.gmf.graphdef.editor.Ellipse_3006"); //$NON-NLS-1$
---
> 	public static final IElementType Rectangle_3002 = getElementType("org.eclipse.gmf.graphdef.editor.Rectangle_3002"); //$NON-NLS-1$
205c227
< 	public static final IElementType RoundedRectangle_3007 = getElementType("org.eclipse.gmf.graphdef.editor.RoundedRectangle_3007"); //$NON-NLS-1$
---
> 	public static final IElementType Ellipse_3003 = getElementType("org.eclipse.gmf.graphdef.editor.Ellipse_3003"); //$NON-NLS-1$
210c232
< 	public static final IElementType Polyline_3008 = getElementType("org.eclipse.gmf.graphdef.editor.Polyline_3008"); //$NON-NLS-1$
---
> 	public static final IElementType RoundedRectangle_3004 = getElementType("org.eclipse.gmf.graphdef.editor.RoundedRectangle_3004"); //$NON-NLS-1$
215c237
< 	public static final IElementType Compartment_2001 = getElementType("org.eclipse.gmf.graphdef.editor.Compartment_2001"); //$NON-NLS-1$
---
> 	public static final IElementType Polyline_3005 = getElementType("org.eclipse.gmf.graphdef.editor.Polyline_3005"); //$NON-NLS-1$
220c242
< 	public static final IElementType Node_2002 = getElementType("org.eclipse.gmf.graphdef.editor.Node_2002"); //$NON-NLS-1$
---
> 	public static final IElementType Ellipse_3006 = getElementType("org.eclipse.gmf.graphdef.editor.Ellipse_3006"); //$NON-NLS-1$
225c247
< 	public static final IElementType Connection_2003 = getElementType("org.eclipse.gmf.graphdef.editor.Connection_2003"); //$NON-NLS-1$
---
> 	public static final IElementType RoundedRectangle_3007 = getElementType("org.eclipse.gmf.graphdef.editor.RoundedRectangle_3007"); //$NON-NLS-1$
230c252
< 	public static final IElementType FigureGallery_2004 = getElementType("org.eclipse.gmf.graphdef.editor.FigureGallery_2004"); //$NON-NLS-1$
---
> 	public static final IElementType Polyline_3008 = getElementType("org.eclipse.gmf.graphdef.editor.Polyline_3008"); //$NON-NLS-1$
255a278,281
> 			KNOWN_ELEMENT_TYPES.add(Compartment_2001);
> 			KNOWN_ELEMENT_TYPES.add(Node_2002);
> 			KNOWN_ELEMENT_TYPES.add(Connection_2003);
> 			KNOWN_ELEMENT_TYPES.add(FigureGallery_2004);
264,267d289
< 			KNOWN_ELEMENT_TYPES.add(Compartment_2001);
< 			KNOWN_ELEMENT_TYPES.add(Node_2002);
< 			KNOWN_ELEMENT_TYPES.add(Connection_2003);
< 			KNOWN_ELEMENT_TYPES.add(FigureGallery_2004);
