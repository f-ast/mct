19d18
< import java.util.ArrayList;
40d38
< import org.eclipse.gmf.gmfgraph.GMFGraphPackage;
144,155c142
< 		ArrayList rv = new ArrayList();
< 		for(TreeIterator it = resource.getAllContents(); it.hasNext();) {
< 			EObject next = (EObject) it.next();
< 			// FigureGallery could be either top element or as a child of canvas
< 			if (next.eClass().getClassifierID() == GMFGraphPackage.FIGURE_GALLERY) {
< 				rv.add(next);
< 				it.prune();
< 			} else if (next.eClass().getClassifierID() != GMFGraphPackage.CANVAS) {
< 				it.prune();
< 			}
< 		}
< 		return (FigureGallery[]) rv.toArray(new FigureGallery[rv.size()]);
---
> 		return new FigureFinder().findFigures(resource);
