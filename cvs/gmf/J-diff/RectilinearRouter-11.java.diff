64a65
>         IFigure sourceFigure = conn.getSourceAnchor().getOwner();
66c67
< 		if (conn.getSourceAnchor().getOwner() == null)
---
> 		if (sourceFigure == null)
69,72c70
< 		Rectangle startRect =
< 			new Rectangle(conn.getSourceAnchor().getOwner().getBounds());
< 		conn.getSourceAnchor().getOwner().translateToAbsolute(startRect);
< 		conn.translateToRelative(startRect);
---
> 		PointList startPolygon = getFigurePolygon(sourceFigure,conn);
75,76c73,74
< 			boolean in1 = startRect.contains(newPoints.getPoint(i));
< 			boolean in2 = startRect.contains(newPoints.getPoint(i + 1));
---
>             boolean in1 = PointListUtilities.containsPoint(startPolygon, newPoints.getPoint(i));
>  			boolean in2 = PointListUtilities.containsPoint(startPolygon, newPoints.getPoint(i+1));
98,99c96,97
< 
< 		if (conn.getTargetAnchor().getOwner() == null)
---
> 		IFigure targetFigure = conn.getTargetAnchor().getOwner();
> 		if (targetFigure == null)
102,106c100
< 		Rectangle endRect =
< 			new Rectangle(conn.getTargetAnchor().getOwner().getBounds());
< 		conn.getTargetAnchor().getOwner().translateToAbsolute(endRect);
< 		conn.translateToRelative(endRect);
< 
---
>         PointList endPolygon = getFigurePolygon(targetFigure,conn);
108,109c102,103
< 			boolean in1 = endRect.contains(newPoints.getPoint(i));
< 			boolean in2 = endRect.contains(newPoints.getPoint(i - 1));
---
> 		    boolean in1 = PointListUtilities.containsPoint(endPolygon,newPoints.getPoint(i));
> 			boolean in2 = PointListUtilities.containsPoint(endPolygon,newPoints.getPoint(i - 1));
674a669
>    
