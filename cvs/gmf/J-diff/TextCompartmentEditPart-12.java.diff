23a24
> import org.eclipse.emf.transaction.RunnableWithResult;
28a30,31
> import org.eclipse.gmf.runtime.common.core.util.Log;
> import org.eclipse.gmf.runtime.common.core.util.Trace;
35d37
< import org.eclipse.gmf.runtime.diagram.core.internal.util.MEditingDomainGetter;
38a41,43
> import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIDebugOptions;
> import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIPlugin;
> import org.eclipse.gmf.runtime.diagram.ui.internal.DiagramUIStatusCodes;
43d47
< import org.eclipse.gmf.runtime.emf.core.edit.MRunnable;
197d200
< 					final IParserEditStatus isValid[] = { null };
199,202c202,207
< 					MEditingDomainGetter.getMEditingDomain((View)getModel()).runAsRead(new MRunnable() {
< 							public Object run() {
< 								isValid[0] =
< 								    theParser.isValidEditString(
---
> 					try {
> 						IParserEditStatus isValid = (IParserEditStatus) getEditingDomain()
> 							.runExclusive(new RunnableWithResult.Impl() {
> 
> 									public void run() {
> 										setResult(theParser.isValidEditString(
204,205c209
< 										(String) value);
< 								return null;
---
> 											(String) value));
207a212,221
> 						return isValid.getCode() == ParserEditStatus.EDITABLE ? null
> 							: isValid.getMessage();
> 					} catch (InterruptedException e) {
> 						Trace.catching(DiagramUIPlugin.getInstance(),
> 							DiagramUIDebugOptions.EXCEPTIONS_CATCHING,
> 							getClass(), "getEditTextValidator", e); //$NON-NLS-1$
> 						Log.error(DiagramUIPlugin.getInstance(),
> 							DiagramUIStatusCodes.IGNORED_EXCEPTION_WARNING,
> 							"getEditTextValidator", e); //$NON-NLS-1$
> 					}
209d222
< 					return isValid[0].getCode() == ParserEditStatus.EDITABLE ? null : isValid[0].getMessage();
344,345c357,359
< 		MEditingDomainGetter.getMEditingDomain((View)getModel()).runAsRead(new MRunnable() {
< 				public Object run() {
---
> 		try {
> 			getEditingDomain().runExclusive(new Runnable() {
> 				public void run() {
360,361d373
< 					
< 					return null;
363a376,384
> 		} catch (InterruptedException e) {
> 			Trace.catching(DiagramUIPlugin.getInstance(),
> 				DiagramUIDebugOptions.EXCEPTIONS_CATCHING, getClass(),
> 				"performDirectEditRequest", e); //$NON-NLS-1$
> 			Log.error(DiagramUIPlugin.getInstance(),
> 				DiagramUIStatusCodes.IGNORED_EXCEPTION_WARNING,
> 				"performDirectEditRequest", e); //$NON-NLS-1$
> 		}
> 
