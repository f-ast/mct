23a24
> import org.eclipse.draw2d.Bendpoint;
33a35
> import org.eclipse.draw2d.geometry.PointList;
115d116
< 
141a143
>                 
144,147c146,162
< 				//
< 				// get the connection locations
< 				Point sLoc = sc.getLocation(tc.getReferencePoint());
< 				Point tLoc = tc.getLocation(sc.getReferencePoint());
---
>                 Point sRefPoint;
>                 Point tRefPoint;
>                 List bendpoints = (List) connection.getConnectionRouter()
>                     .getConstraint(connection);
>                 if (bendpoints.size() >= 2) {
>                     sRefPoint = ((Bendpoint) bendpoints.get(0)).getLocation()
>                         .getCopy();
>                     connection.translateToAbsolute(sRefPoint);
>                     tRefPoint = ((Bendpoint) bendpoints
>                         .get(bendpoints.size() - 1)).getLocation().getCopy();
>                     connection.translateToAbsolute(tRefPoint);
>                 } else {
>                     sRefPoint = tc.getReferencePoint();
>                     tRefPoint = sc.getReferencePoint();
>                 }
>                 Point sLoc = sc.getLocation(sRefPoint);
>                 Point tLoc = tc.getLocation(tRefPoint);
304c319,322
< 		 * items to be drawn to items within the interior of the compartment.
---
>          * items around the container of the compartment to be drawn to items
>          * within the interior of the compartment. This method should not return
>          * true for all border items, only for those may be outside of the area
>          * within the shape compartment.
308,309c326,327
< 		 * @return false by default. Override to allow connections to border
< 		 *         items.
---
>          * @return true if the itemEditPart is a border item around or outside
>          *         the shape compartment editpart passed in; false otherwise.
