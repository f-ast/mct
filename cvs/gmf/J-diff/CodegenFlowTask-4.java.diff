21a22
> import org.apache.tools.ant.UnknownElement;
26d26
< 	private final LinkedList<InvokeTemplateTask> myTemplateInvocations = new LinkedList<InvokeTemplateTask>();
33,35d32
< 		if (task instanceof InvokeTemplateTask) {
< 			myTemplateInvocations.add((InvokeTemplateTask) task);
< 		}
58,59c55,67
< 		for (InvokeTemplateTask t : myTemplateInvocations) {
< 			t.setFacade(xf);
---
> 		for (Task t : myTasks) {
> 			if (t instanceof UnknownElement) {
> 				UnknownElement ue = (UnknownElement) t;
> 				if ("eclipse.org/gmf/2008/xpand".equals(ue.getNamespace()) && "template".equals(ue.getTag())) {
> 					t.maybeConfigure();
> 					if (((UnknownElement) t).getTask() != null) {
> 						t = ((UnknownElement) t).getTask();
> 					}
> 				}
> 			}
> 			if (t instanceof InvokeTemplateTask) {
> 				((InvokeTemplateTask) t).setFacade(xf);
> 			}
66d73
< 				ps.worked(1);
