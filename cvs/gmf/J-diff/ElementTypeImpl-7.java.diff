10a11
> import org.eclipse.emf.codegen.ecore.genmodel.GenClass;
24a26,28
> import org.eclipse.gmf.codegen.gmfgen.GenLink;
> import org.eclipse.gmf.codegen.gmfgen.GenNode;
> import org.eclipse.gmf.codegen.gmfgen.LinkModelFacet;
26a31
> import org.eclipse.gmf.codegen.gmfgen.TypeLinkModelFacet;
206,209c211,221
< 		// Let element type label be the name of the corresponding creation tool.
< 		final Palette palette = getDiagramElement().getDiagram().getPalette();
< 		if (palette == null) {
< 			return null;
---
> 		if (getDiagramElement() instanceof GenNode) {
> 			GenClass type = ((GenNode) getDiagramElement()).getDomainMetaClass();
> 			if (type != null) {
> 				return type.getName();
> 			}
> 		} else if (getDiagramElement() instanceof GenLink) {
> 			LinkModelFacet mf = ((GenLink) getDiagramElement()).getModelFacet();
> 			if (mf instanceof TypeLinkModelFacet) {
> 				GenClass type = ((TypeLinkModelFacet) mf).getMetaClass();
> 				if (type != null) {
> 					return type.getName();
211,216d222
< 		for (Iterator elements = palette.eAllContents(); elements.hasNext(); ) {
< 			Object next = elements.next();
< 			if (next instanceof ToolEntry) {
< 				ToolEntry toolEntry = (ToolEntry) next;
< 				if (toolEntry.getElements().contains(getDiagramElement())) {
< 					return toolEntry.getTitle();
219,220c225,226
< 		}
< 		return null;
---
> 		return "Undefined";
> 		// for more details see https://bugs.eclipse.org/bugs/show_bug.cgi?id=157512
