18d17
< 
21c20,21
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
---
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
97,98c97,98
< 		insetsNew.bottom = MapMode.DPtoLP(insetsNew.bottom + getShadowHeight());
< 		insetsNew.right = MapMode.DPtoLP(insetsNew.right + getShadowWidth());
---
> 		insetsNew.bottom = MapModeUtil.getMapMode(figure).DPtoLP(insetsNew.bottom + getShadowHeight());
> 		insetsNew.right = MapModeUtil.getMapMode(figure).DPtoLP(insetsNew.right + getShadowWidth());
134,135c134,135
< 		insetsNew.bottom = MapMode.DPtoLP(getShadowHeight());
< 		insetsNew.right = MapMode.DPtoLP(getShadowWidth());
---
> 		insetsNew.bottom = MapModeUtil.getMapMode(figure).DPtoLP(getShadowHeight());
> 		insetsNew.right = MapModeUtil.getMapMode(figure).DPtoLP(getShadowWidth());
176a177,178
> 		IMapMode mm = MapModeUtil.getMapMode(figure);
> 		
181,182c183,184
< 			tempRect.width -= MapMode.DPtoLP(getShadowWidth());
< 			tempRect.height -= MapMode.DPtoLP(getShadowHeight());
---
> 			tempRect.width -= mm.DPtoLP(getShadowWidth());
> 			tempRect.height -= mm.DPtoLP(getShadowHeight());
184,185c186,187
< 				tempRect.width -= MapMode.DPtoLP(1);
< 				tempRect.height -= MapMode.DPtoLP(1);
---
> 				tempRect.width -= mm.DPtoLP(1);
> 				tempRect.height -= mm.DPtoLP(1);
187c189
< 			tempRect.shrink(MapMode.DPtoLP(getWidth() / 2), MapMode.DPtoLP(getWidth() / 2));
---
> 			tempRect.shrink(mm.DPtoLP(getWidth() / 2), mm.DPtoLP(getWidth() / 2));
