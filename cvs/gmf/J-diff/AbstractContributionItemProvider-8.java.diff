25d24
< import org.eclipse.gmf.runtime.common.ui.action.IDisposableAction;
26a26
> import org.eclipse.gmf.runtime.common.ui.action.IDisposableAction;
37a38
> import org.eclipse.jface.action.AbstractGroupMarker;
301,302c302,306
< 	/* (non-Javadoc)
< 	 * @see org.eclipse.gmf.runtime.common.ui.services.action.internal.contributionitem.IContributionItemProvider#updateActionBars(org.eclipse.ui.IActionBars, org.eclipse.gmf.runtime.common.ui.util.IWorkbenchPartDescriptor)
---
>     /*
>      * (non-Javadoc)
>      * 
>      * @see org.eclipse.gmf.runtime.common.ui.services.action.internal.contributionitem.IContributionItemProvider#updateActionBars(org.eclipse.ui.IActionBars,
>      *      org.eclipse.gmf.runtime.common.ui.util.IWorkbenchPartDescriptor)
400a405,406
>             } else if (c instanceof ProviderContributionDescriptor.PopupPredefinedItemDescriptor) {
>                 ProviderContributionDescriptor.PopupPredefinedItemDescriptor item = (ProviderContributionDescriptor.PopupPredefinedItemDescriptor) c;
401a408,410
>                 if (item.isToBeRemoved()) {
>                     removeExistingItem(item.getId(), item.getPath(), popupMenu);
>                 }
737a747,797
>      * @param id
>      * @param path
>      * @param contributionManager
>      */
>     private void removeExistingItem(String id, String path,
>             IContributionManager contributionManager) {
> 
>         // Find the menu or action or group.
>         if (id == null)
>             return;
>         
>         IContributionManager parent = contributionManager;
>         if (path.length() > 1) { // if path is more than '/'
>             parent = findMenuUsingPath(contributionManager, path.substring(1));
>             if (parent == null) {
>                 Log.info(CommonUIServicesActionPlugin.getDefault(), CommonUIServicesActionStatusCodes.SERVICE_FAILURE, "The contribution item path is invalid"); //$NON-NLS-1$
>                 return;
>             }
>         }
> 
>         IContributionItem predefinedItem = parent.find(id);
>         if (predefinedItem == null) {
>             Log.info(CommonUIServicesActionPlugin.getDefault(),
>                 CommonUIServicesActionStatusCodes.SERVICE_FAILURE,
>                 "The contribution item path is invalid"); //$NON-NLS-1$
>             return;
>         }
> 
>          if (predefinedItem instanceof AbstractGroupMarker) {
>             IContributionItem allItems[] = parent.getItems();
>             int groupIndex;
>             for (groupIndex = 0; groupIndex < allItems.length; groupIndex++) {
>                 IContributionItem item = allItems[groupIndex];
>                 if (item.equals(predefinedItem)) {
>                     break;
>                 }
>             }
>             for (int j = groupIndex + 1; j < allItems.length; j++) {
>                 IContributionItem item = allItems[j];
>                 if (item instanceof AbstractGroupMarker) {
>                     break;
>                 }
>                 parent.remove(item);
>             }
> 
>         }
>         parent.remove(predefinedItem);
> 
>     }
>     
> 	/**
