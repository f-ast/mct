18a19,21
> import org.eclipse.emf.edit.domain.EditingDomain;
> import org.eclipse.emf.edit.domain.IEditingDomainProvider;
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
35d37
< import org.eclipse.gmf.runtime.diagram.ui.internal.util.DiagramMEditingDomainGetter;
37d38
< import org.eclipse.gmf.runtime.emf.core.edit.MRunnable;
217,218c218,226
< 			DiagramMEditingDomainGetter.getMEditingDomain(editor).runAsRead( new MRunnable() {
< 		        public Object run() {
---
> 			IEditingDomainProvider provider = (IEditingDomainProvider) editor
> 				.getAdapter(IEditingDomainProvider.class);
> 			if (provider != null) {
> 				EditingDomain domain = provider.getEditingDomain();
> 				if (domain instanceof TransactionalEditingDomain) {
> 					((TransactionalEditingDomain) domain)
> 						.runExclusive(new Runnable() {
> 
> 							public void run() {
220d227
< 		            return null;
222a230,231
> 				}
> 			}
