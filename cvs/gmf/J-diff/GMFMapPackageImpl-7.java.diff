15a16
> import org.eclipse.gmf.mappings.AbstractNodeMapping;
42a44,50
> 	private EClass abstractNodeMappingEClass = null;
> 
> 	/**
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */
191,201c199,200
< 	public EClass getMappingEntry() {
< 		return mappingEntryEClass;
< 	}
< 
< 	/**
< 	 * <!-- begin-user-doc -->
< 	 * <!-- end-user-doc -->
< 	 * @generated
< 	 */
< 	public EClass getNodeMapping() {
< 		return nodeMappingEClass;
---
> 	public EClass getAbstractNodeMapping() {
> 		return abstractNodeMappingEClass;
209,210c208,209
< 	public EReference getNodeMapping_DiagramNode() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(0);
---
> 	public EReference getAbstractNodeMapping_DiagramNode() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(0);
218,219c217,218
< 	public EReference getNodeMapping_DomainMetaElement() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(1);
---
> 	public EReference getAbstractNodeMapping_DomainMetaElement() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(1);
227,228c226,227
< 	public EReference getNodeMapping_DomainSpecialization() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(2);
---
> 	public EReference getAbstractNodeMapping_DomainSpecialization() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(2);
236,237c235,236
< 	public EReference getNodeMapping_DomainInitializer() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(3);
---
> 	public EReference getAbstractNodeMapping_DomainInitializer() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(3);
245,246c244,245
< 	public EReference getNodeMapping_ContainmentFeature() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(4);
---
> 	public EReference getAbstractNodeMapping_ContainmentFeature() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(4);
254,255c253,254
< 	public EReference getNodeMapping_EditFeature() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(5);
---
> 	public EReference getAbstractNodeMapping_EditFeature() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(5);
263,291c262,263
< 	public EReference getNodeMapping_ChildMappings() {
< 		return (EReference)nodeMappingEClass.getEStructuralFeatures().get(6);
< 	}
< 
< 	/**
< 	 * <!-- begin-user-doc -->
< 	 * <!-- end-user-doc -->
< 	 * @generated
< 	 */
< 	public EClass getChildNodeMapping() {
< 		return childNodeMappingEClass;
< 	}
< 
< 	/**
< 	 * <!-- begin-user-doc -->
< 	 * <!-- end-user-doc -->
< 	 * @generated
< 	 */
< 	public EReference getChildNodeMapping_Compartment() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(0);
< 	}
< 
< 	/**
< 	 * <!-- begin-user-doc -->
< 	 * <!-- end-user-doc -->
< 	 * @generated
< 	 */
< 	public EReference getChildNodeMapping_DiagramNode() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(1);
---
> 	public EReference getAbstractNodeMapping_ChildMappings() {
> 		return (EReference)abstractNodeMappingEClass.getEStructuralFeatures().get(6);
299,309c271,272
< 	public EReference getChildNodeMapping_DomainChildrenFeature() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(2);
< 	}
< 
< 	/**
< 	 * <!-- begin-user-doc -->
< 	 * <!-- end-user-doc -->
< 	 * @generated
< 	 */
< 	public EReference getChildNodeMapping_EditFeature() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(3);
---
> 	public EClass getMappingEntry() {
> 		return mappingEntryEClass;
317,318c280,281
< 	public EReference getChildNodeMapping_DomainMetaElement() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(4);
---
> 	public EClass getNodeMapping() {
> 		return nodeMappingEClass;
326,327c289,290
< 	public EReference getChildNodeMapping_DomainSpecialization() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(5);
---
> 	public EClass getChildNodeMapping() {
> 		return childNodeMappingEClass;
335,336c298,299
< 	public EReference getChildNodeMapping_DomainInitializer() {
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(6);
---
> 	public EReference getChildNodeMapping_Compartment() {
> 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(0);
345c308
< 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(7);
---
> 		return (EReference)childNodeMappingEClass.getEStructuralFeatures().get(1);
609a573,581
> 		abstractNodeMappingEClass = createEClass(ABSTRACT_NODE_MAPPING);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__DIAGRAM_NODE);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__DOMAIN_META_ELEMENT);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__DOMAIN_SPECIALIZATION);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__DOMAIN_INITIALIZER);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__CONTAINMENT_FEATURE);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__EDIT_FEATURE);
> 		createEReference(abstractNodeMappingEClass, ABSTRACT_NODE_MAPPING__CHILD_MAPPINGS);
> 
613,619d584
< 		createEReference(nodeMappingEClass, NODE_MAPPING__DIAGRAM_NODE);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__DOMAIN_META_ELEMENT);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__DOMAIN_SPECIALIZATION);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__DOMAIN_INITIALIZER);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__CONTAINMENT_FEATURE);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__EDIT_FEATURE);
< 		createEReference(nodeMappingEClass, NODE_MAPPING__CHILD_MAPPINGS);
623,628d587
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__DIAGRAM_NODE);
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__DOMAIN_CHILDREN_FEATURE);
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__EDIT_FEATURE);
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__DOMAIN_META_ELEMENT);
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__DOMAIN_SPECIALIZATION);
< 		createEReference(childNodeMappingEClass, CHILD_NODE_MAPPING__DOMAIN_INITIALIZER);
693a653,654
> 		nodeMappingEClass.getESuperTypes().add(this.getAbstractNodeMapping());
> 		childNodeMappingEClass.getESuperTypes().add(this.getAbstractNodeMapping());
700a662,670
> 		initEClass(abstractNodeMappingEClass, AbstractNodeMapping.class, "AbstractNodeMapping", IS_ABSTRACT, !IS_INTERFACE, IS_GENERATED_INSTANCE_CLASS);
> 		initEReference(getAbstractNodeMapping_DiagramNode(), theDiagramDefinitionPackage.getNode(), null, "diagramNode", null, 1, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_DomainMetaElement(), ecorePackage.getEClass(), null, "domainMetaElement", null, 1, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_DomainSpecialization(), this.getConstraint(), null, "domainSpecialization", null, 0, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_DomainInitializer(), this.getElementInitializer(), null, "domainInitializer", null, 0, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_ContainmentFeature(), ecorePackage.getEReference(), null, "containmentFeature", null, 0, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_EditFeature(), ecorePackage.getEAttribute(), null, "editFeature", null, 0, 1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 		initEReference(getAbstractNodeMapping_ChildMappings(), this.getChildNodeMapping(), this.getChildNodeMapping_ParentNode(), "childMappings", null, 0, -1, AbstractNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
> 
704,710d673
< 		initEReference(getNodeMapping_DiagramNode(), theDiagramDefinitionPackage.getNode(), null, "diagramNode", null, 1, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_DomainMetaElement(), ecorePackage.getEClass(), null, "domainMetaElement", null, 1, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_DomainSpecialization(), this.getConstraint(), null, "domainSpecialization", null, 0, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_DomainInitializer(), this.getElementInitializer(), null, "domainInitializer", null, 0, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_ContainmentFeature(), ecorePackage.getEReference(), null, "containmentFeature", null, 0, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_EditFeature(), ecorePackage.getEAttribute(), null, "editFeature", null, 0, 1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getNodeMapping_ChildMappings(), this.getChildNodeMapping(), this.getChildNodeMapping_ParentNode(), "childMappings", null, 0, -1, NodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
714,720c677
< 		initEReference(getChildNodeMapping_DiagramNode(), theDiagramDefinitionPackage.getNode(), null, "diagramNode", null, 1, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_DomainChildrenFeature(), ecorePackage.getEStructuralFeature(), null, "domainChildrenFeature", null, 1, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_EditFeature(), ecorePackage.getEAttribute(), null, "editFeature", null, 0, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_DomainMetaElement(), ecorePackage.getEClass(), null, "domainMetaElement", null, 0, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, !IS_COMPOSITE, IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_DomainSpecialization(), this.getConstraint(), null, "domainSpecialization", null, 0, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_DomainInitializer(), this.getElementInitializer(), null, "domainInitializer", null, 0, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, IS_CHANGEABLE, IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
< 		initEReference(getChildNodeMapping_ParentNode(), this.getNodeMapping(), this.getNodeMapping_ChildMappings(), "parentNode", null, 1, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, !IS_CHANGEABLE, !IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
---
> 		initEReference(getChildNodeMapping_ParentNode(), this.getAbstractNodeMapping(), this.getAbstractNodeMapping_ChildMappings(), "parentNode", null, 1, 1, ChildNodeMapping.class, !IS_TRANSIENT, !IS_VOLATILE, !IS_CHANGEABLE, !IS_COMPOSITE, !IS_RESOLVE_PROXIES, !IS_UNSETTABLE, IS_UNIQUE, !IS_DERIVED, IS_ORDERED);
777c734
< 		  (mappingEntryEClass, 
---
> 		  (abstractNodeMappingEClass, 
794,801c751
< 		  (getNodeMapping_DomainSpecialization(), 
< 		   source, 
< 		   new String[] {
< 			 "def", "context",
< 			 "ocl", "domainMetaElement"
< 		   });				
< 		addAnnotation
< 		  (getNodeMapping_DomainInitializer(), 
---
> 		  (getAbstractNodeMapping_DomainSpecialization(), 
805c755
< 			 "ocl", "domainMetaElement"
---
> 			 "ocl", "if domainMetaElement.oclIsUndefined() then containmentFeature.eContainingClass else domainMetaElement endif"
808c758
< 		  (getChildNodeMapping_DomainSpecialization(), 
---
> 		  (getAbstractNodeMapping_DomainInitializer(), 
812,819c762
< 			 "ocl", "if domainMetaElement.oclIsUndefined() then domainChildrenFeature.eContainingClass else domainMetaElement endif "
< 		   });				
< 		addAnnotation
< 		  (getChildNodeMapping_DomainInitializer(), 
< 		   source, 
< 		   new String[] {
< 			 "def", "context",
< 			 "ocl", "if domainMetaElement.oclIsUndefined() then domainChildrenFeature.eContainingClass else domainMetaElement endif "
---
> 			 "ocl", "if domainMetaElement.oclIsUndefined() then containmentFeature.eContainingClass else domainMetaElement endif"
882c825
< 		  (getNodeMapping_DomainInitializer(), 
---
> 		  (getAbstractNodeMapping_DomainInitializer(), 
888c831
< 		  (getNodeMapping_ContainmentFeature(), 
---
> 		  (getAbstractNodeMapping_ContainmentFeature(), 
891c834
< 			 "ocl", "containmentFeature.oclIsUndefined() or containmentFeature.eReferenceType.isSuperTypeOf(domainMetaElement) "
---
> 			 "ocl", "containmentFeature.containment"
894c837
< 		  (getNodeMapping_EditFeature(), 
---
> 		  (getAbstractNodeMapping_ContainmentFeature(), 
897c840
< 			 "ocl", "editFeature.oclIsUndefined() or domainMetaElement.eAllAttributes->includes(editFeature)"
---
> 			 "ocl", "domainMetaElement.oclIsUndefined() or containmentFeature.eReferenceType.isSuperTypeOf(domainMetaElement)"
900c843
< 		  (getChildNodeMapping_Compartment(), 
---
> 		  (getAbstractNodeMapping_EditFeature(), 
903c846
< 			 "ocl", "parentNode.diagramNode.oclAsType(diadef::Node).compartments->includes(self.compartment)"
---
> 			 "ocl", "editFeature.oclIsUndefined() or (not domainMetaElement.oclIsUndefined() and editFeature.eContainingClass.isSuperTypeOf(domainMetaElement)) or containmentFeature.eType.oclAsType(ecore::EClass).eAllAttributes->includes(editFeature)"
906,918c849
< 		  (getChildNodeMapping_DomainChildrenFeature(), 
< 		   source, 
< 		   new String[] {
< 			 "ocl", "domainChildrenFeature.eContainingClass.isSuperTypeOf(parentNode.domainMetaElement)"
< 		   });		
< 		addAnnotation
< 		  (getChildNodeMapping_EditFeature(), 
< 		   source, 
< 		   new String[] {
< 			 "ocl", "editFeature.oclIsUndefined() or (not domainMetaElement.oclIsUndefined()  and editFeature.eContainingClass.isSuperTypeOf(domainMetaElement)) or domainChildrenFeature.eType.oclAsType(ecore::EClass).eAllAttributes->includes(editFeature)"
< 		   });					
< 		addAnnotation
< 		  (getChildNodeMapping_DomainInitializer(), 
---
> 		  (getChildNodeMapping_Compartment(), 
921c852
< 			 "ocl", "let i : FeatureSeqInitializer = domainInitializer.oclAsType( FeatureSeqInitializer) in i.oclIsUndefined() or i.initializers.feature.eContainingClass->forAll(c|c.isSuperTypeOf(domainMetaElement)) "
---
> 			 "ocl", "parentNode.diagramNode.oclAsType(diadef::Node).compartments->includes(self.compartment)"
