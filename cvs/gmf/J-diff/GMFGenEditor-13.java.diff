20a21,23
> import java.util.Map;
> import java.util.LinkedHashMap;
> 
38a42,44
> import org.eclipse.emf.common.util.BasicDiagnostic;
> import org.eclipse.emf.common.util.Diagnostic;
> 
39a46,47
> import org.eclipse.emf.common.notify.Notification;
> 
40a49
> import org.eclipse.emf.common.ui.editor.ProblemEditorPart;
47a57,59
> import org.eclipse.emf.ecore.util.EcoreUtil;
> import org.eclipse.emf.ecore.util.EContentAdapter;
> 
63a76,78
> import org.eclipse.emf.common.ui.MarkerHelper;
> import org.eclipse.emf.edit.ui.util.EditUIMarkerHelper;
> 
108a124,125
> import org.eclipse.ui.PartInitException;
> 
270a288,296
> 	 * The MarkerHelper is responsible for creating workspace resource markers presented
> 	 * in Eclipse's Problems View.
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */
> 	protected MarkerHelper markerHelper = new EditUIMarkerHelper();
> 
> 	/**
310c336
< 	Collection removedResources = new ArrayList();
---
> 	protected Collection removedResources = new ArrayList();
316c342
< 	Collection changedResources = new ArrayList();
---
> 	protected Collection changedResources = new ArrayList();
322c348,396
< 	Collection savedResources = new ArrayList();
---
> 	protected Collection savedResources = new ArrayList();
> 
> 	/**
> 	 * Map to store the diagnostic associated with a resource.
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */
> 	protected Map resourceToDiagnosticMap = new LinkedHashMap();
> 	
> 	/**
> 	 * Controls whether the problem indication should be updated.
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */	
> 	protected boolean updateProblemIndication = true;
> 
> 	/**
> 	 * Adapter used to update the problem indication when resources are demanded loaded.
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */	
> 	protected EContentAdapter problemIndicationAdapter = 
> 		new EContentAdapter() {
> 			public void notifyChanged(Notification notification) {
> 				if (notification.getNotifier() instanceof Resource) {
> 					switch (notification.getFeatureID(Resource.class)) {
> 						case Resource.RESOURCE__IS_LOADED:
> 						case Resource.RESOURCE__ERRORS:
> 						case Resource.RESOURCE__WARNINGS: {
> 							Resource resource = (Resource)notification.getNotifier();
> 							Diagnostic diagnostic = analyzeResourceProblems((Resource)notification.getNotifier(), null);
> 							if (diagnostic.getSeverity() != Diagnostic.OK) {
> 								resourceToDiagnosticMap.put(resource, diagnostic);
> 							}
> 							else {
> 								resourceToDiagnosticMap.remove(resource);
> 							}
> 							updateProblemIndication();
> 						}
> 					}
> 				}
> 				else {
> 					super.notifyChanged(notification);
> 				}
> 			}
> 		};
440d513
< 
448a522
> 			updateProblemIndication = false;
456a531,592
> 						if (!resourceToDiagnosticMap.containsKey(resource)) {
> 							resourceToDiagnosticMap.put(resource, analyzeResourceProblems(resource, exception));
> 						}
> 					}
> 				}
> 			}
> 			updateProblemIndication = true;
> 			updateProblemIndication();
> 		}
> 	}
>   
> 	/**
> 	 * Updates the problems indication with the information described in the specified diagnostic.
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */
> 	protected void updateProblemIndication() {
> 		if (updateProblemIndication) {
> 			BasicDiagnostic diagnostic =
> 				new BasicDiagnostic
> 					(Diagnostic.OK,
> 					 "org.eclipse.gmf.codegen.edit", 
> 					 0,
> 					 null,
> 					 new Object [] { editingDomain.getResourceSet() });
> 			for (Iterator i = resourceToDiagnosticMap.values().iterator(); i.hasNext(); ) {
> 				Diagnostic childDiagnostic = (Diagnostic)i.next();
> 				if (childDiagnostic.getSeverity() != Diagnostic.OK) {
> 					diagnostic.add(childDiagnostic);
> 				}
> 			}
> 			
> 			int lastEditorPage = getPageCount() - 1;
> 			if (lastEditorPage >= 0 && getEditor(lastEditorPage) instanceof ProblemEditorPart) {
> 				((ProblemEditorPart)getEditor(lastEditorPage)).setDiagnostic(diagnostic);
> 				if (diagnostic.getSeverity() != Diagnostic.OK) {
> 					setActivePage(lastEditorPage);
> 				}
> 			}
> 			else if (diagnostic.getSeverity() != Diagnostic.OK) {
> 				ProblemEditorPart problemEditorPart = new ProblemEditorPart();
> 				problemEditorPart.setDiagnostic(diagnostic);
> 				problemEditorPart.setMarkerHelper(markerHelper);
> 				try {
> 					addPage(getPageCount(), problemEditorPart, getEditorInput());
> 					lastEditorPage++;
> 					setPageText(lastEditorPage, problemEditorPart.getPartName());
> 					setActivePage(lastEditorPage);
> 				}
> 				catch (PartInitException exception) {
> 					EditorPlugin.INSTANCE.log(exception);
> 				}
> 			}
> 
> 			if (markerHelper.hasMarkers(editingDomain.getResourceSet())) {
> 				markerHelper.deleteMarkers(editingDomain.getResourceSet());
> 				if (diagnostic.getSeverity() != Diagnostic.OK) {
> 					try {
> 						markerHelper.createMarkers(diagnostic);
> 					}
> 					catch (CoreException exception) {
738a875,907
> 	 * Returns a dignostic describing the errors and warnings listed in the resource
> 	 * and the specified exception (if any).
> 	 * <!-- begin-user-doc -->
> 	 * <!-- end-user-doc -->
> 	 * @generated
> 	 */
> 	public Diagnostic analyzeResourceProblems(Resource resource, Exception exception) {
> 		if (!resource.getErrors().isEmpty() || !resource.getWarnings().isEmpty()) {
> 			BasicDiagnostic basicDiagnostic =
> 				new BasicDiagnostic
> 					(Diagnostic.ERROR,
> 					 "org.eclipse.gmf.codegen.edit", 
> 					 0,
> 					 getString("_UI_CreateModelError_message", resource.getURI()), 
> 					 new Object [] { exception == null ? (Object)resource : exception });
> 			basicDiagnostic.merge(EcoreUtil.computeDiagnostic(resource, true));
> 			return basicDiagnostic;
> 		}
> 		else if (exception != null) {
> 			return
> 				new BasicDiagnostic
> 					(Diagnostic.ERROR,
> 					 "org.eclipse.gmf.codegen.edit", 
> 					 0,
> 					 getString("_UI_CreateModelError_message", resource.getURI()), 
> 					 new Object[] { exception });
> 		}
> 		else {
> 			return Diagnostic.OK_INSTANCE;
> 		}
> 	}
> 	
> 	/**
748a918,921
> 		// Only creates the other pages if there is something that can be edited
> 		//
> 		if (!getEditingDomain().getResourceSet().getResources().isEmpty() &&
> 		    !((Resource)getEditingDomain().getResourceSet().getResources().get(0)).getContents().isEmpty()) {
937a1111
> 		}
938a1113,1115
> 		// Ensures that this editor will only display the page's tab
> 		// area if there are more than one page
> 		//		
949a1127,1128
> 
> 		updateProblemIndication();
1157d1335
< 					try {
1163a1342
> 							try {
1166a1346,1348
> 							catch (Exception exception) {
> 								resourceToDiagnosticMap.put(resource, analyzeResourceProblems(resource, exception));
> 							}
1170,1172d1351
< 					catch (Exception exception) {
< 						EditorPlugin.INSTANCE.log(exception);
< 					}
1175a1355
> 		updateProblemIndication = false;
1190a1371,1373
> 		updateProblemIndication = true;
> 		
> 		updateProblemIndication();
1209,1210c1392,1393
< 		catch (IOException e) { }
< 
---
> 		catch (IOException e) {
> 		}
