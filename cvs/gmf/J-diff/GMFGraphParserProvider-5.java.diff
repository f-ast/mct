4,11d3
< import org.eclipse.emf.ecore.EObject;
< import org.eclipse.gmf.runtime.common.core.service.AbstractProvider;
< import org.eclipse.gmf.runtime.common.core.service.IOperation;
< import org.eclipse.gmf.runtime.common.ui.services.parser.GetParserOperation;
< import org.eclipse.gmf.runtime.common.ui.services.parser.IParser;
< import org.eclipse.gmf.runtime.common.ui.services.parser.IParserProvider;
< import org.eclipse.gmf.runtime.emf.type.core.ElementTypeRegistry;
< import org.eclipse.gmf.runtime.emf.type.core.IElementType;
13d4
< 
18d8
< 
19a10,15
> import org.eclipse.gmf.runtime.common.core.service.AbstractProvider;
> import org.eclipse.gmf.runtime.common.core.service.IOperation;
> import org.eclipse.gmf.runtime.common.ui.services.parser.GetParserOperation;
> import org.eclipse.gmf.runtime.common.ui.services.parser.IParser;
> import org.eclipse.gmf.runtime.common.ui.services.parser.IParserProvider;
> import org.eclipse.gmf.runtime.notation.View;
121,123c117,119
< 	protected IParser getParser(IElementType type, int visualID) {
< 		if (GMFGraphElementTypes.Compartment_1001 == type) {
< 			if (Compartment_nameEditPart.VISUAL_ID == visualID) {
---
> 	protected IParser getParser(int visualID) {
> 		switch (visualID) {
> 		case Compartment_nameEditPart.VISUAL_ID:
125,128c121
< 			}
< 		}
< 		if (GMFGraphElementTypes.Node_1002 == type) {
< 			if (Node_nameEditPart.VISUAL_ID == visualID) {
---
> 		case Node_nameEditPart.VISUAL_ID:
130,133c123
< 			}
< 		}
< 		if (GMFGraphElementTypes.Connection_1003 == type) {
< 			if (Connection_nameEditPart.VISUAL_ID == visualID) {
---
> 		case Connection_nameEditPart.VISUAL_ID:
135,138c125
< 			}
< 		}
< 		if (GMFGraphElementTypes.FigureGallery_1004 == type) {
< 			if (FigureGallery_nameEditPart.VISUAL_ID == visualID) {
---
> 		case FigureGallery_nameEditPart.VISUAL_ID:
141d127
< 		}
149,153c135,141
< 		int visualID = GMFGraphVisualIDRegistry.getVisualID((String) hint.getAdapter(String.class));
< 		IElementType type = (IElementType) hint.getAdapter(IElementType.class);
< 		if (type == null) {
< 			EObject element = (EObject) hint.getAdapter(EObject.class);
< 			type = ElementTypeRegistry.getInstance().getElementType(element);
---
> 		String vid = (String) hint.getAdapter(String.class);
> 		if (vid != null) {
> 			return getParser(GMFGraphVisualIDRegistry.getVisualID(vid));
> 		}
> 		View view = (View) hint.getAdapter(View.class);
> 		if (view != null) {
> 			return getParser(GMFGraphVisualIDRegistry.getVisualID(view));
155c143
< 		return getParser(type, visualID);
---
> 		return null;
