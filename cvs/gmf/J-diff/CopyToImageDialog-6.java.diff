2c2
<  * Copyright (c) 2006 IBM Corporation and others.
---
>  * Copyright (c) 2006, 2007 IBM Corporation and others.
128a129,133
> 	 * the path argument passed into the dialog.
> 	 */
> 	private IPath path;
> 
> 	/**
203a209,213
> 	 * The string with a html file extension.
> 	 */
> 	private static final String HTML_STRING = "html"; //$NON-NLS-1$
> 
> 	/**
237c247,250
< 		initDialogSettings(path);
---
> 		
> 		this.path = path;
> 		
> 		initDialogSettings();
359c372
< 		String extension = exportToHTML ? "html" : imageFormat.getName().toLowerCase();
---
> 		String extension = exportToHTML ? HTML_STRING : imageFormat.getName().toLowerCase();
480c493
< 			extension.append("html");
---
> 			extension.append(HTML_STRING);
520,521c533,534
< 			File path = new File(dirName);
< 			if (path.exists())
---
> 			File aPath = new File(dirName);
> 			if (aPath.exists())
542,543c555,556
< 		IPath path = new Path(EMPTY_STRING);
< 		if (!path.isValidPath(folderText.getText())) {
---
> 		IPath aPath = new Path(EMPTY_STRING);
> 		if (!aPath.isValidPath(folderText.getText())) {
633,636d645
< 	 * 
< 	 * @param path
< 	 *            the default path to use for the diagram file or null if the
< 	 *            dialog should use some default path.
638c647
< 	private void initDialogSettings(IPath path) {
---
> 	private void initDialogSettings() {
641,645d649
< 		// By defualt, the folder will be the root of the filesystem, where ever
< 		//  that may be on a system.
< 		folder = "/"; //$NON-NLS-1$
< 		
< 		if (path == null) {
649c653,658
< 			}
---
> 		} else {
> 
> 			if (path == null) {
> 				// By default, the folder will be the root of the filesystem,
> 				// where ever that may be on a system.
> 				folder = "/"; //$NON-NLS-1$
652a662
> 		}
673a684,689
> 		if (! path.toOSString().equals(folder)) {
> 			// only persist the folder if the user changed the value.
> 			// We like to save diagrams in a folder different to the 
> 			// <workspace>/project_name folder and have the Save As 
> 			// Image File dialog remember this setting and display 
> 			// it as the new default. 
674a691
> 		}
