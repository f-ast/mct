382c382,385
< 		List selection = new ArrayList();
---
> 		IStructuredSelection structuredSelection = getSelectedElements();
> 		if (structuredSelection == null) {
> 			return;
> 		}
384c387,388
< 		for (Iterator e = getSelectedElements().iterator(); e.hasNext();) {
---
> 		List selection = new ArrayList();
> 		for (Iterator e = structuredSelection.iterator(); e.hasNext();) {
