2c2
<  * Copyright (c) 2002, 2007 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2008 IBM Corporation and others.
16a17,19
> import javax.print.PrintService;
> import javax.print.PrintServiceLookup;
> 
43c46
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelper;
---
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelperUtil;
64d66
< import org.eclipse.swt.printing.Printer;
165a168,172
> 	 * Enable or disable the print option
> 	 */
> 	protected boolean enablePrinting = true;
> 
> 	/**
306a314,322
> 	 * Enable or disable printing depending on where the print preview is invoked from.
> 	 * 
> 	 * @param enablePrinting
> 	 */
> 	public void enablePrinting(boolean enablePrinting){
> 		this.enablePrinting = enablePrinting;
> 	}
> 	
> 	/**
411c427
< 		if (printActionHelper == null) {
---
> 		if (printActionHelper == null || !enablePrinting) {
781c797
< 			pageBreakBounds = PrintHelper.getPageBreakBounds(getDiagramEditPart(), true);
---
> 			pageBreakBounds = PrintHelperUtil.getPageBreakBounds(getDiagramEditPart(), true);
813,814c829,830
< 			diagramEditPart = PrintHelper.createDiagramEditPart(diagram, preferencesHint, getTempShell());
< 			PrintHelper.initializePreferences(diagramEditPart, preferencesHint);
---
> 			diagramEditPart = PrintHelperUtil.createDiagramEditPart(diagram, preferencesHint, getTempShell());
> 			PrintHelperUtil.initializePreferences(diagramEditPart, preferencesHint);
862d877
< 		Printer printer = null;
864c879,881
< 			printer = new Printer();
---
> 			PrintService[] printServices = PrintServiceLookup.lookupPrintServices(
> 					null, null);
> 			return printServices.length > 0;
866,867d882
< 			//I cannot printer.dispose(); because it may not have been
< 			//initialized
891,894d905
< 
< 		printer.dispose();
< 
< 		return true;
