16a17
> import org.eclipse.emf.edit.domain.IEditingDomainProvider;
128c129,132
<         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
---
>         TransactionalEditingDomain editingDomain = getEditingDomain();
> 		if (editingDomain == null) {
> 			return null;
> 		}
131c135,136
< 			cc.compose(new DeleteCommand(editingDomain, (View)getHost().getModel()));
---
> 			cc.compose(new DeleteCommand(editingDomain, (View) getHost()
> 				.getModel()));
135c140,141
< 				cc.compose(new DeleteCommand(editingDomain, (View)gep.getModel()));
---
> 				cc.compose(new DeleteCommand(editingDomain, (View) gep
> 					.getModel()));
143a150
> 	 * 
145c152,153
< 	 * @param deleteRequest the original delete request.
---
> 	 * @param deleteRequest
> 	 *            the original delete request.
245c253,256
<                 TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost()).getEditingDomain();
---
>                 TransactionalEditingDomain editingDomain = getEditingDomain();
>                 if (editingDomain == null) {
>                     return null;
>                 }
247,248c258,259
< 				CreateElementRequest theReq =
< 						new CreateElementRequest(editingDomain, hostElement, insertEP.getElementType());
---
>                 CreateElementRequest theReq = new CreateElementRequest(
>                     editingDomain, hostElement, insertEP.getElementType());
250,252c261,264
< 				EditCommandRequestWrapper editCommandRequest = new EditCommandRequestWrapper(theReq);
< 				Command cmd =
< 					((IGraphicalEditPart)getHost()).getCommand(editCommandRequest);
---
>                 EditCommandRequestWrapper editCommandRequest = new EditCommandRequestWrapper(
>                     theReq);
>                 Command cmd = ((IGraphicalEditPart) getHost())
>                     .getCommand(editCommandRequest);
261c273,275
< 	/* (non-Javadoc)
---
> 	/*
> 	 * (non-Javadoc)
> 	 * 
278a293,305
>     private TransactionalEditingDomain getEditingDomain() {
>          if (getHost() instanceof IGraphicalEditPart) {
>             return ((IGraphicalEditPart) getHost()).getEditingDomain();
>         } else if (getHost() instanceof IEditingDomainProvider) {
>             Object domain = ((IEditingDomainProvider) getHost())
>                 .getEditingDomain();
>             if (domain instanceof TransactionalEditingDomain) {
>                 return (TransactionalEditingDomain) domain;
>             }
>         }
>         return null;
>     }
> 
