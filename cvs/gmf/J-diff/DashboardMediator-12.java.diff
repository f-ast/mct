24d23
< import org.eclipse.core.runtime.Path;
25a25
> import org.eclipse.emf.common.util.URI;
38a39
> import org.eclipse.gmf.internal.common.URIUtil;
160,170d160
< 	public IFile getFile(String fileName) {
< 		return project.getFile(new Path(fileName));
< 	}
< 
< 	public String getName(IFile file) {
< 		if (file == null) {
< 			return null;
< 		}
< 		return file.getProjectRelativePath().toString();
< 	}
< 
197,202c187,192
< 		setModelName(view.getDGMFigure(), state.dgmFileName);
< 		setModelName(view.getGDMFigure(), state.gdmFileName);
< 		setModelName(view.getDMFigure(), state.dmFileName);
< 		setModelName(view.getTDMFigure(), state.tdmFileName);
< 		setModelName(view.getMMFigure(), state.mmFileName);
< 		setModelName(view.getGMFigure(), state.gmFileName);
---
> 		setModelName(view.getDGMFigure(), state.getDGM());
> 		setModelName(view.getGDMFigure(), state.getGDM());
> 		setModelName(view.getDMFigure(), state.getDM());
> 		setModelName(view.getTDMFigure(), state.getTDM());
> 		setModelName(view.getMMFigure(), state.getMM());
> 		setModelName(view.getGMFigure(), state.getGM());
206,207c196,198
< 	protected void setModelName(ModelFigure figure, String name) {
< 		figure.setName(name);
---
> 	protected void setModelName(ModelFigure figure, URI uri) {
> 		figure.setName(uri == null ? null : uri.lastSegment());
> 		figure.setFullName(uri == null ? null : uri.toString());
220,224c211
< 			IFile file = null;
< 			String fileName = getFileName();
< 			if (fileName != null) {
< 				file = getFile(fileName);
< 			}
---
> 			IFile file = getURI() == null ? null : URIUtil.getFile(getURI());
226c213,216
< 			setFileName(getName(file));
---
> 			if (file == null) {
> 				return;
> 			}
> 			setURI(URI.createPlatformResourceURI(file.getFullPath().toString()));
232c222
< 		protected abstract String getFileName();
---
> 		protected abstract URI getURI();
234c224
< 		protected abstract void setFileName(String fileName);
---
> 		protected abstract void setURI(URI uri);
245c235
< 			return project != null && getFileName() != null;
---
> 			return project != null && getURI() != null;
252c242
< 			IFile modelFile = getFile(getFileName());
---
> 			IFile modelFile = URIUtil.getFile(getURI());
258c248
< 				String msg = MessageFormat.format(Messages.DashboardMediator_FailToOpen, new Object[] { getFileName() });
---
> 				String msg = MessageFormat.format(Messages.DashboardMediator_FailToOpen, new Object[] { getURI() });
263c253
< 		protected abstract String getFileName();
---
> 		protected abstract URI getURI();
298,303c288,293
< 			addFile(selection, state.dmFileName);
< 			addFile(selection, state.dgmFileName);
< 			addFile(selection, state.gdmFileName);
< 			addFile(selection, state.tdmFileName);
< 			addFile(selection, state.mmFileName);
< 			addFile(selection, state.gmFileName);
---
> 			addFile(selection, state.getDM());
> 			addFile(selection, state.getDGM());
> 			addFile(selection, state.getGDM());
> 			addFile(selection, state.getTDM());
> 			addFile(selection, state.getMM());
> 			addFile(selection, state.getGM());
307,308c297,298
< 		protected void addFile(List<IFile> files, String name) {
< 			if (name == null) {
---
> 		protected void addFile(List<IFile> files, URI uri) {
> 			if (uri == null) {
311c301,304
< 			files.add(project.getFile(name));
---
> 			IFile file = URIUtil.getFile(uri);
> 			if (file != null) {
> 				files.add(file);
> 			}
326,327c319,320
< 		protected String getFileName() {
< 			return state.dgmFileName;
---
> 		protected URI getURI() {
> 			return state.getDGM();
330,331c323,324
< 		protected void setFileName(String fileName) {
< 			state.dgmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setDGM(uri);
345,346c338,339
< 		protected String getFileName() {
< 			return state.gdmFileName;
---
> 		protected URI getURI() {
> 			return state.getGDM();
349,350c342,343
< 		protected void setFileName(String fileName) {
< 			state.gdmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setGDM(uri);
364,365c357,358
< 		protected String getFileName() {
< 			return state.dmFileName;
---
> 		protected URI getURI() {
> 			return state.getDM();
368,369c361,362
< 		protected void setFileName(String fileName) {
< 			state.dmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setDM(uri);
383,384c376,377
< 		protected String getFileName() {
< 			return state.tdmFileName;
---
> 		protected URI getURI() {
> 			return state.getTDM();
387,388c380,381
< 		protected void setFileName(String fileName) {
< 			state.tdmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setTDM(uri);
402,403c395,396
< 		protected String getFileName() {
< 			return state.mmFileName;
---
> 		protected URI getURI() {
> 			return state.getMM();
406,407c399,400
< 		protected void setFileName(String fileName) {
< 			state.mmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setMM(uri);
421,422c414,415
< 		protected String getFileName() {
< 			return state.gmFileName;
---
> 		protected URI getURI() {
> 			return state.getDM();
425,426c418,419
< 		protected void setFileName(String fileName) {
< 			state.gmFileName = fileName;
---
> 		protected void setURI(URI uri) {
> 			state.setDM(uri);
436,437c429,430
< 		protected String getFileName() {
< 			return state.dgmFileName;
---
> 		protected URI getURI() {
> 			return state.getDGM();
443,444c436,437
< 		protected String getFileName() {
< 			return state.gdmFileName;
---
> 		protected URI getURI() {
> 			return state.getGDM();
450,451c443,444
< 		protected String getFileName() {
< 			return state.dmFileName;
---
> 		protected URI getURI() {
> 			return state.getDM();
457,458c450,451
< 		protected String getFileName() {
< 			return state.tdmFileName;
---
> 		protected URI getURI() {
> 			return state.getTDM();
464,465c457,458
< 		protected String getFileName() {
< 			return state.mmFileName;
---
> 		protected URI getURI() {
> 			return state.getMM();
471,472c464,465
< 		protected String getFileName() {
< 			return state.gmFileName;
---
> 		protected URI getURI() {
> 			return state.getGM();
484c477
< 			state.gdmFileName = getName(file);
---
> 			state.setGDM(file);
497c490
< 			state.dmFileName = getName(file);
---
> 			state.setDM(file);
510c503
< 			state.tdmFileName = getName(file);
---
> 			state.setTDM(file);
523c516
< 			state.mmFileName = getName(file);
---
> 			state.setMM(file);
536c529
< 			state.gmFileName = getName(file);
---
> 			state.setGM(file);
547c540
< 			return state.dgmFileName != null;
---
> 			return state.getDGM() != null;
551c544
< 			IFile file = getFile(state.dgmFileName);
---
> 			IFile file = URIUtil.getFile(state.getDGM());
564c557
< 			return super.isEnabled() && state.dmFileName != null;
---
> 			return super.isEnabled() && state.getDM() != null;
573c566
< 			state.dgmFileName = getName(file);
---
> 			state.setDGM(file);
578c571
< 			return new StructuredSelection(getFile(state.dmFileName));
---
> 			return new StructuredSelection(URIUtil.getFile(state.getDM()));
593c586
< 			return super.isEnabled() && state.dmFileName != null;
---
> 			return super.isEnabled() && state.getDM() != null;
604c597
< 			state.gdmFileName = getName(file);
---
> 			state.setGDM(file);
612c605
< 			return super.isEnabled() && state.dmFileName != null;
---
> 			return super.isEnabled() && state.getDM() != null;
623c616
< 			state.tdmFileName = getName(file);
---
> 			state.setTDM(file);
631c624
< 			return project != null && state.gdmFileName != null && state.dmFileName != null && state.tdmFileName != null;
---
> 			return project != null && state.getGDM() != null && state.getDM() != null && state.getTDM() != null;
640c633
< 			state.mmFileName = getName(file);
---
> 			state.setMM(file);
