36a37
> import org.eclipse.gmf.runtime.common.ui.util.ActivityUtil;
61d61
< import org.eclipse.ui.PlatformUI;
63,65d62
< import org.eclipse.ui.activities.IIdentifier;
< import org.eclipse.ui.activities.IWorkbenchActivitySupport;
< import org.eclipse.ui.activities.WorkbenchActivityHelper;
1020,1025d1016
<         if (!WorkbenchActivityHelper.isFiltering())
<             return true;
< 
<         IWorkbenchActivitySupport workbenchActivitySupport = PlatformUI
<             .getWorkbench().getActivitySupport();
< 
1027,1031c1018,1019
<         IIdentifier id = workbenchActivitySupport.getActivityManager()
<             .getIdentifier(
<                 WorkbenchActivityHelper
<                     .createUnifiedId(getPluginContribution()));
<         if (id != null && !id.isEnabled()) {
---
>         if (!ActivityUtil.isEnabled(getPluginContribution().getLocalId(),
>             getPluginContribution().getPluginId())) {
1036,1047c1024,1025
<         id = workbenchActivitySupport.getActivityManager().getIdentifier(
<             WorkbenchActivityHelper.createUnifiedId(new IPluginContribution() {
< 
<                 public String getLocalId() {
<                     return itemID;
<                 }
< 
<                 public String getPluginId() {
<                     return getPluginContribution().getPluginId();
<                 }
<             }));
<         if (id != null && !id.isEnabled()) {
---
>         if (!ActivityUtil.isEnabled(itemID, getPluginContribution()
>             .getPluginId())) {
