263,271c263
<         Rectangle rect = null;
<         Node parent = n.getParent();
<         while (parent!=null &&!(parent.data instanceof IGraphicalEditPart))
<             parent = parent.getParent();
<         if (parent!=null){
<             rect = new Rectangle(n.x - parent.x, n.y - parent.y, n.width, n.height);
<         }
<         else
<             rect = new Rectangle(n.x, n.y, n.width, n.height);
---
>         Rectangle rect = new Rectangle(n.x, n.y, n.width, n.height);
620c612
<     Command routeThrough(Edge edge, ConnectionEditPart connectEP, Node source, Node target, PointList points, int diffX, int diffY) {
---
>     protected Command routeThrough(Edge edge, ConnectionEditPart connectEP, Node source, Node target, PointList points, int diffX, int diffY) {
636,644d627
<         Node parent=  null;
<         parent = source.getParent();
<         if (parent==null)
<             parent = target.getParent();
<         if (parent!=null){
<             Rectangle targetExt = getNodeMetrics(parent);
<             totalEdgeDiffX += targetExt.preciseX();
<             totalEdgeDiffY += targetExt.preciseY();
<         }
758c741
< 					* sourceRatio.preciseX() + sourceExt.preciseX(), targetExt
---
> 					* sourceRatio.preciseX() + sourceExt.preciseX(), sourceExt
873,883c856,858
<         Rectangle start = translateFromGraph(
<             new Rectangle(pointList.getFirstPoint().x,
<                           pointList.getFirstPoint().y, 0, 0));
<         points.addPoint(start.getLocation());
<         NodeList vnodes = edge.vNodes;
<         if (vnodes != null) {
<             for (int i = 0; i < vnodes.size(); i++) {
<                 Node vn = vnodes.getNode(i);
<                 Rectangle nodeExt = getNodeMetrics(vn);
<                 points.addPoint(nodeExt.getCenter());
<             }
---
>         for (int i = 0; i < pointList.size(); i++) {
>         	Rectangle pt = translateFromGraph(new Rectangle(pointList.getPoint(i), new Dimension()));
>         	points.addPoint(pt.getLocation());
885,887d859
<         Rectangle end = translateFromGraph(new Rectangle(pointList.getLastPoint().x,
<             pointList.getLastPoint().y, 0, 0));
<         points.addPoint(end.getLocation());
