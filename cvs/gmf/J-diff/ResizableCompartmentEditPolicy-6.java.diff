29a30
> import org.eclipse.gmf.runtime.diagram.ui.editparts.ResizableCompartmentEditPart;
37,38c38,39
<  * A resizable editpolicy for resizable compartments. The editpolicy could be vertical
<  * or horizontal
---
>  * A resizable editpolicy for resizable compartments. The editpolicy could be
>  * vertical or horizontal
42c43,44
< public class ResizableCompartmentEditPolicy extends ResizableEditPolicyEx {
---
> public class ResizableCompartmentEditPolicy
> 	extends ResizableEditPolicyEx {
53d54
< 	
55a57
> 	 * 
70,71c72,73
< 	 * This method is used to get the collapse handle(s). Subclasses can override
< 	 * to provide different collapse handles 
---
> 	 * This method is used to get the collapse handle(s). Subclasses can
> 	 * override to provide different collapse handles
88,89c90,93
< 		int d1 = isHorizontal() ? PositionConstants.WEST : PositionConstants.NORTH;
< 		int d2 = isHorizontal() ? PositionConstants.EAST : PositionConstants.SOUTH;
---
> 		int d1 = isHorizontal() ? PositionConstants.WEST
> 			: PositionConstants.NORTH;
> 		int d2 = isHorizontal() ? PositionConstants.EAST
> 			: PositionConstants.SOUTH;
97a102,130
> 	 * @return the <code>ResizableCompartmentFigure</code> that is the
> 	 *         corresponding figure for the host edit part.
> 	 */
> 	private ResizableCompartmentFigure getCompartmentFigure() {
> 		ResizableCompartmentFigure compartmentFigure = null;
> 		if (getGraphicalEditPart() instanceof ResizableCompartmentEditPart) {
> 			compartmentFigure = ((ResizableCompartmentEditPart) getGraphicalEditPart())
> 				.getCompartmentFigure();
> 		} else if (getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure) {
> 			compartmentFigure = (ResizableCompartmentFigure) getGraphicalEditPart()
> 				.getFigure();
> 		}
> 		// TODO: remove later. this is a temporary fix for defect
> 		// RATLC00522565
> 		// eventually we will put the GatedPaneFigure inside the resizable
> 		// compartment
> 		else if (getGraphicalEditPart().getFigure() instanceof GatedPaneFigure) {
> 			GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart()
> 				.getFigure();
> 			IFigure f = gpf.getElementPane();
> 			if (f instanceof ResizableCompartmentFigure) {
> 				compartmentFigure = (ResizableCompartmentFigure) f;
> 			}
> 		}
> 
> 		return compartmentFigure;
> 	}
> 
> 	/**
103,115c136,138
< 			if ( getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure){
< 			ResizableCompartmentFigure f = 
< 				(ResizableCompartmentFigure) getGraphicalEditPart().getFigure();
< 			f.setSelected(true);
< 			}
< 			// TODO: remove later.  this is a temporary fix for defect RATLC00522565
< 			// eventually we will put the GatedPaneFigure inside the resizable compartment
< 			if ( getGraphicalEditPart().getFigure() instanceof GatedPaneFigure){
< 				GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart().getFigure();
< 				IFigure f = gpf.getElementPane();
< 				if( f instanceof ResizableCompartmentFigure ) {
< 					((ResizableCompartmentFigure)f).setSelected(true);
< 				}
---
> 			ResizableCompartmentFigure compartmentFigure = getCompartmentFigure();
> 			if (compartmentFigure != null) {
> 				compartmentFigure.setSelected(true);
126,138c149,151
< 			if ( getGraphicalEditPart().getFigure() instanceof ResizableCompartmentFigure){
< 				ResizableCompartmentFigure f =
< 					(ResizableCompartmentFigure) getGraphicalEditPart().getFigure();
< 				f.setSelected(false);
< 			}
< 			//TODO: remove later.  this is a temporary fix for defect RATLC00522565
< 			// eventually we will put the GatedPaneFigure inside the resizable compartment
< 			if ( getGraphicalEditPart().getFigure() instanceof GatedPaneFigure){
< 				GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart().getFigure();
< 				IFigure f = gpf.getElementPane();
< 				if( f instanceof ResizableCompartmentFigure ) {
< 					((ResizableCompartmentFigure)f).setSelected(false);
< 				}
---
> 			ResizableCompartmentFigure compartmentFigure = getCompartmentFigure();
> 			if (compartmentFigure != null) {
> 				compartmentFigure.setSelected(false);
143a157
> 
144a159
> 
151a167
> 
159a176
> 
166a184
> 
168c186,187
< 				if (NotationPackage.eINSTANCE.getView_Visible().equals(notification.getFeature()))
---
> 				if (NotationPackage.eINSTANCE.getView_Visible().equals(
> 					notification.getFeature()))
172c191,192
< 		PresentationListener.getInstance().addNotificationListener(getGraphicalEditPart().getNotationView(),propertyListener);
---
> 		PresentationListener.getInstance().addNotificationListener(
> 			getGraphicalEditPart().getNotationView(), propertyListener);
179c199,200
< 		PresentationListener.getInstance().removeNotificationListener(getGraphicalEditPart().getNotationView(),propertyListener);
---
> 		PresentationListener.getInstance().removeNotificationListener(
> 			getGraphicalEditPart().getNotationView(), propertyListener);
185,188c206,208
< 	 * Determine the select state of the policy based on:
< 	 * 1- The select state of the compartment editpart
< 	 * 2- The select state of the parent graphic editpart
< 	 * 3- The visibility state of the compartment editpart 
---
> 	 * Determine the select state of the policy based on: 1- The select state of
> 	 * the compartment editpart 2- The select state of the parent graphic
> 	 * editpart 3- The visibility state of the compartment editpart
194,195c214,217
< 		if (((GraphicalEditPart)getGraphicalEditPart()).getTopGraphicEditPart()!=null){
< 			topState = ((GraphicalEditPart)getGraphicalEditPart()).getTopGraphicEditPart().getSelected();	
---
> 		if (((GraphicalEditPart) getGraphicalEditPart())
> 			.getTopGraphicEditPart() != null) {
> 			topState = ((GraphicalEditPart) getGraphicalEditPart())
> 				.getTopGraphicEditPart().getSelected();
201,202c223
< 			&& ((hostState != EditPart.SELECTED_NONE || 
< 			topState != EditPart.SELECTED_NONE)))
---
> 			&& ((hostState != EditPart.SELECTED_NONE || topState != EditPart.SELECTED_NONE)))
232c253,254
< 	 * Creates a new ChangeBoundsRequest that respects the min and max of the resize deltas
---
> 	 * Creates a new ChangeBoundsRequest that respects the min and max of the
> 	 * resize deltas
237,238c259,260
< 		ResizableCompartmentFigure f =
< 			(ResizableCompartmentFigure) getHostFigure();
---
> 		ResizableCompartmentFigure f = getCompartmentFigure();
> 		
243,244c265
< 		boolean moved =
< 			(r.getResizeDirection() & PositionConstants.NORTH_WEST) != 0;
---
> 		boolean moved = (r.getResizeDirection() & PositionConstants.NORTH_WEST) != 0;
