32a33
> import org.eclipse.jface.text.IDocument;
55c56,59
<             final String txt = viewer.getDocument().get(0, documentOffset);
---
>             final IDocument doc = viewer.getDocument();
> 			final String txt = doc.get(0, documentOffset);
> 			final int additionalTextLen = Math.min(doc.getLength(), documentOffset + doc.getLineLength(doc.getLineOfOffset(documentOffset))) - documentOffset;
> 			final String textPastInsertionPoint = doc.get(documentOffset, additionalTextLen);
74c78
<                 proposals.addAll(new KeywordProposalComputer().computeProposals(txt, ctx, f));
---
>                 proposals.addAll(new KeywordProposalComputer(textPastInsertionPoint).computeProposals(txt, ctx, f));
86,87d89
<                 	// [artem] originally there was compareTo, but e.g. ExpressionProposalComputer
<                 	// ignores case when deciding what to take, so why should we
89c91
<                     return p1.getDisplayString().compareToIgnoreCase(p2.getDisplayString());
---
>                     return p1.getDisplayString().compareTo(p2.getDisplayString());
