387c387,388
<             PaletteEntry paletteEntry = findPredefinedEntry(predefinedEntries, id);
---
>             // first try to find it in the palette root
>             PaletteEntry paletteEntry = findPaletteEntry(root, id);
390,398d390
<                 // this entry has been predefined but not contributed,
<                 // contributethis entry to the palette now
<                 if (path != null && !remove) {
<                     appendPaletteEntry(root, predefinedEntries, path,
<                         paletteEntry);
<                 }
<             } else {
<                 paletteEntry = findPaletteEntry(root, id);
<             }
410a403,424
> 
>             }
>             
>             // now check to see if it has been predefined only
>             if (paletteEntry == null) {
>                 paletteEntry = findPredefinedEntry(predefinedEntries, id);
>             }
>             
>             if (paletteEntry != null) {
>                 
>                 if (path != null) {
>                     appendPaletteEntry(root, predefinedEntries, path,
>                         paletteEntry);
>                     
>                     // Set expand state on drawers.
>                     if (paletteEntry instanceof PaletteDrawer
>                         && expandHelper.expand(content)) {
>                         ((PaletteDrawer) paletteEntry)
>                             .setInitialState(PaletteDrawer.INITIAL_STATE_OPEN);
>                     }
>                 }
>             }
