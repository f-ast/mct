2c2
<  * Copyright (c) 2002, 2005 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
318c318
< 	 * @param val the path map variable value (a file URI)
---
> 	 * @param val the path map variable value (must be an encoded URI)
455d454
< 
461,462c460,463
< 				paths.put(var, url.toString());
< 
---
> 				// We must encode here because everything that is placed into the path
> 				//  map must be encoded to match the encoded URI's on each resource
> 				//  in the resource set.
> 				paths.put(var, URI.createURI(url.toString(),true).toString());
464d464
< 
