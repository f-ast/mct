13a14,20
> import java.io.File;
> import java.io.FileOutputStream;
> import java.io.IOException;
> import java.net.MalformedURLException;
> import java.util.ArrayList;
> import java.util.StringTokenizer;
> 
29c36,37
< 	private String myTemplateRoot;
---
> 	private String[] myTemplateRoots;
> 	private String myOutFile;
39,40c47,52
< 	public void setBareInput(int i) {
< 		myTemplateTarget = i;
---
> 	public void setInputURI(String uri) {
> 		myTemplateTarget = uri;
> 	}
> 
> 	public void setOutFile(String uri) {
> 		myOutFile = uri;
41a54
> 
43c56,60
< 		myTemplateRoot = root;
---
> 		ArrayList<String> roots = new ArrayList<String>();
> 		for (StringTokenizer st = new StringTokenizer(root, ";, "); st.hasMoreTokens(); ) {
> 			roots.add(st.nextToken().trim());
> 		}
> 		myTemplateRoots = roots.toArray(new String[roots.size()]);
60a78
> 		if (myOutFile == null) {
61a80,89
> 		} else {
> 			try {
> 				File f = getProject().resolveFile(myOutFile);
> 				FileOutputStream os = new FileOutputStream(f);
> 				os.write(result.getBytes());
> 				os.close();
> 			} catch (IOException ex) {
> 				throw new BuildException("Can't write to " + myOutFile, ex, getLocation());
> 			}
> 		}
70a99,101
> 		if (myTemplateRoots == null || myTemplateRoots.length == 0) {
> 			throw new BuildException("No template root specified", getLocation());
> 		}
81c112
< 	protected XpandFacade createFacade() {
---
> 	protected XpandFacade createFacade() throws BuildException {
84c115,117
< 			xf.addLocation(myTemplateRoot);
---
> 			for (String r : myTemplateRoots) {
> 				xf.addLocation(r);
> 			}
86,88c119,120
< 		} catch (Exception ex) {
< 			ex.printStackTrace();
< 			// FIXME
---
> 		} catch (MalformedURLException ex) {
> 			throw new BuildException(ex, getLocation());
90,91d121
< 		assert false;
< 		return null;
