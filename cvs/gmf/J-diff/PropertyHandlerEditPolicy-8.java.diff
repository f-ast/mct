17a18,19
> import org.eclipse.core.commands.ExecutionException;
> import org.eclipse.core.runtime.IAdaptable;
18a21
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
36c39
< import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand;
74c77
< 							new SetPropertyCommand(
---
> 							new SetPropertyCommand(getEditingDomain(),
96c99
< 						compositeCommand.compose(new SetPropertyCommand(
---
> 						compositeCommand.compose(new SetPropertyCommand(getEditingDomain(),
116,117c119,123
< 			ICommand viewStyleCommand = new AbstractModelCommand(APPLY_APPEARANCE_PROPERTIES_UNDO_COMMAND_NAME, null) {
< 				protected CommandResult doExecute(IProgressMonitor progressMonitor) {
---
>             ICommand viewStyleCommand = new AbstractTransactionalCommand(getEditingDomain(),
>                 APPLY_APPEARANCE_PROPERTIES_UNDO_COMMAND_NAME, null) {
> 				protected CommandResult doExecuteWithResult(
>                         IProgressMonitor progressMonitor, IAdaptable info)
>                     throws ExecutionException {
120c126
< 					return newOKCommandResult();
---
> 					return CommandResult.newOKCommandResult();
172a179,182
>     protected TransactionalEditingDomain getEditingDomain() {
>         return ((IGraphicalEditPart) getHost()).getEditingDomain();
>     }
> 
