21a22,46
> import org.eclipse.gmf.runtime.common.core.util.Log;
> import org.eclipse.gmf.runtime.common.core.util.Trace;
> import org.eclipse.gmf.runtime.common.ui.action.actions.IPrintActionHelper;
> import org.eclipse.gmf.runtime.common.ui.util.WindowUtil;
> import org.eclipse.gmf.runtime.diagram.core.preferences.PreferencesHint;
> import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart;
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IDiagramPreferenceSupport;
> import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper;
> import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper.PageMargins;
> import org.eclipse.gmf.runtime.diagram.ui.internal.properties.WorkspaceViewerProperties;
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer;
> import org.eclipse.gmf.runtime.diagram.ui.parts.IDiagramWorkbenchPart;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingDebugOptions;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingPlugin;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingStatusCodes;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.l10n.DiagramPrintingResourceManager;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.HeaderAndFooterHelper;
> import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelper;
> import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.MapModeGraphics;
> import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.ScaledGraphics;
> import org.eclipse.gmf.runtime.draw2d.ui.internal.mapmode.DiagramMapModeUtil;
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;
> import org.eclipse.gmf.runtime.notation.Diagram;
48,71d72
< import org.eclipse.gmf.runtime.common.core.util.Log;
< import org.eclipse.gmf.runtime.common.core.util.Trace;
< import org.eclipse.gmf.runtime.common.ui.action.actions.IPrintActionHelper;
< import org.eclipse.gmf.runtime.common.ui.util.WindowUtil;
< import org.eclipse.gmf.runtime.diagram.core.preferences.PreferencesHint;
< import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart;
< import org.eclipse.gmf.runtime.diagram.ui.editparts.IDiagramPreferenceSupport;
< import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper;
< import org.eclipse.gmf.runtime.diagram.ui.internal.pagesetup.PageInfoHelper.PageMargins;
< import org.eclipse.gmf.runtime.diagram.ui.internal.properties.WorkspaceViewerProperties;
< import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
< import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer;
< import org.eclipse.gmf.runtime.diagram.ui.parts.IDiagramWorkbenchPart;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingDebugOptions;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingPlugin;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.DiagramPrintingStatusCodes;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.l10n.DiagramPrintingResourceManager;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.HeaderAndFooterHelper;
< import org.eclipse.gmf.runtime.diagram.ui.printing.internal.util.PrintHelper;
< import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.MapModeGraphics;
< import org.eclipse.gmf.runtime.draw2d.ui.internal.graphics.ScaledGraphics;
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
< import org.eclipse.gmf.runtime.notation.Diagram;
< 
673a675,684
> 	private IMapMode mm;
> 	
> 	/**
> 	 * The constructor.
> 	 * @param mm <code>IMapMode</code> to do the coordinate mapping
> 	 */
> 	public PrintPreviewHelper(IMapMode mm) {
> 		this.mm = mm;
> 	}
> 
678c689,696
< 		//
---
> 		this(MapModeUtil.getMapMode());
> 	}
> 	
> 	/**
> 	 * @return <code>IMapMode</code> to do the coordinate mapping
> 	 */
> 	protected IMapMode getMapMode() {
> 		return mm;
922c940
< 				/ (float) MapMode.getScale();
---
> 				/ (float) DiagramMapModeUtil.getScale(getMapMode());
1105c1123
< 				(pageSize.x - MapMode.DPtoLP(gc.textExtent(headerOrFooter).x)) / 2,
---
> 				(pageSize.x - getMapMode().DPtoLP(gc.textExtent(headerOrFooter).x)) / 2,
1117c1135
< 				(pageSize.x - MapMode.DPtoLP(gc.textExtent(headerOrFooter).x)) / 2,
---
> 				(pageSize.x - getMapMode().DPtoLP(gc.textExtent(headerOrFooter).x)) / 2,
1198c1216
< 		return new MapModeGraphics(scaledGraphics);
---
> 		return new MapModeGraphics(scaledGraphics, getMapMode());
