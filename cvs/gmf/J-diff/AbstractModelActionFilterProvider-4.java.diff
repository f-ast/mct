2c2
<  * Copyright (c) 2002, 2003 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
13a14,15
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
> import org.eclipse.emf.transaction.util.TransactionUtil;
18,19c20
< import org.eclipse.gmf.runtime.emf.core.exceptions.MSLActionAbandonedException;
< import org.eclipse.gmf.runtime.emf.core.util.OperationUtil;
---
> import org.eclipse.gmf.runtime.common.ui.services.action.filter.TestAttributeOperation;
109a111,116
>         TransactionalEditingDomain domain = TransactionUtil.getEditingDomain(target);
> 
>         if (domain == null) {
>             return false;
>         }
>             
111c118
< 			OperationUtil.runAsRead(new Runnable() {
---
>             domain.runExclusive(new Runnable() {
123,124c130
< 						RuntimeException cre = new RuntimeException(
< 							e);
---
>                         RuntimeException cre = new RuntimeException(e);
132,136c138,144
< 		} catch (MSLActionAbandonedException e) {
< 			// This is not expected to happen.
< 			Trace.trace(MslUIPlugin.getDefault(),
< 				MslUIDebugOptions.MODEL_OPERATIONS,
< 				"MSLActionAbandonedException"); //$NON-NLS-1$
---
>         } catch (InterruptedException e) {
>             Trace.catching(MslUIPlugin.getDefault(),
>                 MslUIDebugOptions.EXCEPTIONS_CATCHING, getClass(),
>                 "testAttribute", e); //$NON-NLS-1$
>             Log.error(MslUIPlugin.getDefault(),
>                 MslUIStatusCodes.IGNORED_EXCEPTION_WARNING, e
>                     .getLocalizedMessage(), e);
148c156,157
< 	 * @param operation The operation in question.
---
>      * @param operation
>      *            The operation in question.
154a164,177
>         TransactionalEditingDomain domain = null;
> 
>         if (operation instanceof TestAttributeOperation) {
>             Object target = ((TestAttributeOperation) operation).getTarget();
> 
>             if (target != null) {
>                 domain = TransactionUtil.getEditingDomain(target);
>             }
>         }
> 
>         if (domain == null) {
>             return false;
>         }
>         
156c179
< 			OperationUtil.runAsRead(new Runnable() {
---
> 			domain.runExclusive(new Runnable() {
177,181c200,206
< 		} catch (MSLActionAbandonedException e) {
< 			// This is not expected to happen.
< 			Trace.trace(MslUIPlugin.getDefault(),
< 				MslUIDebugOptions.MODEL_OPERATIONS,
< 				"MSLActionAbandonedException"); //$NON-NLS-1$
---
> 		} catch (InterruptedException e) {
>             Trace.catching(MslUIPlugin.getDefault(),
>                 MslUIDebugOptions.EXCEPTIONS_CATCHING, getClass(),
>                 "provides", e); //$NON-NLS-1$
>             Log.error(MslUIPlugin.getDefault(),
>                 MslUIStatusCodes.IGNORED_EXCEPTION_WARNING, e
>                     .getLocalizedMessage(), e);
