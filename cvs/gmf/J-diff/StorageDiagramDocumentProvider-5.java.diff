3c3
<  * All rights reserved. This program and the accompanying materials
---
> f * All rights reserved. This program and the accompanying materials
19a20
> import org.eclipse.gmf.runtime.diagram.ui.resources.editor.document.DiagramModificationListener;
40a42,52
> 	//a StorageInfo with a DiagramModificationListener 
> 	private class DiagramStorageInfo extends StorageInfo {
> 
> 		DiagramModificationListener fListener;
> 		public DiagramStorageInfo(IDocument document, DiagramModificationListener listener) {
> 			super(document);
> 			fListener = listener;
> 		}
> 		
> 	}
> 
68,69c80,81
< 			IDiagramDocument diagramDocument = (IDiagramDocument)info.fDocument;
< 			diagramDocument.disableDiagramListener();
---
> 			assert info instanceof DiagramStorageInfo;
> 			((DiagramStorageInfo)info).fListener.stopListening();
105a118,128
> 
> 	/* (non-Javadoc)
> 	 * @see org.eclipse.gmf.runtime.diagram.ui.resources.editor.ide.document.StorageDocumentProvider#createNewElementInfo(org.eclipse.gmf.runtime.diagram.ui.resources.editor.document.IDocument)
> 	 */
> 	public ElementInfo createNewElementInfo(IDocument document) {
> 		DiagramModificationListener listener = new DiagramModificationListener(this, (DiagramDocument)document);
> 		DiagramStorageInfo info = new DiagramStorageInfo(document, listener);
> 		listener.startListening();
> 		return info;
> 	}
> 
