14a15
> import org.eclipse.draw2d.geometry.Dimension;
25,27c26,28
< import org.eclipse.gmf.runtime.diagram.ui.editparts.BorderItemEditPart;
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure;
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure.BorderItemLocator;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IBorderItemEditPart;
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart;
> import org.eclipse.gmf.runtime.diagram.ui.figures.IBorderItemLocator;
34c35
<  * Edit policy to restrict border item movement along border of bordered item.
---
>  * Edit policy to restrict border item movement.
36c37
<  * @author jbruck
---
>  * @author jbruck, cmahoney
67,69c68,71
< 		BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost();
< 		BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP
< 			.getLocator();
---
> 		IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost();
> 		IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator();
> 		
> 		if (borderItemLocator != null) {
77,78c79,80
< 		Rectangle realLocation = borderItemLocator.locateOnBorder(rect
< 			.getCopy());
---
> 			Rectangle realLocation = borderItemLocator.getValidLocation(rect
> 				.getCopy(), borderItemEP.getFigure());
82a85
> 	}
92,94c95,96
< 		BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost();
< 		BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP
< 			.getLocator();
---
> 		IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost();
> 		IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator();
95a98
> 		if (borderItemLocator != null) {
103,106c106,112
< 		Rectangle realLocation = borderItemLocator.locateOnBorder(rect
< 			.getCopy());
< 		Point location = borderItemLocator.getRelativeToBorder(realLocation
< 			.getTopLeft());
---
> 			Rectangle realLocation = borderItemLocator.getValidLocation(rect
> 				.getCopy(), borderItemEP.getFigure());
> 
> 			Point parentOrigin = ((IGraphicalEditPart) borderItemEP.getParent())
> 				.getFigure().getBounds().getTopLeft();
> 			Dimension d = realLocation.getTopLeft().getDifference(parentOrigin);
> 			Point location = new Point(d.width, d.height);
112a119,120
> 		return null;
> 	}
117a126
> 
