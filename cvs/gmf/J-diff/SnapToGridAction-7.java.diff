2c2
<  * Copyright (c) 2004 IBM Corporation and others.
---
>  * Copyright (c) 2004, 2007 IBM Corporation and others.
108a109,111
> 			// set checked to 'false' if the IDiagramWorkbenchPart doesn't have a
> 			// graphical viewer or the viewer doesn't have a preference store
> 			boolean shouldBeChecked = false;
111a115,116
> 				
> 				if (viewer != null) {
113c118,122
< 				boolean shouldBeChecked = preferenceStore.getBoolean(WorkspaceViewerProperties.SNAPTOGRID);
---
> 				
> 					if (preferenceStore != null) {
> 						shouldBeChecked = preferenceStore.getBoolean(WorkspaceViewerProperties.SNAPTOGRID);
> 					}
> 				}
