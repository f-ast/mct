22a23
> import org.eclipse.core.commands.ExecutionException;
26a28
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
66c68
< import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.AbstractTransactionalCommand;
121c123,127
< 			return new EtoolsProxyCommand(new PasteCommand(DiagramUIMessages.PasteCommand_Label, viewContext, data, MapModeUtil.getMapMode(((org.eclipse.gef.GraphicalEditPart)getHost()).getFigure()))); 
---
> 			return new EtoolsProxyCommand(new PasteCommand(editPart
>                 .getEditingDomain(), DiagramUIMessages.PasteCommand_Label,
>                 viewContext, data, MapModeUtil
>                     .getMapMode(((org.eclipse.gef.GraphicalEditPart) getHost())
>                         .getFigure())));
183c189,190
< 			toReturn.compose( new BringToFrontCommand((View) element.getModel() ));
---
> 			toReturn.compose(new BringToFrontCommand(
>                 element.getEditingDomain(), (View) element.getModel()));
202c209,210
< 			toReturn.compose(new BringForwardCommand((View)toOrder.getModel() ));
---
> 			toReturn.compose(new BringForwardCommand(
>                 toOrder.getEditingDomain(), (View) toOrder.getModel()));
221c229,230
< 			toReturn.compose(new SendToBackCommand((View)toOrder.getModel() ));
---
> 			toReturn.compose(new SendToBackCommand(toOrder.getEditingDomain(),
>                 (View) toOrder.getModel()));
240c249,250
< 			toReturn.compose(new SendBackwardCommand((View)toOrder.getModel() ));
---
> 			toReturn.compose(new SendBackwardCommand(
>                 toOrder.getEditingDomain(), (View) toOrder.getModel()));
254a265,266
>             TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost())
>                 .getEditingDomain();
256c268
< 				new DeferredLayoutCommand(
---
> 				new DeferredLayoutCommand(editingDomain,
302,303c314,320
< 			return new EtoolsProxyCommand(new AbstractModelCommand("", null) {//$NON-NLS-1$
< 				protected CommandResult doExecute(IProgressMonitor progressMonitor) {
---
>             TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost())
>                 .getEditingDomain();
>             
> 			return new EtoolsProxyCommand(new AbstractTransactionalCommand(editingDomain, "", null) {//$NON-NLS-1$
> 				protected CommandResult doExecuteWithResult(
>                             IProgressMonitor progressMonitor, IAdaptable info)
>                         throws ExecutionException {
305c322
< 					return newOKCommandResult();
---
> 					return CommandResult.newOKCommandResult();
380c397
< 					new ArrayList(elementsToDuplicate));
---
>                     editingDomain, new ArrayList(elementsToDuplicate));
390c407,408
< 					cc.compose(new DuplicateViewsCommand(
---
>                     
> 					cc.compose(new DuplicateViewsCommand(editingDomain,
397c415
< 				return new EtoolsProxyCommand(new DuplicateViewsCommand(
---
> 				return new EtoolsProxyCommand(new DuplicateViewsCommand(editingDomain,
