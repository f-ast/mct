12a13,14
> import java.util.Collection;
> import java.util.HashSet;
15a18
> import java.util.Set;
17,18c20
< import org.eclipse.emf.ecore.EObject;
< import org.eclipse.gmf.gmfgraph.Figure;
---
> import org.eclipse.gmf.gmfgraph.GMFGraphPackage;
22a25,26
> import org.eclipse.gmf.graphdef.editor.part.GMFGraphDiagramUpdater;
> import org.eclipse.gmf.graphdef.editor.part.GMFGraphNodeDescriptor;
34a39,43
> 	Set myFeaturesToSynchronize;
> 
> 	/**
> 	 * @generated
> 	 */
36,37d44
< 		List result = new LinkedList();
< 		EObject modelObject = ((View) getHost().getModel()).getElement();
39,61c46,48
< 		EObject nextValue;
< 		int nodeVID;
< 		for (Iterator values = ((Figure) modelObject).getChildren().iterator(); values.hasNext();) {
< 			nextValue = (EObject) values.next();
< 			nodeVID = GMFGraphVisualIDRegistry.getNodeVisualID(viewObject, nextValue);
< 			switch (nodeVID) {
< 			case Rectangle2EditPart.VISUAL_ID: {
< 				result.add(nextValue);
< 				break;
< 			}
< 			case EllipseEditPart.VISUAL_ID: {
< 				result.add(nextValue);
< 				break;
< 			}
< 			case RoundedRectangleEditPart.VISUAL_ID: {
< 				result.add(nextValue);
< 				break;
< 			}
< 			case PolylineEditPart.VISUAL_ID: {
< 				result.add(nextValue);
< 				break;
< 			}
< 			}
---
> 		List result = new LinkedList();
> 		for (Iterator it = GMFGraphDiagramUpdater.getEllipse_3015SemanticChildren(viewObject).iterator(); it.hasNext();) {
> 			result.add(((GMFGraphNodeDescriptor) it.next()).getModelElement());
69,74c56,58
< 	protected boolean shouldDeleteView(View view) {
< 		if (view.getEAnnotation("Shortcut") != null) { //$NON-NLS-1$
< 			return view.isSetElement() && (view.getElement() == null || view.getElement().eIsProxy());
< 		}
< 		int nodeVID = GMFGraphVisualIDRegistry.getVisualID(view);
< 		switch (nodeVID) {
---
> 	protected boolean isOrphaned(Collection semanticChildren, final View view) {
> 		int visualID = GMFGraphVisualIDRegistry.getVisualID(view);
> 		switch (visualID) {
79c63
< 			return true;
---
> 			return !semanticChildren.contains(view.getElement()) || visualID != GMFGraphVisualIDRegistry.getNodeVisualID((View) getHost().getModel(), view.getElement());
90a75,85
> 	/**
> 	 * @generated
> 	 */
> 	protected Set getFeaturesToSynchronize() {
> 		if (myFeaturesToSynchronize == null) {
> 			myFeaturesToSynchronize = new HashSet();
> 			myFeaturesToSynchronize.add(GMFGraphPackage.eINSTANCE.getRealFigure_Children());
> 		}
> 		return myFeaturesToSynchronize;
> 	}
> 
