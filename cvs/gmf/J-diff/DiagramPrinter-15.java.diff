16a17
> import org.eclipse.core.runtime.Assert;
22a24
> import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
29a32
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
30a34
> import org.eclipse.gmf.runtime.diagram.ui.util.DiagramEditorUtil;
39d42
< import org.eclipse.jface.util.Assert;
239c242,250
<                 DiagramEditPart dgrmEP = PrintHelper.createDiagramEditPart((Diagram) obj, preferencesHint, shell);
---
>                 Diagram diagram = (Diagram)obj;
>                 DiagramEditor openedDiagramEditor = DiagramEditorUtil
> 						.findOpenedDiagramEditorForID(ViewUtil
> 								.getIdStr(diagram));
> 				DiagramEditPart dgrmEP = openedDiagramEditor == null ? PrintHelper
> 						.createDiagramEditPart(diagram, preferencesHint, shell)
> 						: openedDiagramEditor.getDiagramEditPart();
>                 
>                 boolean loadedPreferences = openedDiagramEditor != null || PrintHelper.initializePreferences(dgrmEP, preferencesHint);
247d257
<                 boolean loadedPreferences = PrintHelper.initializePreferences(dgrmEP, preferencesHint);
