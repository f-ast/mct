2c2
<  * Copyright (c) 2005 IBM Corporation and others.
---
>  * Copyright (c) 2005, 2006 IBM Corporation and others.
21d20
< import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
25a25,26
> import org.eclipse.gmf.runtime.notation.FontStyle;
> import org.eclipse.gmf.runtime.notation.LineStyle;
75,78c76,80
< 
< 		Diagram diagram = (Diagram)  NotationPackage.eINSTANCE.getDiagram().getEPackage().getEFactoryInstance().create(
< 			NotationPackage.eINSTANCE.getDiagram());
< 		diagram.getStyles().addAll(createStyles(diagram));
---
> 		Diagram diagram = NotationFactory.eINSTANCE.createDiagram();
> 		List styles = createStyles(diagram);
> 		if (styles.size() > 0) {
> 			diagram.getStyles().addAll(styles);
> 		}
146a149,152
> 		
> 		LineStyle lineStyle = (LineStyle) view
> 			.getStyle(NotationPackage.Literals.LINE_STYLE);
> 		if (lineStyle != null) {
148,150c154
< 		RGB lineRGB =
< 			PreferenceConverter.getColor(
< 				store,
---
> 			RGB lineRGB = PreferenceConverter.getColor(store,
152d155
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getLineStyle_LineColor(), FigureUtilities.RGBToInteger(lineRGB));
154,158c157,159
< 		//default font
< 		FontData fontData =
< 			PreferenceConverter.getFontData(
< 				store,
< 				IPreferenceConstants.PREF_DEFAULT_FONT);
---
> 			lineStyle.setLineColor(FigureUtilities.RGBToInteger(lineRGB)
> 				.intValue());
> 		}
160,163d160
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontName(), fontData.getName());
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontHeight(), new Integer(fontData.getHeight()));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Bold(), Boolean.valueOf((fontData.getStyle() & SWT.BOLD) != 0));
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_Italic(), Boolean.valueOf((fontData.getStyle() & SWT.ITALIC) != 0));
164a162,171
> 		FontStyle fontStyle = (FontStyle) view
> 			.getStyle(NotationPackage.Literals.FONT_STYLE);
> 		if (fontStyle != null) {
> 			// default font
> 			FontData fontData = PreferenceConverter.getFontData(store,
> 				IPreferenceConstants.PREF_DEFAULT_FONT);
> 			fontStyle.setFontName(fontData.getName());
> 			fontStyle.setFontHeight(fontData.getHeight());
> 			fontStyle.setBold((fontData.getStyle() & SWT.BOLD) != 0);
> 			fontStyle.setItalic((fontData.getStyle() & SWT.ITALIC) != 0);
166,168c173
< 		RGB fontRGB =
< 			PreferenceConverter.getColor(
< 				store,
---
> 			RGB fontRGB = PreferenceConverter.getColor(store,
170c175,177
< 		ViewUtil.setStructuralFeatureValue(view,NotationPackage.eINSTANCE.getFontStyle_FontColor(), FigureUtilities.RGBToInteger(fontRGB));
---
> 			fontStyle.setFontColor(FigureUtilities.RGBToInteger(fontRGB)
> 				.intValue());
> 		}
