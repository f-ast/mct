49c49
< 		private double minValidValue = 00.001;
---
> 		private double minValidValue = 00.009;
68a69
> 				number = convertToBase(number);
124a126,132
> 	private static final int INCHES = 0;
> 	private static final int CENTIMETERS = 1;
> 	private static final int PIXELS = 2;
> 
> 	// Conversion from inch to centimeter
> 	private static final double INCH2CM = 2.54;
> 	
164,165c172
< 			// Inches
< 			case 0:
---
> 			case INCHES:
168,169c175,176
< 			case 1: // cm
< 				pixelValue = value.doubleValue() * Display.getDefault().getDPI().x / 2.54;
---
> 			case CENTIMETERS:
> 				pixelValue = value.doubleValue() * Display.getDefault().getDPI().x / INCH2CM;
171c178
< 			case 2: // pixels
---
> 			case PIXELS:
178c185
< 			case 0:
---
> 			case INCHES:
181,182c188,189
< 			case 1:
< 				returnValue = pixelValue * 2.54 / Display.getDefault().getDPI().x;
---
> 			case CENTIMETERS:
> 				returnValue = pixelValue * INCH2CM / Display.getDefault().getDPI().x;
184c191
< 			case 2:
---
> 			case PIXELS:
191d197
< 	private void updateUnits() {
193c199,206
< 		int units = rulerUnits.getComboControl().getSelectionIndex();
---
> 	/**
> 	 * 
> 	 * converts the current units used to a base unit value to be used (e.g. in validation)
> 	 * 
> 	 * @param number Units to be converted to the base unit
> 	 * @return
> 	 */
> 	private double convertToBase(double number) {
195,199c208,219
< 		// IF no selection has been made
< 		if( units == -1 ) {
< 			// Read the preference store
< 			units = getPreferenceStore().getInt(IPreferenceConstants.PREF_RULER_UNITS);
< 			oldUnits = units;
---
> 		double returnValue = 0;
> 		switch( getUnits() ) {
> 			case INCHES:
> 				returnValue = number;
> 				break;
> 			case CENTIMETERS:
> 				returnValue = number / INCH2CM;
> 				break;
> 			case PIXELS:
> 				returnValue = number / Display.getDefault().getDPI().x;
> 		}
> 		return returnValue;
201a222,225
> 	private void updateUnits() {
> 		
> 		int units = getUnits();
> 
204c228
< 			case 0: // Inches
---
> 			case INCHES:
208c232
< 			case 1: // CM
---
> 			case CENTIMETERS:
212c236
< 			case 2: // Pixels
---
> 			case PIXELS:
220a245,256
> 	private int getUnits() {
> 		int units = rulerUnits.getComboControl().getSelectionIndex();
> 		
> 		// IF no selection has been made
> 		if( units == -1 ) {
> 			// Read the preference store
> 			units = getPreferenceStore().getInt(IPreferenceConstants.PREF_RULER_UNITS);
> 			oldUnits = units;
> 		}
> 		return units;
> 	}
> 
