24d23
< import org.eclipse.emf.ecore.EPackage;
26a26
> import org.eclipse.emf.ecore.resource.ResourceSet;
51,52c51,52
< 	public static List filterByModel(Collection eClasses, CanvasMapping canvasMapping) {
< 		return sort(getValidEClassesFrom(eClasses, canvasMapping.getDomainModel()));
---
> 	public static List filterByResourceSet(Collection eClasses, ResourceSet resourceSet) {
> 		return sort(getValidEClassesFrom(eClasses, resourceSet));
57d56
< 		CanvasMapping canvasMapping = null;
64d62
< 			canvasMapping = getMapping(nodeReference).getDiagram();
69d66
< 			canvasMapping = ((Mapping) mappingEntry.eContainer()).getDiagram();
71c68
< 		return sort(getSubtypesOf(getValidEClassesFrom(eClasses, canvasMapping != null ? canvasMapping.getDomainModel() : null), superType));
---
> 		return sort(getSubtypesOf(getValidEClassesFrom(eClasses, mappingEntry.eResource().getResourceSet()), superType));
200c197
< 	private static Collection getValidEClassesFrom(Collection eClasses, EPackage ePackage) {
---
> 	private static Collection getValidEClassesFrom(Collection eClasses, ResourceSet resourceSet) {
202,204d198
< 		if (ePackage == null) {
< 			return result;
< 		}
210,213c204
< 			EPackage eClassPackage = nextEClass.getEPackage();
< 			for (; eClassPackage != null && eClassPackage != ePackage; eClassPackage = eClassPackage.getESuperPackage()) {
< 			}
< 			if (eClassPackage == null) {
---
> 			if (nextEClass.eResource().getResourceSet() != resourceSet) {
232,238d222
< 	private static Mapping getMapping(NodeReference nodeReference) {
< 		if (nodeReference instanceof TopNodeReference) {
< 			return (Mapping) nodeReference.eContainer();
< 		}
< 		return getMapping((NodeReference) ((ChildReference) nodeReference).getParentNode().eContainer());
< 	}
< 	
