2c2
<  * Copyright (c) 2002, 2005 IBM Corporation and others.
---
>  * Copyright (c) 2002, 2006 IBM Corporation and others.
43a44
> import org.eclipse.gmf.runtime.diagram.ui.internal.figures.IExpandableFigure;
302c303,308
< 		Rectangle relBounds = figure.getBounds().getCopy();
---
> 		Rectangle relBounds = null;
>         if (figure instanceof IExpandableFigure)
>             relBounds = ((IExpandableFigure)figure).getExtendedBounds().getCopy();
>         else
>             relBounds = figure.getBounds().getCopy();
>         
562c568,572
< 			Rectangle bounds = figure.getBounds().getCopy();
---
> 			Rectangle bounds = null;
>             if (figure instanceof IExpandableFigure)
>                 bounds = ((IExpandableFigure)figure).getExtendedBounds();
>             else
>                 bounds = figure.getBounds().getCopy();
