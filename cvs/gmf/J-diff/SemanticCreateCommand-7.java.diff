63,66c63
< 		IUndoContext[] contexts = this.realSemanticCommand.getContexts();
< 		for (int i = 0; i < contexts.length; i++) {
< 			addContext(contexts[i]);
< 		}
---
> 		recomputeContexts();
86c83
< 			return CommandResult.newOKCommandResult(requestAdapter);
---
> 			result = CommandResult.newOKCommandResult(requestAdapter);
87a85,86
> 		
> 		recomputeContexts();
95c94,96
< 		return realSemanticCommand.getCommandResult();
---
> 		CommandResult result = realSemanticCommand.getCommandResult();
> 		recomputeContexts();
> 		return result;
102c103,105
< 		return realSemanticCommand.getCommandResult();
---
> 		CommandResult result = realSemanticCommand.getCommandResult();
> 		recomputeContexts();
> 		return result;
120a124,159
>     /**
>      * Propagates the contexts from my wrapped command.
>      */
>     private void recomputeContexts() {
>     	
>     	// Get my real contexts from my wrapped command
>     	IUndoContext[] realContexts = realSemanticCommand.getContexts();
>     	
>     	// Clear my contexts
>     	IUndoContext[] myContexts = getContexts();
>     	for (int i = 0; i < myContexts.length; i++) {
>     		removeContext(myContexts[i]);
>     	}
>     	
>     	// Add the contexts from my wrapped command
> 		for (int i = 0; i < realContexts.length; i++) {
> 			addContext(realContexts[i]);
> 		}
>     }
>     
>     /**
>      * Adds the context to my wrapped command.
>      */
>     public void addContext(IUndoContext context) {
>     	super.addContext(context);
>     	realSemanticCommand.addContext(context);
>     }
>     
>     /**
>      * Removes the context from my wrapped command.
>      */
>     public void removeContext(IUndoContext context) {
>     	super.removeContext(context);
>     	realSemanticCommand.removeContext(context);
>     }
> 
