2c2
<  * Copyright (c) 2005 Borland Software Corporation
---
>  * Copyright (c) 2005, 2007 Borland Software Corporation
19a20
> import java.util.LinkedList;
31d31
< import org.eclipse.emf.common.util.EMap;
175c175
< 					List nameSeq = new ArrayList<String>(Arrays.asList(typeName));
---
> 					ArrayList<String> nameSeq = new ArrayList<String>(Arrays.asList(typeName));
258c258
< 				List<EClassifier> subTypes  = getSubTypes(getRootEPackage(referencedClass.getEPackage()), referencedClass, new ArrayList<EClassifier>());
---
> 				List<EClass> subTypes  = getSubTypes(getRootEPackage(referencedClass.getEPackage()), referencedClass, new LinkedList<EClass>());
261,262c261,262
< 				for (Iterator it = subTypes.iterator(); it.hasNext();) {
< 					EClass nextClass = (EClass) it.next();
---
> 				for (Iterator<EClass> it = subTypes.iterator(); it.hasNext();) {
> 					EClass nextClass = it.next();
271,272c271,272
< 				for (Iterator it = subTypes.iterator(); it.hasNext();) {
< 					EClass nextClass = (EClass) it.next();
---
> 				for (Iterator<EClass> it = subTypes.iterator(); it.hasNext();) {
> 					EClass nextClass = it.next();
315,316c315,316
< 				for(Iterator it = contextProviderEClass.getESuperTypes().iterator(); it.hasNext();) {
< 					ContextProvider nextProvider = referencedContexts.get(it.next());
---
> 				for (EClass nextClass : contextProviderEClass.getESuperTypes()) {
> 					ContextProvider nextProvider = referencedContexts.get(nextClass);
431c431
< 		List children = diagnostic.getChildren();
---
> 		List<Diagnostic> children = diagnostic.getChildren();
435,436c435,436
< 			for (Iterator it = children.iterator(); it.hasNext();) {
< 				mergeAndFlatten((Diagnostic) it.next(), diagnosticChain);
---
> 			for (Diagnostic next : children) {
> 				mergeAndFlatten(next, diagnosticChain);
494c494
< 			Class rightClass = right.getInstanceClass();
---
> 			Class<?> rightClass = right.getInstanceClass();
519,520c519
< 		for (Iterator it = eModelElement.getEAnnotations().iterator(); it.hasNext();) {
< 			EAnnotation nextAnnotation = (EAnnotation) it.next();
---
> 		for (EAnnotation nextAnnotation : eModelElement.getEAnnotations()) {
528,530c527,528
< 	public static Map.Entry findAnnotationDetailEntry(EModelElement eModelElement, String sourceURI, String key, String val) {
< 		for (Iterator it = eModelElement.getEAnnotations().iterator(); it.hasNext();) {
< 			EAnnotation nextAnnotation = (EAnnotation) it.next();
---
> 	public static Map.Entry<String, String> findAnnotationDetailEntry(EModelElement eModelElement, String sourceURI, String key, String val) {
> 		for (EAnnotation nextAnnotation : eModelElement.getEAnnotations()) {
532,533c530
< 				for (Iterator entryIt = nextAnnotation.getDetails().iterator(); entryIt.hasNext();) {
< 					Map.Entry nextEntry = (Map.Entry)entryIt.next();
---
> 				for (Map.Entry<String, String> nextEntry  : nextAnnotation.getDetails()) {
544,547c541,543
< 	public static Map.Entry getKeyPreffixAnnotation(EAnnotation annotation, String keyPrefix) {
< 		for (Iterator it = annotation.getDetails().entrySet().iterator(); it.hasNext();) {
< 			Map.Entry nextEntry = (Map.Entry)it.next();
< 			if(((String)nextEntry.getKey()).startsWith(keyPrefix)) {
---
> 	public static Map.Entry<String, String> getKeyPrefixAnnotation(EAnnotation annotation, String keyPrefix) {
> 		for (Map.Entry<String, String> nextEntry : annotation.getDetails()) {
> 			if(nextEntry.getKey().startsWith(keyPrefix)) {
554,558c550,552
< 	@SuppressWarnings("unchecked")
< 	public static List getAnnotationsWithKeyAndValue(EModelElement eModelElement, String sourceURI, String key, String value) {
< 		List annotations = null;
< 		for (Iterator it = eModelElement.getEAnnotations().iterator(); it.hasNext();) {
< 			EAnnotation nextAnnotation = (EAnnotation) it.next();
---
> 	public static List<EAnnotation> getAnnotationsWithKeyAndValue(EModelElement eModelElement, String sourceURI, String key, String value) {
> 		ArrayList<EAnnotation> annotations = null;
> 		for (EAnnotation nextAnnotation : eModelElement.getEAnnotations()) {
563c557
< 						annotations = new ArrayList(eModelElement.getEAnnotations().size());
---
> 						annotations = new ArrayList<EAnnotation>(eModelElement.getEAnnotations().size());
569c563,566
< 		return annotations != null ? annotations : Collections.EMPTY_LIST;
---
> 		if (annotations != null) {
> 			return annotations;
> 		}
> 		return Collections.emptyList();
608,620d604
< 	/**
< 	 * @return String value associated with the given key in given detail map or
< 	 * <code>null</code> if not key is present in the value
< 	 */
< 	public static String getAnnotationDetailValue(EMap detail, String key) {
< 		if(detail == null || key == null) {
< 			throw new IllegalArgumentException("null detail map or key"); //$NON-NLS-1$
< 		}
< 		Object val = detail.get(key);
< 		return val instanceof String ? (String) val : null;
< 	}
< 	
< 	
628,631c612,614
< 			for (Iterator it = ctxAnnotation.getDetails().entrySet().iterator(); it.hasNext();) {
< 				Map.Entry nextDetail = (Map.Entry) it.next();
< 				Object key = nextDetail.getKey();
< 				String value = nextDetail.getValue() instanceof String ? (String) nextDetail.getValue() : ""; //$NON-NLS-1$
---
> 			for (Map.Entry<String, String> nextDetail : ctxAnnotation.getDetails()) {
> 				String key = nextDetail.getKey();
> 				String value = nextDetail.getValue() != null ? nextDetail.getValue() : ""; //$NON-NLS-1$
667,669c650,651
< 	static List<EClassifier> getSubTypes(EPackage ePackage, EClass superType, List<EClassifier> foundSubTypes) {
< 		for (Iterator it = ePackage.getEClassifiers().iterator(); it.hasNext();) {
< 			EClassifier classifier = (EClassifier) it.next();
---
> 	static List<EClass> getSubTypes(EPackage ePackage, EClass superType, List<EClass> foundSubTypes) {
> 		for (EClassifier classifier : ePackage.getEClassifiers()) {
671c653
< 				foundSubTypes.add(classifier);
---
> 				foundSubTypes.add((EClass) classifier);
674,675c656,657
< 		for (Iterator it = ePackage.getESubpackages().iterator(); it.hasNext();) {
< 			getSubTypes((EPackage) it.next(), superType, foundSubTypes);			
---
> 		for (EPackage next : ePackage.getESubpackages()) {
> 			getSubTypes(next, superType, foundSubTypes);			
