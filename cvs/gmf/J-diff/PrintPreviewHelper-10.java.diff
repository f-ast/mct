121,130d120
< 	 * Total number of rows taken required for the diagram
< 	 */
< 	protected int totalNumberOfRows = -1;
< 
< 	/**
< 	 * Total number of columns required for the diagram
< 	 */
< 	protected int totalNumberOfColumns = -1;
< 
< 	/**
352,354d341
< 		totalNumberOfRows = -1;
< 		totalNumberOfColumns = -1;
< 		
368a356,363
> 		
>         //check for rtl orientation...
>         int style = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell().getStyle();
>         if ((style & SWT.MIRRORED) != 0) {
>             shell = new Shell(display, SWT.APPLICATION_MODAL | SWT.TITLE
>                 | SWT.CLOSE | SWT.BORDER | SWT.RIGHT_TO_LEFT);
>         }
>         else
371a367,368
> 		
> 
512a510,516
>         if ((style & SWT.MIRRORED) != 0) {
>             //switch left and right for RTL...
>             leftTool.setToolTipText(DiagramUIPrintingMessages.PrintPreview_RightToolItem);
>             leftTool.setImage(rightImage);
>             leftTool.setDisabledImage(disabledRightImage);
>         }
>         else { 
515a520,521
>         }
> 		
538a545,551
>         if ((style & SWT.MIRRORED) != 0) {
>             //switch left and right for RTL
>             rightTool.setToolTipText(DiagramUIPrintingMessages.PrintPreview_LeftToolItem);
>             rightTool.setImage(leftImage);
>             rightTool.setDisabledImage(disabledLeftImage);
>         }
>         else { 
541a555,556
>         }
> 		
712d726
< 		if (totalNumberOfRows < 0) {
715,719c729,730
< 					.getPageSize(getPreferenceStore(), false, getMapMode()).y;
< 			totalNumberOfRows = Math.max(1, (int) Math.ceil(numRows));
< 		}
< 
< 		return totalNumberOfRows;
---
> 				.getPageSize(getPreferenceStore(), true, getMapMode()).y;
> 		return Math.max(1, (int) Math.ceil(numRows));
819d829
< 		if (totalNumberOfColumns < 0) {
822,826c832,833
< 					.getPageSize(getPreferenceStore(), false, getMapMode()).x;
< 			totalNumberOfColumns = Math.max(1, (int) Math.ceil(numCols));
< 		}
< 
< 		return totalNumberOfColumns;
---
> 				.getPageSize(getPreferenceStore(), true, getMapMode()).x;
> 		return Math.max(1, (int) Math.ceil(numCols));
1024c1031,1038
< 		GC gc = new GC(image);
---
>         GC gc = null;
>         
>         //check for rtl orientation...
>         if ((shell.getStyle() & SWT.MIRRORED) != 0) {
>             gc = new GC(image, SWT.RIGHT_TO_LEFT);
>         }
>         else
>             gc = new GC(image);
