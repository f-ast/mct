35a36
> import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
39a41
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditor;
43a46
> import org.eclipse.gmf.runtime.diagram.ui.util.DiagramEditorUtil;
111d113
<         Shell shell = new Shell();
113a116,123
>         DiagramEditor openedDiagramEditor = DiagramEditorUtil.findOpenedDiagramEditorForID(ViewUtil.getIdStr(diagram));
>         if (openedDiagramEditor != null) {
>             DiagramGenerator generator = copyToImage(openedDiagramEditor.getDiagramEditPart(),
>                     destination, format, monitor);
>                 partInfo = generator.getDiagramPartInfo(openedDiagramEditor.getDiagramEditPart());
>         } else {
> 	
> 	        Shell shell = new Shell();
123a134
>         }
