2a3
> import java.text.ParseException;
177,178c178
< 				IPreferenceStore preferenceStore =
< 					(IPreferenceStore) ((DiagramEditor) getPart()).getDiagramEditPart().getDiagramPreferencesHint().getPreferenceStore();
---
>                 IPreferenceStore preferenceStore = getPreferenceStore();
214a215,220
>      private IPreferenceStore getPreferenceStore() {
>         IPreferenceStore preferenceStore =
>             (IPreferenceStore) ((DiagramEditor) getPart()).getDiagramEditPart().getDiagramPreferencesHint().getPreferenceStore();
>         return preferenceStore;
>     }
> 
295a302,313
>     private Double convertStringToDouble(String strValue){
>         NumberFormat numberFormatter = NumberFormat.getInstance();
>         Double value;
>         try {
>             value = forceDouble(numberFormatter.parse(strValue));
>         } catch (ParseException e) {
>             // default value
>             value = new Double(getPreferenceStore().getDouble(IPreferenceConstants.PREF_GRID_SPACING));
>         }
>         return value;
>     }   
>     
330,331c348
< 				//textWidget.setText(currentUnits);
< 				setWorkspaceProperty(WorkspaceViewerProperties.GRIDSPACING, new Double(currentUnits).doubleValue());
---
>                 setWorkspaceProperty(WorkspaceViewerProperties.GRIDSPACING, convertStringToDouble(currentUnits).doubleValue());
360d376
< 		
365,366c381
< 		
< 		Double value = new Double(valueStr);
---
>         Double value = convertStringToDouble(valueStr);
368d382
< 
441c455,457
< 			textWidget.setText(getWorkspaceProperty(WorkspaceViewerProperties.GRIDSPACING));
---
>             double value = getWorkspacePropertyDouble(WorkspaceViewerProperties.GRIDSPACING);
>             NumberFormat numberFormater = NumberFormat.getInstance();
>             textWidget.setText(numberFormater.format(value));
482,483c498,500
< 		
< 		textWidget.setText(getWorkspaceProperty(WorkspaceViewerProperties.GRIDSPACING));
---
>         double value = getWorkspacePropertyDouble(WorkspaceViewerProperties.GRIDSPACING);
>         NumberFormat numberFormatter = NumberFormat.getNumberInstance();
>         textWidget.setText(numberFormatter.format(value));
655a673,676
>     private double getWorkspacePropertyDouble(String property) {
>         return getWorkspaceViewerProperties().getDouble(property);
>     }
>     
702c723,724
< 				textWidget.setText(getEventString(event));
---
>                 Double value = new Double(getEventString(event));
>                 textWidget.setText(NumberFormat.getInstance().format(value));
748a771,783
>     /**
>      * The NumberFormatter.parse() could return a Long or Double
>      * We are storing all values related to the page setup as doubles
>      * so we call this function when ever we are getting values from
>      * the dialog.
>      * @param number
>      * @return
>      */
>     private Double forceDouble(Number number) {
>         if (!(number instanceof Double))
>             return new Double(number.doubleValue());            
>         return (Double) number;
>     }
