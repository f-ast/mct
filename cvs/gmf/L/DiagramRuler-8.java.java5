package org.eclipse.gmf.runtime.diagram.ui.internal.ruler;

import java.util.List;

import org.eclipse.gef.rulers.RulerProvider;

import org.eclipse.gmf.runtime.diagram.core.listener.NotificationListener;

import org.eclipse.gmf.runtime.diagram.core.listener.DiagramEventBroker;

import org.eclipse.gmf.runtime.notation.Guide;

import org.eclipse.gmf.runtime.notation.GuideStyle;

public class DiagramRuler {
    private int unit;
    private boolean horizontal;
    private GuideStyle guideStyle;

    public DiagramRuler (boolean isHorizontal, GuideStyle style) {
        this (isHorizontal, RulerProvider.UNIT_INCHES, style);
    }

    public DiagramRuler (boolean isHorizontal, int unit, GuideStyle style) {
        horizontal = isHorizontal;
        setUnit (unit);
        guideStyle = style;
    }

    private GuideStyle getGuideStyle () {
        return guideStyle;
    }

    public List getGuides () {
        if (! isHorizontal ()) return getGuideStyle ().getHorizontalGuides ();

        return getGuideStyle ().getVerticalGuides ();
    }

    public boolean isHorizontal () {
        return horizontal;
    }

    public int getUnit () {
        return unit;
    }

    public void setUnit (int newUnit) {
        if (unit != newUnit) {
            unit = newUnit;
        }
    }

    public void addGuide (Guide toAdd) {
        if (! isHorizontal ()) {
            guideStyle.getHorizontalGuides ().add (toAdd);
        } else {
            guideStyle.getVerticalGuides ().add (toAdd);
        }
    }

    public void addNotificationListener (NotificationListener listener) {
        DiagramEventBroker.getInstance ().addNotificationListener (getGuideStyle (), listener);
    }

    public void removeNotificationListener (NotificationListener listener) {
        DiagramEventBroker.getInstance ().removeNotificationListener (getGuideStyle (), listener);
    }

    public void setGuideStyle (GuideStyle guideStyle) {
        this.guideStyle = guideStyle;
    }

}

