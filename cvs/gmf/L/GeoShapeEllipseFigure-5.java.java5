package org.eclipse.gmf.runtime.diagram.ui.geoshapes.internal.draw2d.figures;

import org.eclipse.draw2d.ConnectionAnchor;

import org.eclipse.draw2d.Graphics;

import org.eclipse.draw2d.geometry.PrecisionPoint;

import org.eclipse.draw2d.geometry.Rectangle;

import org.eclipse.gmf.runtime.draw2d.ui.figures.IOvalAnchorableFigure;

import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapModeUtil;

import org.eclipse.gmf.runtime.gef.ui.figures.SlidableOvalAnchor;

public class GeoShapeEllipseFigure extends GeoShapeFigure implements IOvalAnchorableFigure {

    public GeoShapeEllipseFigure (int width, int height, int spacing) {
        super (width, height, spacing);
    }

    protected void paintFigure (Graphics g) {
        Rectangle r = getOvalBounds ().getCopy ();
        g.fillOval (r);
        g.setLineStyle (getLineStyle ());
        g.setLineWidth (getLineWidth ());
        r.width --;
        r.height --;
        if (getLineWidth () > 1) {
            r.shrink ((getLineWidth () - 1) / 2, (getLineWidth () - 1) / 2);
        }
        g.drawOval (r);
    }

    public Rectangle getOvalBounds () {
        Rectangle r = getBounds ();
        Rectangle ovalRect = new Rectangle (r);
        ovalRect.setSize (r.width - 1, r.height - 1);
        return ovalRect;
    }

    protected ConnectionAnchor createAnchor (PrecisionPoint p) {
        if (p == null) return createDefaultAnchor ();

        return new SlidableOvalAnchor (this, p);
    }

    protected ConnectionAnchor createDefaultAnchor () {
        return new SlidableOvalAnchor (this);
    }

}

