package org.eclipse.gmf.internal.xpand.ast;

import java.text.MessageFormat;

import java.util.Set;

import org.eclipse.gmf.internal.xpand.expression.AnalysationIssue;

import org.eclipse.gmf.internal.xpand.expression.ast.Expression;

import org.eclipse.gmf.internal.xpand.model.XpandExecutionContext;

public class ErrorStatement extends Statement {
    private final Expression message;

    public ErrorStatement (final int start, final int end, final int line, final Expression msg) {
        super (start, end, line);
        message = msg;
    }

    public Expression getMessage () {
        return message;
    }

    public void analyze (final XpandExecutionContext ctx, final Set < AnalysationIssue > issues) {
        message.analyze (ctx, issues);
    }

    @Override
    public void evaluateInternal (final XpandExecutionContext ctx) {
        String result = String.valueOf (message.evaluate (ctx));
        System.err.println ("ERROR:" + result);
        throw new RuntimeException (MessageFormat.format ("Error in {0}:{1}: ", getFileName (), getLine (), result));
    }

}

