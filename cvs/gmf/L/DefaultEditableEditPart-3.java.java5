package org.eclipse.gmf.runtime.diagram.ui.internal.editparts;

import java.util.List;

import org.eclipse.gef.GraphicalEditPart;

import org.eclipse.jface.util.Assert;

public class DefaultEditableEditPart implements IEditableEditPart {
    private final GraphicalEditPart editPart;
    private boolean isEditable = true;

    public DefaultEditableEditPart (GraphicalEditPart editPart) {
        super ();
        Assert.isNotNull (editPart);
        this.editPart = editPart;
    }

    public boolean isEditModeEnabled () {
        return this.isEditable;
    }

    public void disableEditMode () {
        if (! isEditModeEnabled ()) {
            return;
        }
        List l = getGraphicalEditPart ().getSourceConnections ();
        for (int i = 0;
        i < l.size (); i ++) {
            Object obj = l.get (i);
            if (obj instanceof IEditableEditPart) {
                ((IEditableEditPart) obj).disableEditMode ();
            }
        }
        List c = getGraphicalEditPart ().getChildren ();
        for (int i = 0;
        i < c.size (); i ++) {
            Object obj = c.get (i);
            if (obj instanceof IEditableEditPart) {
                ((IEditableEditPart) obj).disableEditMode ();
            }
        }
        this.isEditable = false;
    }

    public void enableEditMode () {
        if (isEditModeEnabled ()) {
            return;
        }
        this.isEditable = true;
        List c = getGraphicalEditPart ().getChildren ();
        for (int i = 0;
        i < c.size (); i ++) {
            Object obj = c.get (i);
            if (obj instanceof IEditableEditPart) {
                ((IEditableEditPart) obj).enableEditMode ();
            }
        }
        List l = getGraphicalEditPart ().getSourceConnections ();
        for (int i = 0;
        i < l.size (); i ++) {
            Object obj = l.get (i);
            if (obj instanceof IEditableEditPart) {
                ((IEditableEditPart) obj).enableEditMode ();
            }
        }
    }

    private GraphicalEditPart getGraphicalEditPart () {
        return this.editPart;
    }

}

