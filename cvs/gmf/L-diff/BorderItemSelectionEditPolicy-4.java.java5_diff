4a5,6
> import org.eclipse.draw2d.geometry.Dimension;
> 
25c27
< import org.eclipse.gmf.runtime.diagram.ui.editparts.BorderItemEditPart;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IBorderItemEditPart;
27c29
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure;
---
> import org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart;
29c31
< import org.eclipse.gmf.runtime.diagram.ui.figures.BorderItemFigure.BorderItemLocator;
---
> import org.eclipse.gmf.runtime.diagram.ui.figures.IBorderItemLocator;
52,53c54,56
<         BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost ();
<         BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP.getLocator ();
---
>         IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost ();
>         IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator ();
>         if (borderItemLocator != null) {
60c63
<         Rectangle realLocation = borderItemLocator.locateOnBorder (rect.getCopy ());
---
>             Rectangle realLocation = borderItemLocator.getValidLocation (rect.getCopy (), borderItemEP.getFigure ());
64a68
>     }
67,68c71,73
<         BorderItemEditPart borderItemEP = (BorderItemEditPart) getHost ();
<         BorderItemLocator borderItemLocator = (BorderItemFigure.BorderItemLocator) borderItemEP.getLocator ();
---
>         IBorderItemEditPart borderItemEP = (IBorderItemEditPart) getHost ();
>         IBorderItemLocator borderItemLocator = borderItemEP.getBorderItemLocator ();
>         if (borderItemLocator != null) {
74,75c79,82
<         Rectangle realLocation = borderItemLocator.locateOnBorder (rect.getCopy ());
<         Point location = borderItemLocator.getRelativeToBorder (realLocation.getTopLeft ());
---
>             Rectangle realLocation = borderItemLocator.getValidLocation (rect.getCopy (), borderItemEP.getFigure ());
>             Point parentOrigin = ((IGraphicalEditPart) borderItemEP.getParent ()).getFigure ().getBounds ().getTopLeft ();
>             Dimension d = realLocation.getTopLeft ().getDifference (parentOrigin);
>             Point location = new Point (d.width, d.height);
78a86,87
>         return null;
>     }
