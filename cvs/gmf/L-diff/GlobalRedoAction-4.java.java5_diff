48d47
<         if (context != null) {
51a51
>             delegate = null;
53c53,57
<             delegate = new RedoActionHandler (getWorkbenchPart ().getSite (), context);
---
>         if (context != null) {
>             IWorkbenchPart part = getWorkbenchPart ();
>             if (part != null) {
>                 delegate = new RedoActionHandler (part.getSite (), context);
>                 delegate.setPruneHistory (true);
54a59,60
>             }
>         }
58d63
<     }
158,160c163,165
<     public final void setUndoContext (IUndoContext undoContext) {
<         this.undoContext = undoContext;
<         initializeWithContext (undoContext);
---
>     public final void setUndoContext (IUndoContext context) {
>         this.undoContext = context;
>         initializeWithContext (context);
176a182,190
>     public void dispose () {
>         if (delegate != null) {
>             delegate.removePropertyChangeListener (getDelegateListener ());
>             delegate.dispose ();
>             delegate = null;
>         }
>         super.dispose ();
>     }
> 
