30a31,32
> import org.eclipse.draw2d.ConnectionLayer;
> 
668c670
<         ConnectionLayerEx cLayer = (ConnectionLayerEx) getLayer (LayerConstants.CONNECTION_LAYER);
---
>         ConnectionLayer cLayer = (ConnectionLayer) getLayer (LayerConstants.CONNECTION_LAYER);
670c672,673
<         if (style != null) {
---
>         if (style != null && cLayer instanceof ConnectionLayerEx) {
>             ConnectionLayerEx cLayerEx = (ConnectionLayerEx) cLayer;
673c676
<                 getConnectionFigure ().setConnectionRouter (cLayer.getObliqueRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getObliqueRouter ());
675c678
<                 getConnectionFigure ().setConnectionRouter (cLayer.getRectilinearRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getRectilinearRouter ());
677c680
<                 getConnectionFigure ().setConnectionRouter (cLayer.getTreeRouter ());
---
>                 getConnectionFigure ().setConnectionRouter (cLayerEx.getTreeRouter ());
