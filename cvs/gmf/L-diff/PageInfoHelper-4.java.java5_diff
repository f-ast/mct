21,30d20
< import org.eclipse.jface.preference.IPreferenceStore;
< 
< import org.eclipse.swt.SWT;
< 
< import org.eclipse.swt.SWTError;
< 
< import org.eclipse.swt.printing.Printer;
< 
< import org.eclipse.swt.widgets.Display;
< 
45c35,45
< import org.eclipse.gmf.runtime.draw2d.ui.mapmode.MapMode;
---
> import org.eclipse.gmf.runtime.draw2d.ui.mapmode.IMapMode;
> 
> import org.eclipse.jface.preference.IPreferenceStore;
> 
> import org.eclipse.swt.SWT;
> 
> import org.eclipse.swt.SWTError;
> 
> import org.eclipse.swt.printing.Printer;
> 
> import org.eclipse.swt.widgets.Display;
89,90c89,90
<     public static Point getPageSize (IPreferenceStore store) {
<         return getPageSize (store, true);
---
>     public static Point getPageSize (IPreferenceStore store, IMapMode mm) {
>         return getPageSize (store, true, mm);
93c93
<     public static Point getPageSize (IPreferenceStore store, boolean subtractMargins) {
---
>     public static Point getPageSize (IPreferenceStore store, boolean subtractMargins, IMapMode mm) {
114,115c114,115
<         paperSize [0] = MapMode.DPtoLP ((int) (width * displayDPI.x));
<         paperSize [1] = MapMode.DPtoLP ((int) (height * displayDPI.y));
---
>         paperSize [0] = mm.DPtoLP ((int) (width * displayDPI.x));
>         paperSize [1] = mm.DPtoLP ((int) (height * displayDPI.y));
185c185
<     public static PageMargins getPageMargins (IPreferenceStore preferenceStore) {
---
>     public static PageMargins getPageMargins (IPreferenceStore preferenceStore, IMapMode mm) {
189,192c189,192
<         margins.left = MapMode.DPtoLP ((int) (displayDPI.x * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_LEFT)));
<         margins.right = MapMode.DPtoLP ((int) (displayDPI.x * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_RIGHT)));
<         margins.top = MapMode.DPtoLP ((int) (displayDPI.y * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_TOP)));
<         margins.bottom = MapMode.DPtoLP ((int) (displayDPI.y * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_BOTTOM)));
---
>         margins.left = mm.DPtoLP ((int) (displayDPI.x * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_LEFT)));
>         margins.right = mm.DPtoLP ((int) (displayDPI.x * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_RIGHT)));
>         margins.top = mm.DPtoLP ((int) (displayDPI.y * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_TOP)));
>         margins.bottom = mm.DPtoLP ((int) (displayDPI.y * preferenceStore.getDouble (WorkspaceViewerProperties.PREF_MARGIN_BOTTOM)));
