5,6d4
< import org.eclipse.emf.common.notify.NotificationChain;
< 
13,16d10
< import org.eclipse.emf.ecore.impl.EObjectImpl;
< 
< import org.eclipse.gmf.gmfgraph.Figure;
< 
21,23c15
< import org.eclipse.gmf.gmfgraph.Layout;
< 
< import org.eclipse.gmf.gmfgraph.LayoutData;
---
> import org.eclipse.gmf.gmfgraph.RealFigure;
25,28c17,18
< public class FigureRefImpl extends EObjectImpl implements FigureRef {
<     protected LayoutData layoutData = null;
<     protected Layout layout = null;
<     protected Figure figure = null;
---
> public class FigureRefImpl extends AbstractFigureImpl implements FigureRef {
>     protected RealFigure figure;
39,105c29
<     public LayoutData getLayoutData () {
<         return layoutData;
<     }
< 
<     public NotificationChain basicSetLayoutData (LayoutData newLayoutData, NotificationChain msgs) {
<         LayoutData oldLayoutData = layoutData;
<         layoutData = newLayoutData;
<         if (eNotificationRequired ()) {
<             ENotificationImpl notification = new ENotificationImpl (this, Notification.SET, GMFGraphPackage.FIGURE_REF__LAYOUT_DATA, oldLayoutData, newLayoutData);
<             if (msgs == null) msgs = notification;
<             else msgs.add (notification);
< 
<         }
<         return msgs;
<     }
< 
<     public void setLayoutData (LayoutData newLayoutData) {
<         if (newLayoutData != layoutData) {
<             NotificationChain msgs = null;
<             if (layoutData != null) msgs = ((InternalEObject) layoutData).eInverseRemove (this, GMFGraphPackage.LAYOUT_DATA__OWNER, LayoutData.class, msgs);
< 
<             if (newLayoutData != null) msgs = ((InternalEObject) newLayoutData).eInverseAdd (this, GMFGraphPackage.LAYOUT_DATA__OWNER, LayoutData.class, msgs);
< 
<             msgs = basicSetLayoutData (newLayoutData, msgs);
<             if (msgs != null) msgs.dispatch ();
< 
<         } else if (eNotificationRequired ()) eNotify (new ENotificationImpl (this, Notification.SET, GMFGraphPackage.FIGURE_REF__LAYOUT_DATA, newLayoutData, newLayoutData));
< 
<     }
< 
<     public Layout getLayout () {
<         return layout;
<     }
< 
<     public NotificationChain basicSetLayout (Layout newLayout, NotificationChain msgs) {
<         Layout oldLayout = layout;
<         layout = newLayout;
<         if (eNotificationRequired ()) {
<             ENotificationImpl notification = new ENotificationImpl (this, Notification.SET, GMFGraphPackage.FIGURE_REF__LAYOUT, oldLayout, newLayout);
<             if (msgs == null) msgs = notification;
<             else msgs.add (notification);
< 
<         }
<         return msgs;
<     }
< 
<     public void setLayout (Layout newLayout) {
<         if (newLayout != layout) {
<             NotificationChain msgs = null;
<             if (layout != null) msgs = ((InternalEObject) layout).eInverseRemove (this, EOPPOSITE_FEATURE_BASE - GMFGraphPackage.FIGURE_REF__LAYOUT, null, msgs);
< 
<             if (newLayout != null) msgs = ((InternalEObject) newLayout).eInverseAdd (this, EOPPOSITE_FEATURE_BASE - GMFGraphPackage.FIGURE_REF__LAYOUT, null, msgs);
< 
<             msgs = basicSetLayout (newLayout, msgs);
<             if (msgs != null) msgs.dispatch ();
< 
<         } else if (eNotificationRequired ()) eNotify (new ENotificationImpl (this, Notification.SET, GMFGraphPackage.FIGURE_REF__LAYOUT, newLayout, newLayout));
< 
<     }
< 
<     public Figure getParent () {
<         if (eContainerFeatureID != GMFGraphPackage.FIGURE_REF__PARENT) return null;
< 
<         return (Figure) eContainer ();
<     }
< 
<     public Figure getFigure () {
---
>     public RealFigure getFigure () {
108c32
<             figure = (Figure) eResolveProxy (oldFigure);
---
>             figure = (RealFigure) eResolveProxy (oldFigure);
117c41
<     public Figure basicGetFigure () {
---
>     public RealFigure basicGetFigure () {
121,122c45,46
<     public void setFigure (Figure newFigure) {
<         Figure oldFigure = figure;
---
>     public void setFigure (RealFigure newFigure) {
>         RealFigure oldFigure = figure;
129,165d52
<     public NotificationChain eInverseAdd (InternalEObject otherEnd, int featureID, NotificationChain msgs) {
<         switch (featureID) {
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 if (layoutData != null) msgs = ((InternalEObject) layoutData).eInverseRemove (this, EOPPOSITE_FEATURE_BASE - GMFGraphPackage.FIGURE_REF__LAYOUT_DATA, null, msgs);
< 
<                 return basicSetLayoutData ((LayoutData) otherEnd, msgs);
<             case GMFGraphPackage.FIGURE_REF__PARENT :
<                 if (eInternalContainer () != null) msgs = eBasicRemoveFromContainer (msgs);
< 
<                 return eBasicSetContainer (otherEnd, GMFGraphPackage.FIGURE_REF__PARENT, msgs);
<         }
<         return super.eInverseAdd (otherEnd, featureID, msgs);
<     }
< 
<     @Override
<     public NotificationChain eInverseRemove (InternalEObject otherEnd, int featureID, NotificationChain msgs) {
<         switch (featureID) {
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 return basicSetLayoutData (null, msgs);
<             case GMFGraphPackage.FIGURE_REF__LAYOUT :
<                 return basicSetLayout (null, msgs);
<             case GMFGraphPackage.FIGURE_REF__PARENT :
<                 return eBasicSetContainer (null, GMFGraphPackage.FIGURE_REF__PARENT, msgs);
<         }
<         return super.eInverseRemove (otherEnd, featureID, msgs);
<     }
< 
<     @Override
<     public NotificationChain eBasicRemoveFromContainerFeature (NotificationChain msgs) {
<         switch (eContainerFeatureID) {
<             case GMFGraphPackage.FIGURE_REF__PARENT :
<                 return eInternalContainer ().eInverseRemove (this, GMFGraphPackage.FIGURE__CHILDREN, Figure.class, msgs);
<         }
<         return super.eBasicRemoveFromContainerFeature (msgs);
<     }
< 
<     @Override
168,173d54
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 return getLayoutData ();
<             case GMFGraphPackage.FIGURE_REF__LAYOUT :
<                 return getLayout ();
<             case GMFGraphPackage.FIGURE_REF__PARENT :
<                 return getParent ();
181a63
>     @SuppressWarnings("unchecked")
185,190d66
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 setLayoutData ((LayoutData) newValue);
<                 return;
<             case GMFGraphPackage.FIGURE_REF__LAYOUT :
<                 setLayout ((Layout) newValue);
<                 return;
192c68
<                 setFigure ((Figure) newValue);
---
>                 setFigure ((RealFigure) newValue);
201,206d76
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 setLayoutData ((LayoutData) null);
<                 return;
<             case GMFGraphPackage.FIGURE_REF__LAYOUT :
<                 setLayout ((Layout) null);
<                 return;
208c78
<                 setFigure ((Figure) null);
---
>                 setFigure ((RealFigure) null);
217,222d86
<             case GMFGraphPackage.FIGURE_REF__LAYOUT_DATA :
<                 return layoutData != null;
<             case GMFGraphPackage.FIGURE_REF__LAYOUT :
<                 return layout != null;
<             case GMFGraphPackage.FIGURE_REF__PARENT :
<                 return getParent () != null;
