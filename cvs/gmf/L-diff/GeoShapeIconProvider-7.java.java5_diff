25,53c25,36
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_OVAL, DiagramUIGeoshapesPluginImages.DESC_OVAL);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_TRIANGLE, DiagramUIGeoshapesPluginImages.DESC_TRIANGLE);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_RECTANGLE, DiagramUIGeoshapesPluginImages.DESC_RECTANGLE);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_SHADOWRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_SHADOWRECTANGLE);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_3DRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_3DRECTANGLE);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_ROUNDRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_ROUNDRECTANGLE);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_HEXAGON, DiagramUIGeoshapesPluginImages.DESC_HEXAGON);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_OCTAGON, DiagramUIGeoshapesPluginImages.DESC_OCTAGON);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_PENTAGON, DiagramUIGeoshapesPluginImages.DESC_PENTAGON);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_DIAMOND, DiagramUIGeoshapesPluginImages.DESC_DIAMOND);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_CYLINDER, DiagramUIGeoshapesPluginImages.DESC_CYLINDER);
<         semanticHintIconMap.put (GeoshapeConstants.TOOL_LINE, DiagramUIGeoshapesPluginImages.DESC_LINE);
<     }
< 
<     private static HashMap typeIconMap = new HashMap ();
< 
<     static {
<         typeIconMap.put (GeoshapeType.OVAL, DiagramUIGeoshapesPluginImages.DESC_OVAL);
<         typeIconMap.put (GeoshapeType.TRIANGLE, DiagramUIGeoshapesPluginImages.DESC_TRIANGLE);
<         typeIconMap.put (GeoshapeType.RECTANGLE, DiagramUIGeoshapesPluginImages.DESC_RECTANGLE);
<         typeIconMap.put (GeoshapeType.SHADOWRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_SHADOWRECTANGLE);
<         typeIconMap.put (GeoshapeType.THREEDRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_3DRECTANGLE);
<         typeIconMap.put (GeoshapeType.ROUNDRECTANGLE, DiagramUIGeoshapesPluginImages.DESC_ROUNDRECTANGLE);
<         typeIconMap.put (GeoshapeType.HEXAGON, DiagramUIGeoshapesPluginImages.DESC_HEXAGON);
<         typeIconMap.put (GeoshapeType.OCTAGON, DiagramUIGeoshapesPluginImages.DESC_OCTAGON);
<         typeIconMap.put (GeoshapeType.PENTAGON, DiagramUIGeoshapesPluginImages.DESC_PENTAGON);
<         typeIconMap.put (GeoshapeType.DIAMOND, DiagramUIGeoshapesPluginImages.DESC_DIAMOND);
<         typeIconMap.put (GeoshapeType.CYLINDER, DiagramUIGeoshapesPluginImages.DESC_CYLINDER);
<         typeIconMap.put (GeoshapeType.LINE, DiagramUIGeoshapesPluginImages.DESC_LINE);
---
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_OVAL, DiagramUIGeoshapesPluginImages.IMG_OVAL);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_TRIANGLE, DiagramUIGeoshapesPluginImages.IMG_TRIANGLE);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_RECTANGLE, DiagramUIGeoshapesPluginImages.IMG_RECTANGLE);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_SHADOWRECTANGLE, DiagramUIGeoshapesPluginImages.IMG_SHADOWRECTANGLE);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_3DRECTANGLE, DiagramUIGeoshapesPluginImages.IMG_3DRECTANGLE);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_ROUNDRECTANGLE, DiagramUIGeoshapesPluginImages.IMG_ROUNDRECTANGLE);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_HEXAGON, DiagramUIGeoshapesPluginImages.IMG_HEXAGON);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_OCTAGON, DiagramUIGeoshapesPluginImages.IMG_OCTAGON);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_PENTAGON, DiagramUIGeoshapesPluginImages.IMG_PENTAGON);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_DIAMOND, DiagramUIGeoshapesPluginImages.IMG_DIAMOND);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_CYLINDER, DiagramUIGeoshapesPluginImages.IMG_CYLINDER);
>         semanticHintIconMap.put (GeoshapeConstants.TOOL_LINE, DiagramUIGeoshapesPluginImages.IMG_LINE);
57,59c40,41
<         if (hint != null) {
<             if (hint instanceof View) {
<                 View view = (View) hint;
---
>         View view = (View) hint.getAdapter (View.class);
>         if (view != null) {
62,67d43
<             } else {
<                 String fileName = (String) typeIconMap.get (hint);
<                 if (fileName != null) {
<                     return DiagramUIGeoshapesPluginImages.get (fileName);
<                 }
<             }
83,84c59,61
<             if (hint instanceof View) {
<                 String semanticHint = ((View) hint).getType ();
---
>             View view = (View) hint.getAdapter (View.class);
>             if (view != null) {
>                 String semanticHint = view.getType ();
87,90d63
<             Object type = hint.getAdapter (GeoshapeType.class);
<             if (type != null && typeIconMap.containsKey (type)) {
<                 return true;
<             }
