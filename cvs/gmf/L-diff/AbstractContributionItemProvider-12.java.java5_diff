46a47,48
> import org.eclipse.gmf.runtime.common.ui.util.ActivityUtil;
> 
95,96d96
< import org.eclipse.ui.PlatformUI;
< 
99,104d98
< import org.eclipse.ui.activities.IIdentifier;
< 
< import org.eclipse.ui.activities.IWorkbenchActivitySupport;
< 
< import org.eclipse.ui.activities.WorkbenchActivityHelper;
< 
547,551c541
<         if (! WorkbenchActivityHelper.isFiltering ()) return true;
< 
<         IWorkbenchActivitySupport workbenchActivitySupport = PlatformUI.getWorkbench ().getActivitySupport ();
<         IIdentifier id = workbenchActivitySupport.getActivityManager ().getIdentifier (WorkbenchActivityHelper.createUnifiedId (getPluginContribution ()));
<         if (id != null && ! id.isEnabled ()) {
---
>         if (! ActivityUtil.isEnabled (getPluginContribution ().getLocalId (), getPluginContribution ().getPluginId ())) {
554,567c544
<         id = workbenchActivitySupport.getActivityManager ().getIdentifier (WorkbenchActivityHelper.createUnifiedId (new IPluginContribution () {
< 
<             public String getLocalId () {
<                 return itemID;
<             }
< 
<             public String getPluginId () {
<                 return getPluginContribution ().getPluginId ();
<             }
< 
<         }
< 
<         ));
<         if (id != null && ! id.isEnabled ()) {
---
>         if (! ActivityUtil.isEnabled (itemID, getPluginContribution ().getPluginId ())) {
