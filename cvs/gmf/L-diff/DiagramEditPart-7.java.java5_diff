3,6d2
< import java.beans.PropertyChangeEvent;
< 
< import java.beans.PropertyChangeListener;
< 
17,18d12
< import org.eclipse.draw2d.FigureListener;
< 
24a19,20
> import org.eclipse.draw2d.LayoutListener;
> 
74a71,72
> import org.eclipse.gmf.runtime.diagram.ui.internal.editparts.PageBreakEditPart;
> 
92a91,92
> import org.eclipse.jface.preference.IPreferenceStore;
> 
114a115,123
>     private class PageBreaksLayoutListener extends LayoutListener.Stub {
> 
>         public void postLayout (IFigure container) {
>             super.postLayout (container);
>             updatePageBreaksLocation ();
>         }
> 
>     }
> 
149a159
>         f.addLayoutListener (new PageBreaksLayoutListener ());
216,237d225
<         child.addFigureListener (new FigureListener () {
< 
<             public void figureMoved (IFigure source) {
<                 updatePageBreaksLocation ();
<             }
< 
<         }
< 
<         );
<         child.addPropertyChangeListener (new PropertyChangeListener () {
< 
<             public void propertyChange (PropertyChangeEvent evt) {
<                 String pName = evt.getPropertyName ();
<                 Object newValue = evt.getNewValue ();
<                 if (pName == "parent" && newValue == null) {
<                     shouldUpdatePageBreakLocation = true;
<                 }
<             }
< 
<         }
< 
<         );
244c232,233
<         if (((DiagramRootEditPart) getRoot ()).getWorkspaceViewerPreferences () == null) return;
---
>         PageBreakEditPart pagebreakEditpart = ((DiagramRootEditPart) getRoot ()).getPageBreakEditPart ();
>         if (pagebreakEditpart == null || pagebreakEditpart.getFigure ().isVisible ()) return;
246c235
<         ((DiagramRootEditPart) getRoot ()).getPageBreakEditPart ().resize (getChildrenBounds ());
---
>         pagebreakEditpart.resize (getChildrenBounds ());
