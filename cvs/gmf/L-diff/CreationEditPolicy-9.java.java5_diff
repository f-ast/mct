14a15,18
> import org.eclipse.core.commands.ExecutionException;
> 
> import org.eclipse.core.runtime.IAdaptable;
> 
18a23,24
> import org.eclipse.emf.transaction.TransactionalEditingDomain;
> 
73c79
< import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeModelCommand;
---
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
150c156
<         return cc.isEmpty () ? null : new EtoolsProxyCommand (cc.unwrap ());
---
>         return cc.isEmpty () ? null : new EtoolsProxyCommand (cc.reduce ());
158a165
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
160c167
<             Command moveSemanticCmd = getHost ().getCommand (new EditCommandRequestWrapper (new MoveRequest (context, element)));
---
>             Command moveSemanticCmd = getHost ().getCommand (new EditCommandRequestWrapper (new MoveRequest (editingDomain, context, element)));
170c177
<         return new AddCommand (new EObjectAdapter (container), new EObjectAdapter (view));
---
>         return new AddCommand (gep.getEditingDomain (), new EObjectAdapter (container), new EObjectAdapter (view));
174c181,182
<         CompositeModelCommand cc = new CompositeModelCommand (DiagramUIMessages.AddCommand_Label);
---
>         TransactionalEditingDomain editingDomain = ((IGraphicalEditPart) getHost ()).getEditingDomain ();
>         CompositeTransactionalCommand cc = new CompositeTransactionalCommand (editingDomain, DiagramUIMessages.AddCommand_Label);
178c186
<             CreateCommand createCommand = new CreateCommand (descriptor, (View) (getHost ().getModel ()));
---
>             CreateCommand createCommand = new CreateCommand (editingDomain, descriptor, (View) (getHost ().getModel ()));
181c189
<         return new EtoolsProxyCommand (cc.unwrap ());
---
>         return new EtoolsProxyCommand (cc.reduce ());
242,243c250,251
<                 protected CommandResult doExecute (IProgressMonitor progressMonitor) {
<                     CommandResult cmdResult = super.doExecute (progressMonitor);
---
>                 protected CommandResult doExecuteWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
>                     CommandResult cmdResult = super.doExecuteWithResult (progressMonitor, info);
253c261
<                     return newOKCommandResult ();
---
>                     return CommandResult.newOKCommandResult ();
256c264
<                 protected CommandResult doUndo () {
---
>                 protected CommandResult doUndoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
260c268
<                     return super.doUndo ();
---
>                     return super.doUndoWithResult (progressMonitor, info);
263c271
<                 protected CommandResult doRedo () {
---
>                 protected CommandResult doRedoWithResult (IProgressMonitor progressMonitor, IAdaptable info) throws ExecutionException {
267c275
<                     return super.doRedo ();
---
>                     return super.doRedoWithResult (progressMonitor, info);
