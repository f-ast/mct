24,27d23
<     private static final String DLL_NAME = "DiagramPrint";
<     private static final String SEPARATOR = StringStatics.UNDER_SCORE;
<     private static final String SUPPORTED [] = {"en", "de", "es", "fr", "it", "ja", "ko", "pt_BR", "zh_CN", "zh_TW"};
<     private static final String DEFAULT_LOCALE = SUPPORTED [0];
30,67c26
<         boolean success = false;
<         String language = Locale.getDefault ().getLanguage ().toLowerCase ();
<         String country = Locale.getDefault ().getCountry ().toUpperCase ();
<         if (language != null) {
<             String localizedVersion = (country != null) ? language + SEPARATOR + country : language;
<             for (int i = 0;
<             i < SUPPORTED.length; i ++) {
<                 if (localizedVersion.equals (SUPPORTED [i])) {
<                     success = true;
<                 } else if (language.equals (SUPPORTED [i])) {
<                     localizedVersion = language;
<                     success = true;
<                 }
< 
<                 if (success) {
<                     success = false;
<                     try {
<                         System.loadLibrary (DLL_NAME + SEPARATOR + localizedVersion);
<                         success = true;
<                         break;
<                     } catch (UnsatisfiedLinkError ule) {
<                         Trace.catching (PrintingPlugin.getDefault (), CommonPrintingDebugOptions.EXCEPTIONS_CATCHING, PrintHelper.class, "Link", ule);
<                         Log.error (PrintingPlugin.getDefault (), CommonPrintingStatusCodes.RESOURCE_FAILURE, "Failed to load DiagramPrint dll for " + localizedVersion);
<                         Trace.throwing (PrintingPlugin.getDefault (), CommonPrintingDebugOptions.EXCEPTIONS_THROWING, PrintHelper.class, "Link", ule);
<                     }
<                 }
<             }
<         }
<         if (! success) {
<             try {
<                 System.loadLibrary (DLL_NAME + SEPARATOR + DEFAULT_LOCALE);
<             } catch (UnsatisfiedLinkError ule) {
<                 Trace.catching (PrintingPlugin.getDefault (), CommonPrintingDebugOptions.EXCEPTIONS_CATCHING, PrintHelper.class, "Link", ule);
<                 Log.error (PrintingPlugin.getDefault (), CommonPrintingStatusCodes.RESOURCE_FAILURE, "Failed to load DiagramPrint_en.dll for language " + ((language == null) ? "null" : language) + " and country " + ((country == null) ? "null" : country), ule);
<                 Trace.throwing (PrintingPlugin.getDefault (), CommonPrintingDebugOptions.EXCEPTIONS_THROWING, PrintHelper.class, "Link", ule);
<                 throw ule;
<             }
<         }
---
>         System.loadLibrary ("DiagramPrint");
79a39,42
>     public static native void setOrientation (boolean isLandscape);
> 
>     public static native void setPaperSize (int index, double width, double height);
> 
194a158,165
>     public void setDlgOrientation (boolean bLandscape) {
>         setOrientation (bLandscape);
>     }
> 
>     public void setDlgPaperSize (int index, double width, double height) {
>         setPaperSize (index, width, height);
>     }
> 
