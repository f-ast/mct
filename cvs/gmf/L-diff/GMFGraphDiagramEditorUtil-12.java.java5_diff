24a25,26
> import org.eclipse.core.resources.IResource;
> 
47,48d48
< import org.eclipse.emf.ecore.xmi.XMIResource;
< 
51,52d50
< import org.eclipse.emf.edit.ui.util.EditUIUtil;
< 
96a95,96
> import org.eclipse.ui.IWorkbenchPage;
> 
98a99,102
> import org.eclipse.ui.PlatformUI;
> 
> import org.eclipse.ui.part.FileEditorInput;
> 
100d103
<     private static Map ourSaveOptions = null;
103,109c106,109
<         if (ourSaveOptions == null) {
<             ourSaveOptions = new HashMap ();
<             ourSaveOptions.put (XMIResource.OPTION_ENCODING, "UTF-8");
<             ourSaveOptions.put (XMLResource.OPTION_RECORD_UNKNOWN_FEATURE, Boolean.TRUE);
<             ourSaveOptions.put (Resource.OPTION_SAVE_ONLY_IF_CHANGED, Resource.OPTION_SAVE_ONLY_IF_CHANGED_MEMORY_BUFFER);
<         }
<         return ourSaveOptions;
---
>         Map saveOptions = new HashMap ();
>         saveOptions.put (XMLResource.OPTION_ENCODING, "UTF-8");
>         saveOptions.put (Resource.OPTION_SAVE_ONLY_IF_CHANGED, Resource.OPTION_SAVE_ONLY_IF_CHANGED_MEMORY_BUFFER);
>         return saveOptions;
113c113,119
<         return EditUIUtil.openEditor ((EObject) diagram.getContents ().get (0));
---
>         String path = diagram.getURI ().toPlatformString (true);
>         IResource workspaceResource = ResourcesPlugin.getWorkspace ().getRoot ().findMember (new Path (path));
>         if (workspaceResource instanceof IFile) {
>             IWorkbenchPage page = PlatformUI.getWorkbench ().getActiveWorkbenchWindow ().getActivePage ();
>             return null != page.openEditor (new FileEditorInput ((IFile) workspaceResource), GMFGraphDiagramEditor.ID);
>         }
>         return false;
