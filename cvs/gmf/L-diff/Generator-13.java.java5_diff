3,4d2
< import java.lang.ref.SoftReference;
< 
9,10d6
< import java.util.HashMap;
< 
15,16d10
< import java.util.Map;
< 
21,22d14
< import org.eclipse.emf.common.util.URI;
< 
65d56
<     private static Map myCachedURI2EmitterMap = new HashMap ();
67a59,63
>         this (genModel, Activator.getInstance ().getEmitters (genModel));
>     }
> 
>     public Generator (GenEditorGenerator genModel, CodegenEmitters emitters) {
>         assert genModel != null && emitters != null;
70,82c66
<         URI resourceURI = myEditorGen.eResource ().getURI ();
<         if (myEditorGen.isDynamicTemplates ()) {
<             myCachedURI2EmitterMap.remove (resourceURI);
<         }
<         CodegenEmitters old = myCachedURI2EmitterMap.containsKey (resourceURI) ? (CodegenEmitters) ((SoftReference) myCachedURI2EmitterMap.get (resourceURI)).get () : null;
<         if (old == null) {
<             myEmitters = new CodegenEmitters (! myEditorGen.isDynamicTemplates (), myEditorGen.getTemplateDirectory ());
<             if (! myEditorGen.isDynamicTemplates ()) {
<                 myCachedURI2EmitterMap.put (resourceURI, new SoftReference (myEmitters));
<             }
<         } else {
<             myEmitters = old;
<         }
---
>         myEmitters = emitters;
