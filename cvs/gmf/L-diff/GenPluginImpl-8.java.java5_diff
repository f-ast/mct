37c37
< import org.eclipse.gmf.codegen.gmfgen.GenPlugin;
---
> import org.eclipse.gmf.codegen.gmfgen.GenExpressionProviderBase;
39c39
< import org.eclipse.gmf.codegen.gmfgen.ValueExpression;
---
> import org.eclipse.gmf.codegen.gmfgen.GenPlugin;
164c164,165
<         for (Iterator it = getDiagram ().eAllContents ();
---
>         if (getEditorGen ().getExpressionProviders () != null) {
>             for (Iterator it = getEditorGen ().getExpressionProviders ().getProviders ().iterator ();
166,172c167,168
<             Object nextObj = it.next ();
<             if (nextObj instanceof ValueExpression) {
<                 String lang = ((ValueExpression) nextObj).getLanguage ();
<                 if ("ocl".equals (lang)) {
<                     requiredIDs.add ("org.eclipse.emf.query.ocl");
<                 }
<             }
---
>                 GenExpressionProviderBase nextProvider = (GenExpressionProviderBase) it.next ();
>                 requiredIDs.addAll (nextProvider.getRequiredPluginIDs ());
174,176d169
<         if (getDiagram ().hasLinkCreationConstraints ()) {
<             requiredIDs.add ("org.eclipse.emf.ocl");
<             requiredIDs.add ("org.eclipse.emf.query.ocl");
