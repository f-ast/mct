95,96d94
< import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramEditPart;
< 
106a105,106
> import org.eclipse.gmf.runtime.diagram.ui.parts.DiagramGraphicalViewer;
> 
355,356c355,358
<         while (ep != null && ! (ep instanceof DiagramEditPart)) {
<             ep = ep.getParent ();
---
>         boolean isActivating = true;
>         EditPartViewer viewer = ep.getViewer ();
>         if (viewer instanceof DiagramGraphicalViewer) {
>             isActivating = ((DiagramGraphicalViewer) viewer).isInitializing ();
358c360
<         if (ep == null || (ep != null && ((DiagramEditPart) ep).isActivatingDiagram ()) || ! EditPartUtil.isWriteTransactionInProgress ((IGraphicalEditPart) getHost (), false, false)) options = Collections.singletonMap (Transaction.OPTION_UNPROTECTED, Boolean.TRUE);
---
>         if (isActivating || ! EditPartUtil.isWriteTransactionInProgress ((IGraphicalEditPart) getHost (), false, false)) options = Collections.singletonMap (Transaction.OPTION_UNPROTECTED, Boolean.TRUE);
