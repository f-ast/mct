3,4d2
< import java.util.ArrayList;
< 
23,26d20
< import org.eclipse.jface.util.Assert;
< 
< import org.eclipse.ui.IEditorPart;
< 
58a53,56
> import org.eclipse.jface.util.Assert;
> 
> import org.eclipse.ui.IEditorPart;
> 
163c161
<         HashMap existingEntries = new HashMap ();
---
>         HashMap existingEntryIds = new HashMap ();
167c165
<             existingEntries.put (entry.getId (), entry);
---
>             existingEntryIds.put (entry.getId (), entry);
169c167
<         List updatedChildren = new ArrayList (newContainer.getChildren ().size ());
---
>         int lastExistingEntryIndex = 0;
173c171
<             Object existingEntry = existingEntries.get (newEntry.getId ());
---
>             PaletteEntry existingEntry = (PaletteEntry) existingEntryIds.get (newEntry.getId ());
175c173,174
<                 updatedChildren.add (existingEntry);
---
>                 lastExistingEntryIndex = existingContainer.getChildren ().indexOf (existingEntry);
>                 existingEntryIds.remove (existingEntry.getId ());
180c179
<                 updatedChildren.add (newEntry);
---
>                 existingContainer.add (++ lastExistingEntryIndex, newEntry);
183c182,186
<         existingContainer.setChildren (updatedChildren);
---
>         for (Iterator iter = existingEntryIds.values ().iterator ();
>         iter.hasNext ();) {
>             PaletteEntry entry = (PaletteEntry) iter.next ();
>             existingContainer.remove (entry);
>         }
