54a55,56
> import org.eclipse.gef.RootEditPart;
> 
883,885c885,889
<         EditPart parent = getParent ();
<         if (parent instanceof org.eclipse.gef.GraphicalEditPart) return MapModeUtil.getMapMode (((org.eclipse.gef.GraphicalEditPart) parent).getFigure ());
< 
---
>         RootEditPart root = getRoot ();
>         if (root instanceof DiagramRootEditPart) {
>             DiagramRootEditPart dgrmRoot = (DiagramRootEditPart) root;
>             return dgrmRoot.getMapMode ();
>         }
