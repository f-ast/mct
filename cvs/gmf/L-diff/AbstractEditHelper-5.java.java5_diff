6a7,8
> import java.util.Collection;
> 
30a33,34
> import org.eclipse.gmf.runtime.common.core.command.ICompositeCommand;
> 
32a37,38
> import org.eclipse.gmf.runtime.emf.commands.core.command.CompositeTransactionalCommand;
> 
83c89
<         CompositeCommand command = createCompositeCommand (req);
---
>         ICompositeCommand command = createCommand (req);
124c130,138
<         return new CompositeCommand (req.getLabel ()) {
---
>         return null;
>     }
> 
>     protected ICompositeCommand createCommand (IEditCommandRequest req) {
>         CompositeCommand command = createCompositeCommand (req);
>         if (command != null) {
>             return command;
>         }
>         return new CompositeTransactionalCommand (req.getEditingDomain (), req.getLabel ()) {
128c142,143
<                 if (result.getStatus ().getSeverity () == IStatus.OK) {
---
>                 IStatus status = result.getStatus ();
>                 if (status.getSeverity () == IStatus.OK) {
130,133c145,149
<                     if (result.getReturnValue () instanceof List) {
<                         List returnValue = (List) result.getReturnValue ();
<                         if (returnValue.size () > 0) {
<                             returnObject = returnValue.get (0);
---
>                     Object returnValue = result.getReturnValue ();
>                     if (returnValue instanceof Collection) {
>                         Collection collection = (Collection) returnValue;
>                         if (! collection.isEmpty ()) {
>                             returnObject = collection.iterator ().next ();
136c152
<                         returnObject = result.getReturnValue ();
---
>                         returnObject = returnValue;
138c154
<                     result = new CommandResult (result.getStatus (), returnObject);
---
>                     result = new CommandResult (status, returnObject);
