7,8d6
< import java.util.Iterator;
< 
27,28d24
< import org.eclipse.emf.ecore.EPackage;
< 
50,52c46,47
<     protected EPackage domainMetaModel = null;
<     protected GenModel emfGenModel = null;
<     protected EClass domainDiagramElement = null;
---
>     protected GenPackage domainMetaModel = null;
>     protected GenClass domainDiagramElement = null;
97c92
<     public EPackage getDomainMetaModel () {
---
>     public GenPackage getDomainMetaModel () {
99,100c94,95
<             EPackage oldDomainMetaModel = domainMetaModel;
<             domainMetaModel = (EPackage) eResolveProxy ((InternalEObject) domainMetaModel);
---
>             GenPackage oldDomainMetaModel = domainMetaModel;
>             domainMetaModel = (GenPackage) eResolveProxy ((InternalEObject) domainMetaModel);
109c104
<     public EPackage basicGetDomainMetaModel () {
---
>     public GenPackage basicGetDomainMetaModel () {
113,114c108,109
<     public void setDomainMetaModel (EPackage newDomainMetaModel) {
<         EPackage oldDomainMetaModel = domainMetaModel;
---
>     public void setDomainMetaModel (GenPackage newDomainMetaModel) {
>         GenPackage oldDomainMetaModel = domainMetaModel;
120,143c115
<     public GenModel getEmfGenModel () {
<         if (emfGenModel != null && emfGenModel.eIsProxy ()) {
<             GenModel oldEmfGenModel = emfGenModel;
<             emfGenModel = (GenModel) eResolveProxy ((InternalEObject) emfGenModel);
<             if (emfGenModel != oldEmfGenModel) {
<                 if (eNotificationRequired ()) eNotify (new ENotificationImpl (this, Notification.RESOLVE, GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL, oldEmfGenModel, emfGenModel));
< 
<             }
<         }
<         return emfGenModel;
<     }
< 
<     public GenModel basicGetEmfGenModel () {
<         return emfGenModel;
<     }
< 
<     public void setEmfGenModel (GenModel newEmfGenModel) {
<         GenModel oldEmfGenModel = emfGenModel;
<         emfGenModel = newEmfGenModel;
<         if (eNotificationRequired ()) eNotify (new ENotificationImpl (this, Notification.SET, GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL, oldEmfGenModel, emfGenModel));
< 
<     }
< 
<     public EClass getDomainDiagramElement () {
---
>     public GenClass getDomainDiagramElement () {
145,146c117,118
<             EClass oldDomainDiagramElement = domainDiagramElement;
<             domainDiagramElement = (EClass) eResolveProxy ((InternalEObject) domainDiagramElement);
---
>             GenClass oldDomainDiagramElement = domainDiagramElement;
>             domainDiagramElement = (GenClass) eResolveProxy ((InternalEObject) domainDiagramElement);
155c127
<     public EClass basicGetDomainDiagramElement () {
---
>     public GenClass basicGetDomainDiagramElement () {
159,160c131,132
<     public void setDomainDiagramElement (EClass newDomainDiagramElement) {
<         EClass oldDomainDiagramElement = domainDiagramElement;
---
>     public void setDomainDiagramElement (GenClass newDomainDiagramElement) {
>         GenClass oldDomainDiagramElement = domainDiagramElement;
217c189
<             return toLowerCase (getDomainMetaModel ().getName ()) + ".edit.parts";
---
>             return getPackageNamePrefix () + ".edit.parts";
236c208
<             return toLowerCase (getDomainMetaModel ().getName ()) + ".edit.commands";
---
>             return getPackageNamePrefix () + ".edit.commands";
255c227
<             return toLowerCase (getDomainMetaModel ().getName ()) + ".providers";
---
>             return getPackageNamePrefix () + ".providers";
272c244
<             char [] v = getDomainMetaModel ().getName ().toCharArray ();
---
>             char [] v = getDomainMetaModel ().getEcorePackage ().getName ().toCharArray ();
316c288
<             return getEmfGenModel ().getModelPluginID () + ".gmf.editor";
---
>             return getEMFGenModel ().getModelPluginID () + ".gmf.editor";
335c307
<             return CodeGenUtil.validJavaIdentifier (getEmfGenModel ().getModelName ()) + "DiagramEditorPlugin";
---
>             return CodeGenUtil.validJavaIdentifier (getEMFGenModel ().getModelName ()) + "DiagramEditorPlugin";
354c326
<             return toLowerCase (getDomainMetaModel ().getName ()) + ".editor";
---
>             return getPackageNamePrefix () + ".editor";
373c345
<             return toLowerCase (getDomainMetaModel ().getName ()) + ".edit.providers";
---
>             return getPackageNamePrefix () + ".edit.providers";
436c408
<             return getEmfGenModel ().getModelName ().toLowerCase () + "_diagram";
---
>             return getEMFGenModel ().getModelName ().toLowerCase () + "_diagram";
469a442,445
>     public GenModel getEMFGenModel () {
>         return getDomainMetaModel ().getGenModel ();
>     }
> 
487,495c463
<         GenPackage gp = getEmfGenModel ().findGenPackage (domainMetaClass.getEPackage ());
<         for (Iterator it = gp.getGenClasses ().iterator ();
<         it.hasNext ();) {
<             GenClass genClass = (GenClass) it.next ();
<             if (genClass.getEcoreClass ().equals (domainMetaClass)) {
<                 return genClass;
<             }
<         }
<         throw new IllegalStateException ("Can't find genClass for class '" + domainMetaClass.getName () + "' in package " + gp.getPackageName ());
---
>         throw new UnsupportedOperationException ();
499,507c467
<         GenClass genClass = findGenClass (domainMetaFeature.getEContainingClass ());
<         for (Iterator it = genClass.getGenFeatures ().iterator ();
<         it.hasNext ();) {
<             GenFeature next = (GenFeature) it.next ();
<             if (next.getEcoreFeature ().equals (domainMetaFeature)) {
<                 return next;
<             }
<         }
<         throw new IllegalStateException ("Can't find genFeature for feature '" + domainMetaFeature.getName () + "' in class " + genClass.getName ());
---
>         throw new UnsupportedOperationException ();
578,581d537
<             case GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL :
<                 if (resolve) return getEmfGenModel ();
< 
<                 return basicGetEmfGenModel ();
643,646c599
<                 setDomainMetaModel ((EPackage) newValue);
<                 return;
<             case GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL :
<                 setEmfGenModel ((GenModel) newValue);
---
>                 setDomainMetaModel ((GenPackage) newValue);
649c602
<                 setDomainDiagramElement ((EClass) newValue);
---
>                 setDomainDiagramElement ((GenClass) newValue);
729,732c682
<                 setDomainMetaModel ((EPackage) null);
<                 return;
<             case GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL :
<                 setEmfGenModel ((GenModel) null);
---
>                 setDomainMetaModel ((GenPackage) null);
735c685
<                 setDomainDiagramElement ((EClass) null);
---
>                 setDomainDiagramElement ((GenClass) null);
810,811d759
<             case GMFGenPackage.GEN_DIAGRAM__EMF_GEN_MODEL :
<                 return emfGenModel != null;
895a844,847
>     private String getPackageNamePrefix () {
>         return toLowerCase (getDomainMetaModel ().getEcorePackage ().getName ());
>     }
> 
