3,7c3
< import org.eclipse.gef.GraphicalViewer;
< 
< import org.eclipse.jface.util.Assert;
< 
< import org.eclipse.swt.widgets.Shell;
---
> import org.eclipse.gef.RootEditPart;
10a7,8
> import org.eclipse.gmf.runtime.diagram.ui.editparts.DiagramRootEditPart;
> 
20a19,24
> import org.eclipse.jface.preference.IPreferenceStore;
> 
> import org.eclipse.jface.util.Assert;
> 
> import org.eclipse.swt.widgets.Shell;
> 
30c34
<         GraphicalViewer customViewer = new DiagramGraphicalViewer ();
---
>         DiagramGraphicalViewer customViewer = new DiagramGraphicalViewer ();
35c39,45
<         customViewer.setRootEditPart (EditPartService.getInstance ().createRootEditPart (diagram));
---
>         RootEditPart rep = EditPartService.getInstance ().createRootEditPart (diagram);
>         if (rep instanceof DiagramRootEditPart) {
>             DiagramRootEditPart drep = (DiagramRootEditPart) rep;
>             IPreferenceStore fPreferences = (IPreferenceStore) drep.getPreferencesHint ().getPreferenceStore ();
>             customViewer.hookWorkspacePreferenceStore (fPreferences);
>         }
>         customViewer.setRootEditPart (rep);
