66a67,70
> import org.eclipse.gmf.runtime.diagram.ui.label.ILabelDelegate;
> 
> import org.eclipse.gmf.runtime.diagram.ui.label.WrappingLabelDelegate;
> 
74a79,80
> import org.eclipse.gmf.runtime.draw2d.ui.figures.WrappingLabel;
> 
111a118
>     private ILabelDelegate labelDelegate;
128,131c135,149
<         WrapLabel label = new WrapLabel ("");
<         label.setLabelAlignment (PositionConstants.TOP);
<         label.setTextAlignment (PositionConstants.TOP);
<         return label;
---
>         return new WrapLabel ();
>     }
> 
>     protected ILabelDelegate createLabelDelegate () {
>         WrapLabel label = getLabel ();
>         ILabelDelegate newLabelDelegate = null;
>         if (label != null) {
>             newLabelDelegate = new WrappingLabelDelegate (label);
>         } else {
>             newLabelDelegate = new WrappingLabelDelegate ((WrappingLabel) getFigure ());
>         }
>         newLabelDelegate.setTextJustification (PositionConstants.CENTER);
>         newLabelDelegate.setAlignment (PositionConstants.CENTER);
>         newLabelDelegate.setTextAlignment (PositionConstants.TOP);
>         return newLabelDelegate;
135c153,179
<         return super.getFigure ();
---
>         if (figure == null) {
>             setFigure (createFigure ());
>             setLabelDelegate (createLabelDelegate ());
>         }
>         return figure;
>     }
> 
>     public ILabelDelegate getLabelDelegate () {
>         if (labelDelegate == null) {
>             getFigure ();
>             if (labelDelegate == null) {
>                 setLabelDelegate (createLabelDelegate ());
>             }
>             return labelDelegate;
>         }
>         return labelDelegate;
>     }
> 
>     protected void setLabelDelegate (ILabelDelegate labelDelegate) {
>         this.labelDelegate = labelDelegate;
>     }
> 
>     public Object getAdapter (Class key) {
>         if (key == ILabelDelegate.class) {
>             return getLabelDelegate ();
>         }
>         return super.getAdapter (key);
157c201
<         getLabel ().setText (text);
---
>         getLabelDelegate ().setText (text);
355c399
<         getLabel ().setForegroundColor (color);
---
>         getFigure ().setForegroundColor (color);
413c457
<         getLabel ().setText (getLabelText ());
---
>         getLabelDelegate ().setText (getLabelText ());
415c459
<         i < numIcons; i ++) getLabel ().setIcon (getLabelIcon (i), i);
---
>         i < numIcons; i ++) getLabelDelegate ().setIcon (getLabelIcon (i), i);
417c461
<         getLabel ().setToolTip (getLabelToolTip ());
---
>         getFigure ().setToolTip (getLabelToolTip ());
422c466
<         if (style != null) getLabel ().setTextUnderline (style.isUnderline ());
---
>         if (style != null) getLabelDelegate ().setTextUnderline (style.isUnderline ());
428c472
<         if (style != null) getLabel ().setTextStrikeThrough (style.isStrikeThrough ());
---
>         if (style != null) getLabelDelegate ().setTextStrikeThrough (style.isStrikeThrough ());
436,438c480,482
<                 IFigure fig = getFigure ();
<                 if (fig instanceof WrapLabel) {
<                     e.result = ((WrapLabel) fig).getText ();
---
>                 ILabelDelegate label = getLabelDelegate ();
>                 if (label != null) {
>                     e.result = label.getText ();
