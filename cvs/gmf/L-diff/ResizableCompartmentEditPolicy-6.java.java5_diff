32a33,34
> import org.eclipse.gmf.runtime.diagram.ui.editparts.ResizableCompartmentEditPart;
> 
76,83c78,84
<     protected void showSelection () {
<         super.showSelection ();
<         if (getHost ().getSelected () != EditPart.SELECTED_NONE) {
<             if (getGraphicalEditPart ().getFigure () instanceof ResizableCompartmentFigure) {
<                 ResizableCompartmentFigure f = (ResizableCompartmentFigure) getGraphicalEditPart ().getFigure ();
<                 f.setSelected (true);
<             }
<             if (getGraphicalEditPart ().getFigure () instanceof GatedPaneFigure) {
---
>     private ResizableCompartmentFigure getCompartmentFigure () {
>         ResizableCompartmentFigure compartmentFigure = null;
>         if (getGraphicalEditPart () instanceof ResizableCompartmentEditPart) {
>             compartmentFigure = ((ResizableCompartmentEditPart) getGraphicalEditPart ()).getCompartmentFigure ();
>         } else if (getGraphicalEditPart ().getFigure () instanceof ResizableCompartmentFigure) {
>             compartmentFigure = (ResizableCompartmentFigure) getGraphicalEditPart ().getFigure ();
>         } else if (getGraphicalEditPart ().getFigure () instanceof GatedPaneFigure) {
87c88
<                     ((ResizableCompartmentFigure) f).setSelected (true);
---
>                 compartmentFigure = (ResizableCompartmentFigure) f;
89a91,101
> 
>         return compartmentFigure;
>     }
> 
>     protected void showSelection () {
>         super.showSelection ();
>         if (getHost ().getSelected () != EditPart.SELECTED_NONE) {
>             ResizableCompartmentFigure compartmentFigure = getCompartmentFigure ();
>             if (compartmentFigure != null) {
>                 compartmentFigure.setSelected (true);
>             }
96,105c108,110
<             if (getGraphicalEditPart ().getFigure () instanceof ResizableCompartmentFigure) {
<                 ResizableCompartmentFigure f = (ResizableCompartmentFigure) getGraphicalEditPart ().getFigure ();
<                 f.setSelected (false);
<             }
<             if (getGraphicalEditPart ().getFigure () instanceof GatedPaneFigure) {
<                 GatedPaneFigure gpf = (GatedPaneFigure) getGraphicalEditPart ().getFigure ();
<                 IFigure f = gpf.getElementPane ();
<                 if (f instanceof ResizableCompartmentFigure) {
<                     ((ResizableCompartmentFigure) f).setSelected (false);
<                 }
---
>             ResizableCompartmentFigure compartmentFigure = getCompartmentFigure ();
>             if (compartmentFigure != null) {
>                 compartmentFigure.setSelected (false);
185c190
<         ResizableCompartmentFigure f = (ResizableCompartmentFigure) getHostFigure ();
---
>         ResizableCompartmentFigure f = getCompartmentFigure ();
