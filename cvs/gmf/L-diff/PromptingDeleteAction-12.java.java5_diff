2a3,4
> import java.util.Iterator;
> 
4a7,14
> import org.eclipse.core.commands.ExecutionException;
> 
> import org.eclipse.core.runtime.IAdaptable;
> 
> import org.eclipse.core.runtime.IProgressMonitor;
> 
> import org.eclipse.core.runtime.IStatus;
> 
6a17,18
> import org.eclipse.emf.workspace.AbstractEMFOperation;
> 
17c29
< import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
---
> import org.eclipse.gmf.runtime.common.core.command.CommandResult;
19c31
< import org.eclipse.gmf.runtime.diagram.ui.commands.ICommandProxy;
---
> import org.eclipse.gmf.runtime.diagram.core.util.ViewUtil;
22a35,36
> import org.eclipse.gmf.runtime.diagram.ui.commands.ICommandProxy;
> 
86,87c100,124
<         Command command = createCommand (getSelectedObjects ());
<         if (command != null) execute (command);
---
>         TransactionalEditingDomain editingDomain = null;
>         for (Iterator iterator = getSelectedObjects ().iterator ();
>         iterator.hasNext ();) {
>             EditPart editPart = (EditPart) iterator.next ();
>             if (editPart instanceof IGraphicalEditPart) {
>                 editingDomain = ((IGraphicalEditPart) editPart).getEditingDomain ();
>                 break;
>             }
>         }
>         final Command command [] = new Command [1];
>         AbstractEMFOperation operation = new AbstractEMFOperation (editingDomain, DiagramUIMessages.DeleteCommand_Label) {
> 
>             protected IStatus doExecute (IProgressMonitor monitor, IAdaptable info) throws ExecutionException {
>                 command [0] = createCommand (getSelectedObjects ());
>                 return CommandResult.newOKCommandResult ().getStatus ();
>             }
> 
>         }
> 
>         ;
>         try {
>             operation.execute (null, null);
>         } catch (ExecutionException e) {
>         }
>         if (command [0] != null) execute (command [0]);
