2a3,4
> import java.awt.image.BufferedImage;
> 
46a49,50
> import org.eclipse.gmf.runtime.diagram.ui.image.PartPositionInfo;
> 
62a67,68
> import org.eclipse.gmf.runtime.draw2d.ui.render.awt.internal.image.ImageExporter;
> 
114a121
>         boolean found = false;
122c129,141
<         } else {
---
>         } else if (format.equals (ImageFileFormat.JPEG) || format.equals (ImageFileFormat.PNG)) {
>             String exportFormat = ImageExporter.JPEG_FILE;
>             if (format.equals (ImageFileFormat.PNG)) exportFormat = ImageExporter.PNG_FILE;
> 
>             gen = new DiagramImageGenerator (diagramEP);
>             java.awt.Image image = gen.createAWTImageForDiagram ();
>             if (image instanceof BufferedImage) {
>                 ImageExporter.exportToFile (destination, (BufferedImage) image, exportFormat, monitor);
>                 found = true;
>             }
>         }
> 
>         if (! found) {
133a153
>         boolean found = false;
139c159,171
<         } else {
---
>             found = true;
>         } else if (format.equals (ImageFileFormat.JPEG) || format.equals (ImageFileFormat.PNG)) {
>             String exportFormat = ImageExporter.JPEG_FILE;
>             if (format.equals (ImageFileFormat.PNG)) exportFormat = ImageExporter.PNG_FILE;
> 
>             java.awt.Image image = new DiagramImageGenerator (diagramEP).createAWTImageForParts (selection);
>             if (image instanceof BufferedImage) {
>                 ImageExporter.exportToFile (destination, (BufferedImage) image, exportFormat, monitor);
>                 found = true;
>             }
>         }
> 
>         if (! found) {
