head	1.2;
access;
symbols
	v20080813-1520:1.2
	v20080812-2100:1.2
	ocl_qvt:1.2.0.6
	Root_ocl_qvt:1.2
	v20080722-1827:1.2
	v20080716-1600:1.2
	v20080716-1642:1.2
	R2_1_maintenance:1.2.0.4
	Root_R2_1_maintenance:1.2
	R2_1_0:1.2
	v20080425-1959:1.2
	v20071108-0000:1.2
	v20070809-0000:1.2
	R2_0_maintenance:1.2.0.2
	R2_0:1.2
	R4_20:1.2
	RC3_20:1.2
	v20070601-1400:1.2
	v20070518-1300:1.2
	v20070330-1300:1.2
	v20070228-2000:1.2
	M4_20:1.2
	M3_20:1.2;
locks; strict;
comment	@# @;


1.2
date	2006.10.23.13.35.04;	author atikhomirov;	state Exp;
branches;
next	1.1;

1.1
date	2006.10.18.20.33.08;	author atikhomirov;	state Exp;
branches;
next	;


desc
@@


1.2
log
@refactor access to color preferences
@
text
@/*
 * <copyright>
 *
 * Copyright (c) 2005-2006 Sven Efftinge and others.
 * All rights reserved.   This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     Sven Efftinge - Initial API and implementation
 *
 * </copyright>
 */
package org.eclipse.gmf.internal.xpand.editor;

import java.util.HashMap;
import java.util.Map;

import org.eclipse.jface.preference.IPreferenceStore;
import org.eclipse.jface.preference.PreferenceConverter;
import org.eclipse.swt.graphics.Color;
import org.eclipse.swt.graphics.RGB;
import org.eclipse.swt.widgets.Display;

/**
 * Manager for colors used in the Template editor
 */
public class ColorProvider {
	private static final String HIGHLIGHT_KEYWORDS = "hl_keywords";

	private static final String HIGHLIGHT_TERMINALS = "hl_terminals";

	private static final String HIGHLIGHT_DEFINE = "hl_define";

	private static final String HIGHLIGHT_STRING = "hl_string";

	private static final String HIGHLIGHT_TEXT = "hl_text";

	private static final String HIGHLIGHT_COMMENT = "hl_comment";

	private static final String HIGHLIGHT_OTHER = "hl_other";

	
	private final Map<RGB, Color> ivColorTable = new HashMap<RGB, Color>();

	private final IPreferenceStore preferenceStore;

	public ColorProvider(IPreferenceStore preferenceStore) {
		assert preferenceStore != null;
		this.preferenceStore = preferenceStore;
	}

	public void initializeDefaults() {
		initializeDefaultValues(preferenceStore);
	}

	/**
	 * Release all of the color resources held onto by the receiver.
	 */
	public void dispose() {
		for (Color c : ivColorTable.values()) {
			c.dispose();
		}
	}

	/**
	 * Return the Color that is stored in the Color table as rgb. Create new
	 * entry, if none can be found.
	 * 
	 * @@param rgb
	 *            RGB color to lookup from HashMap
	 */
	protected Color getColor(final RGB aRgb) {
        Color color = ivColorTable.get(aRgb);
        if (color == null) {
            color = createColor(aRgb);
            ivColorTable.put(aRgb, color);
        }
        return color;
    }

	protected Color createColor(final RGB aColor) {
		return new Color(Display.getCurrent(), aColor);
	}

	public Color getKeywordsColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_KEYWORDS));
    }

	public Color getTerminalsColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_TERMINALS));
    }

	public Color getDefineColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_DEFINE));
    }

	public Color getStringColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_STRING));
    }

	public Color getCommentColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_COMMENT));
    }

	public Color getOtherColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_OTHER));
    }

	public Color getTextColor() {
    	return getColor(PreferenceConverter.getColor(preferenceStore, HIGHLIGHT_TEXT));
    }

	public final static void initializeDefaultValues(final IPreferenceStore store) {
		PreferenceConverter.setDefault(store, HIGHLIGHT_KEYWORDS, new RGB(127, 0, 85));
		PreferenceConverter.setDefault(store, HIGHLIGHT_TERMINALS, new RGB(100, 100, 100));
		PreferenceConverter.setDefault(store, HIGHLIGHT_DEFINE, new RGB(127, 0, 85));
		PreferenceConverter.setDefault(store, HIGHLIGHT_STRING, new RGB(42, 0, 255));
		PreferenceConverter.setDefault(store, HIGHLIGHT_COMMENT, new RGB(63, 127, 95));
		PreferenceConverter.setDefault(store, HIGHLIGHT_OTHER, new RGB(0, 0, 0));
		PreferenceConverter.setDefault(store, HIGHLIGHT_TEXT, new RGB(42, 0, 255));
	}
}
@


1.1
log
@Initial contribution of the reworked XPand template engine from eclipse.org/gmt/oaw to be used until M2T deliveries are available.
The contribution (including LPG 1.1 runtime) was approved by Eclipse Legal at the very end of September, 2006.
@
text
@a17 1
import java.util.Iterator;
d20 2
d30 1
a30 1
    protected Map<RGB, Color> ivColorTable = new HashMap<RGB, Color>();
d32 34
a65 9
    /**
     * Release all of the color resources held onto by the receiver.
     */
    public void dispose() {
        final Iterator<Color> e = ivColorTable.values().iterator();
        while (e.hasNext()) {
            e.next().dispose();
        }
    }
d67 8
a74 8
    /**
     * Return the Color that is stored in the Color table as rgb. Create new
     * entry, if none can be found.
     * 
     * @@param rgb
     *            RGB color to lookup from HashMap
     */
    public Color getColor(final RGB aRgb) {
d77 1
a77 1
            color = new Color(Display.getCurrent(), aRgb);
d82 42
@

