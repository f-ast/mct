head	1.6;
access;
symbols
	v20080722-1827:1.6
	R2_1_maintenance:1.6.0.4
	Root_R2_1_maintenance:1.6
	R2_1_0:1.6
	v20080417-1610:1.6
	v20080322-0000:1.6
	v20080222-1200:1.6
	v20070809-0000:1.6
	R2_0_maintenance:1.6.0.2
	R2_0:1.6
	R4_20:1.6
	v20070621-0000:1.6
	RC3_20:1.6
	v20070601-1400:1.6
	v20070413-1300:1.6
	v20070405-2000:1.5
	v20070330-1300:1.5
	v20060316-0600:1.5
	v20070228-2000:1.5
	v20070208-1800:1.5
	M4_20:1.5
	v20061222-1800:1.5
	v20061214-0000:1.5
	M3_20:1.5
	v20061117-0800:1.5
	v20061013-1330:1.4
	v20060925-1700:1.3
	v20060919-0800:1.3
	M1_20:1.3
	v20060713-1700:1.3
	R1_0_maintenance:1.3.0.2
	R1_0:1.3
	v20060627-1200:1.3
	v20060616-1200:1.3
	v20060531-1730:1.3
	v20060519-0800:1.3
	I20060424-0500:1.2
	I20060424-0300:1.2
	M6_10:1.2
	I20060407-1200:1.2
	I20060331-1000:1.1
	I20060324-0300:1.1
	I20060317-1300:1.1
	I20060317-1200:1.1
	I20060316-1300:1.1
	I20060309-1300:1.1
	M5_10:1.1
	S20060303-1600:1.1;
locks; strict;
comment	@# @;
expand	@k@;


1.6
date	2007.04.13.10.08.36;	author dstadnik;	state Exp;
branches;
next	1.5;
commitid	123e461f56a44567;

1.5
date	2006.11.01.09.25.03;	author dstadnik;	state Exp;
branches;
next	1.4;

1.4
date	2006.10.03.14.35.39;	author dstadnik;	state Exp;
branches;
next	1.3;

1.3
date	2006.05.17.10.24.53;	author dstadnik;	state Exp;
branches;
next	1.2;

1.2
date	2006.04.05.12.33.42;	author dstadnik;	state Exp;
branches;
next	1.1;

1.1
date	2006.03.01.14.19.17;	author dstadnik;	state Exp;
branches;
next	;


desc
@@


1.6
log
@better flow action layout
@
text
@/*
 * Copyright (c) 2006 Eclipse.org
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Dmitry Stadnik - initial API and implementation
 */
package org.eclipse.gmf.internal.bridge.ui.dashboard;

import org.eclipse.draw2d.AbstractLayout;
import org.eclipse.draw2d.ColorConstants;
import org.eclipse.draw2d.Figure;
import org.eclipse.draw2d.Graphics;
import org.eclipse.draw2d.IFigure;
import org.eclipse.draw2d.ImageFigure;
import org.eclipse.draw2d.Label;
import org.eclipse.draw2d.MarginBorder;
import org.eclipse.draw2d.PolygonDecoration;
import org.eclipse.draw2d.RectangleFigure;
import org.eclipse.draw2d.ToolbarLayout;
import org.eclipse.draw2d.geometry.Dimension;
import org.eclipse.draw2d.geometry.Insets;
import org.eclipse.draw2d.geometry.Point;
import org.eclipse.draw2d.geometry.PointList;
import org.eclipse.draw2d.geometry.Rectangle;
import org.eclipse.jface.resource.JFaceResources;
import org.eclipse.swt.graphics.Color;
import org.eclipse.swt.graphics.Image;

/**
 * @@author dstadnik
 */
public class DashboardFigure extends RectangleFigure {

	private static final int LINE_WIDTH = 6;

	private static final int TEXT_GAP = LINE_WIDTH + 3;

	private static final int ARROW_LENGTH = 15;

	private static final Color DASHBOARD_BG = new Color(null, 113, 104, 209);

	private static final Color DASHBOARD_FG = new Color(null, 169, 164, 227);

	private static final Color MODEL_BG = ColorConstants.white;

	private ImageFigure logoFigure;

	private IFigure statusFigure;

	// models

	private ModelFigure dgmFigure;

	private ModelFigure gdmFigure;

	private ModelFigure dmFigure;

	private ModelFigure tdmFigure;

	private ModelFigure mmFigure;

	private ModelFigure gmFigure;

	// flows

	private FlowFigure dm2dgmFlow;

	private FlowFigure dm2gdmFlow;

	private FlowFigure dm2tdmFlow;

	private FlowFigure dm2mmFlow;

	private FlowFigure gdm2mmFlow;

	private FlowFigure tdm2mmFlow;

	private FlowFigure mm2gmFlow;

	// flow actions

	private FlowActionFigure dm2dgmFigure;

	private FlowActionFigure dm2gdmFigure;

	private FlowActionFigure dm2tdmFigure;

	private FlowActionFigure dm2mmFigure;

	private FlowActionFigure mm2gmFigure;

	public DashboardFigure() {
		add(logoFigure = new ImageFigure() {

			protected void paintFigure(Graphics graphics) {
				if (getImage() != null) {
					graphics.drawImage(getImage(), new Rectangle(getImage().getBounds()), getBounds());
				}
			}
		});
		Image logoImage = Plugin.getDefault().getImageRegistry().get(Plugin.GMF_LOGO_IMAGE);
		if (logoImage != null) {
			logoFigure.setImage(logoImage);
		}
		add(dgmFigure = createModelFigure(Messages.DashboardFigure_DGM, Plugin.DGM_ICON));
		add(gdmFigure = createModelFigure(Messages.DashboardFigure_GDM, Plugin.GDM_ICON));
		add(dmFigure = createModelFigure(Messages.DashboardFigure_DM, Plugin.DM_ICON));
		add(tdmFigure = createModelFigure(Messages.DashboardFigure_TDM, Plugin.TDM_ICON));
		add(mmFigure = createModelFigure(Messages.DashboardFigure_MM, Plugin.MM_ICON));
		add(gmFigure = createModelFigure(Messages.DashboardFigure_GM, Plugin.GM_ICON));
		add(dm2dgmFlow = createFlowFigure(true));
		add(dm2gdmFlow = createFlowFigure(true));
		add(dm2tdmFlow = createFlowFigure(true));
		add(dm2mmFlow = createFlowFigure(true));
		add(gdm2mmFlow = createFlowFigure(false));
		add(tdm2mmFlow = createFlowFigure(false));
		add(mm2gmFlow = createFlowFigure(true));
		add(dm2dgmFigure = createFlowActionFigure());
		add(dm2gdmFigure = createFlowActionFigure());
		add(dm2tdmFigure = createFlowActionFigure());
		add(dm2mmFigure = createFlowActionFigure());
		add(mm2gmFigure = createFlowActionFigure());
		add(statusFigure = new Figure());
		statusFigure.setFont(JFaceResources.getBannerFont());
		ToolbarLayout statusLayout = new ToolbarLayout();
		statusLayout.setStretchMinorAxis(false);
		statusFigure.setLayoutManager(statusLayout);
		statusFigure.add(new Label());
		statusFigure.add(new Label());
		setLayoutManager(new DashboardLayout());
		setBorder(new MarginBorder(10));
		setBackgroundColor(DASHBOARD_BG);
		setForegroundColor(DASHBOARD_FG);
	}

	public ModelFigure getDGMFigure() {
		return dgmFigure;
	}

	public ModelFigure getGDMFigure() {
		return gdmFigure;
	}

	public ModelFigure getDMFigure() {
		return dmFigure;
	}

	public ModelFigure getTDMFigure() {
		return tdmFigure;
	}

	public ModelFigure getMMFigure() {
		return mmFigure;
	}

	public ModelFigure getGMFigure() {
		return gmFigure;
	}

	public FlowActionFigure getDM2DGMFigure() {
		return dm2dgmFigure;
	}

	public FlowActionFigure getDM2GDMFigure() {
		return dm2gdmFigure;
	}

	public FlowActionFigure getDM2TDMFigure() {
		return dm2tdmFigure;
	}

	public FlowActionFigure getDM2MMFigure() {
		return dm2mmFigure;
	}

	public FlowActionFigure getMM2GMFigure() {
		return mm2gmFigure;
	}

	public Label getStatusLine(int i) {
		return (Label) statusFigure.getChildren().get(i);
	}

	protected ModelFigure createModelFigure(String description, String iconKey) {
		ModelFigure modelFigure = new ModelFigure();
		modelFigure.setDescription(description);
		Image image = Plugin.getDefault().getImageRegistry().get(iconKey);
		if (image != null) {
			modelFigure.setIcon(image);
		}
		modelFigure.setBackgroundColor(MODEL_BG);
		modelFigure.setForegroundColor(DASHBOARD_FG);
		modelFigure.setLineWidth(LINE_WIDTH);
		modelFigure.setSpacing(TEXT_GAP);
		return modelFigure;
	}

	protected FlowFigure createFlowFigure(boolean directed) {
		FlowFigure flowFigure = new FlowFigure();
		if (directed) {
			PolygonDecoration decoration = new PolygonDecoration();
			PointList template = new PointList();
			template.addPoint(0, -LINE_WIDTH / 2);
			template.addPoint(0, LINE_WIDTH / 2);
			template.addPoint(-ARROW_LENGTH, LINE_WIDTH / 2 + 10);
			template.addPoint(-ARROW_LENGTH, -(LINE_WIDTH / 2 + 10));
			decoration.setTemplate(template);
			decoration.setScale(1, 1);
			flowFigure.setTargetDecoration(decoration);
		}
		flowFigure.setForegroundColor(DASHBOARD_FG);
		flowFigure.setLineWidth(LINE_WIDTH);
		return flowFigure;
	}

	protected FlowActionFigure createFlowActionFigure() {
		FlowActionFigure flowActionFigure = new FlowActionFigure();
		ToolbarLayout flowActionLayout = new ToolbarLayout();
		flowActionLayout.setStretchMinorAxis(false);
		flowActionLayout.setMinorAlignment(ToolbarLayout.ALIGN_CENTER);
		flowActionFigure.setLayoutManager(flowActionLayout);
		flowActionFigure.setBackgroundColor(MODEL_BG);
		flowActionFigure.setForegroundColor(DASHBOARD_FG);
		flowActionFigure.setLineWidth(LINE_WIDTH / 3);
		flowActionFigure.setBorder(new MarginBorder(TEXT_GAP / 2));
		return flowActionFigure;
	}

	protected void outlineShape(Graphics graphics) {
	}

	private class DashboardLayout extends AbstractLayout {

		private static final int MAX_BOX_WIDTH = 300;

		private static final int BOX_SPACING = 20;

		protected Dimension calculatePreferredSize(IFigure container, int wHint, int hHint) {
			Dimension d = getLayoutData().getSize();
			Insets insets = container.getInsets();
			d = new Dimension(d.width + insets.getWidth(), d.height + insets.getHeight());
			return d.union(getBorderPreferredSize(container));
		}

		public void layout(IFigure container) {
			getLayoutData().apply(container.getClientArea().getLocation());
		}

		protected LayoutData getLayoutData() {
			Dimension dgmSize = dgmFigure.getPreferredSize();
			dgmSize.width = Math.min(dgmSize.width, MAX_BOX_WIDTH);
			Dimension dmSize = dmFigure.getPreferredSize();
			dmSize.width = Math.min(dmSize.width, MAX_BOX_WIDTH);;
			Dimension gdmSize = gdmFigure.getPreferredSize();
			gdmSize.width = Math.min(gdmSize.width, MAX_BOX_WIDTH);
			Dimension tdmSize = gdmFigure.getPreferredSize();
			tdmSize.width = Math.min(tdmSize.width, MAX_BOX_WIDTH);
			Dimension mmSize = mmFigure.getPreferredSize();
			mmSize.width = Math.min(mmSize.width, MAX_BOX_WIDTH);;
			Dimension gmSize = gmFigure.getPreferredSize();
			gmSize.width = Math.min(gmSize.width, MAX_BOX_WIDTH);
			Dimension dm2dgmSize = dm2dgmFigure.getPreferredSize();
			Dimension dm2gdmSize = dm2gdmFigure.getPreferredSize();
			Dimension dm2tdmSize = dm2tdmFigure.getPreferredSize();
			Dimension dm2mmSize = dm2mmFigure.getPreferredSize();
			Dimension mm2gmSize = mm2gmFigure.getPreferredSize();

			LayoutData data = new LayoutData();

			// boxes
			int dmY = gdmSize.height + BOX_SPACING;
			int dgmY = dmY + dmSize.height + BOX_SPACING;
			data.dgmBox = new Rectangle(0, dgmY, dgmSize.width, dgmSize.height);
			data.dm2dgmBox = new Rectangle((data.dgmBox.width - dm2dgmSize.width) / 2, dmY + (dmSize.height - dm2dgmSize.height) / 2, dm2dgmSize.width, dm2dgmSize.height);
			data.dmBox = new Rectangle(data.dm2dgmBox.x + data.dm2dgmBox.width + BOX_SPACING, dmY, dmSize.width, dmSize.height);
			int dm2tdmX = data.dmBox.x + (data.dmBox.width - dm2tdmSize.width) / 2;
			int gap1 = dm2tdmX - (data.dgmBox.x + data.dgmBox.width);
			if (gap1 < BOX_SPACING) {
				int delta = BOX_SPACING - gap1;
				data.dmBox.x += delta;
				dm2tdmX += delta;
			}
			data.dm2gdmBox = new Rectangle(data.dmBox.x + (data.dmBox.width - dm2gdmSize.width) / 2, (gdmSize.height - dm2gdmSize.height) / 2, dm2gdmSize.width, dm2gdmSize.height);
			data.gdmBox = new Rectangle(data.dm2gdmBox.x + data.dm2gdmBox.width + BOX_SPACING + ARROW_LENGTH, 0, gdmSize.width, gdmSize.height);
			int tdmY = data.dmBox.y + data.dmBox.height + BOX_SPACING;
			data.dm2tdmBox = new Rectangle(dm2tdmX, tdmY + (tdmSize.height - dm2tdmSize.height) / 2, dm2tdmSize.width, dm2tdmSize.height);
			data.tdmBox = new Rectangle(data.dm2tdmBox.x + data.dm2tdmBox.width + BOX_SPACING + ARROW_LENGTH, tdmY, tdmSize.width, tdmSize.height);
			data.dm2mmBox = new Rectangle(data.dmBox.x + data.dmBox.width + BOX_SPACING, data.dmBox.y + (data.dmBox.height - dm2mmSize.height) / 2, dm2mmSize.width, dm2mmSize.height);
			data.mmBox = new Rectangle(data.dm2mmBox.x + data.dm2mmBox.width + BOX_SPACING + ARROW_LENGTH, data.dmBox.y, mmSize.width, mmSize.height);
			int gmY = data.mmBox.y + data.mmBox.height + BOX_SPACING;
			data.mm2gmBox = new Rectangle(data.mmBox.x + data.mmBox.width + BOX_SPACING, data.mmBox.y + (data.mmBox.height - mm2gmSize.height) / 2, mm2gmSize.width, mm2gmSize.height);
			data.gmBox = new Rectangle(data.mm2gmBox.x - (gmSize.width - mm2gmSize.width) / 2, gmY, gmSize.width, gmSize.height);
			int gap2 = data.gmBox.x - (data.tdmBox.x + data.tdmBox.width);
			if (gap2 < BOX_SPACING) {
				int delta = BOX_SPACING - gap2;
				data.mm2gmBox.x += delta;
				data.gmBox.x += delta;
			}

			// points
			int pointsY = data.dmBox.y + data.dmBox.height / 2;
			data.dm2dgmPoints = new PointList(3);
			data.dm2dgmPoints.addPoint(data.dmBox.x, pointsY);
			data.dm2dgmPoints.addPoint(data.dm2dgmBox.x + data.dm2dgmBox.width / 2, pointsY);
			data.dm2dgmPoints.addPoint(data.dm2dgmBox.x + data.dm2dgmBox.width / 2, data.dgmBox.y);
			int pointsX = data.dmBox.x + data.dmBox.width / 2;
			data.dm2gdmPoints = new PointList(3);
			data.dm2gdmPoints.addPoint(pointsX, data.dmBox.y);
			data.dm2gdmPoints.addPoint(pointsX, data.dm2gdmBox.y + data.dm2gdmBox.height / 2);
			data.dm2gdmPoints.addPoint(data.gdmBox.x, data.dm2gdmBox.y + data.dm2gdmBox.height / 2);
			data.dm2tdmPoints = new PointList(3);
			data.dm2tdmPoints.addPoint(pointsX, data.dmBox.y + data.dmBox.height);
			data.dm2tdmPoints.addPoint(pointsX, data.dm2tdmBox.y + data.dm2tdmBox.height / 2);
			data.dm2tdmPoints.addPoint(data.tdmBox.x, data.dm2tdmBox.y + data.dm2tdmBox.height / 2);
			data.dm2mmPoints = new PointList(2);
			data.dm2mmPoints.addPoint(data.dmBox.x + data.dmBox.width, pointsY);
			data.dm2mmPoints.addPoint(data.mmBox.x, pointsY);
			int crossX = data.dm2mmBox.x + data.dm2mmBox.width / 2;
			data.gdm2mmPoints = new PointList(2);
			data.gdm2mmPoints.addPoint(crossX, data.gdmBox.y + data.gdmBox.height);
			data.gdm2mmPoints.addPoint(crossX, pointsY);
			data.tdm2mmPoints = new PointList(2);
			data.tdm2mmPoints.addPoint(crossX, data.tdmBox.y);
			data.tdm2mmPoints.addPoint(crossX, pointsY);
			data.mm2gmPoints = new PointList(3);
			data.mm2gmPoints.addPoint(data.mmBox.x + data.mmBox.width, pointsY);
			data.mm2gmPoints.addPoint(data.mm2gmBox.x + data.mm2gmBox.width / 2, pointsY);
			data.mm2gmPoints.addPoint(data.mm2gmBox.x + data.mm2gmBox.width / 2, data.gmBox.y);

			// logo and status
			int logoMaxWidth = data.dm2gdmBox.x - BOX_SPACING;
			int logoMaxHeight = data.dmBox.y - BOX_SPACING;
			Dimension logoSize = logoFigure.getPreferredSize();
			if (logoSize.width > logoMaxWidth || logoSize.height > logoMaxHeight) {
				double scale = Math.min((double) logoMaxWidth / logoSize.width, (double) logoMaxHeight / logoSize.height);
				logoSize.width *= scale;
				logoSize.height *= scale;
			}
			data.logoBox = new Rectangle(0, 0, logoSize.width, logoSize.height);
			Dimension statusSize = statusFigure.getPreferredSize();
			int statusX = Math.max(data.gmBox.x + data.gmBox.width - statusSize.width, data.gdmBox.x + data.gdmBox.width + BOX_SPACING);
			//int statusY = (data.mmBox.y - statusSize.height) / 2;
			data.statusBox = new Rectangle(statusX, 0, statusSize.width, statusSize.height);

			return data;
		}

		private class LayoutData {

			public Rectangle logoBox;

			public Rectangle statusBox;

			public Rectangle dgmBox;

			public Rectangle gdmBox;

			public Rectangle dmBox;

			public Rectangle tdmBox;

			public Rectangle mmBox;

			public Rectangle gmBox;

			public PointList dm2dgmPoints;

			public PointList dm2gdmPoints;

			public PointList dm2tdmPoints;

			public PointList dm2mmPoints;

			public PointList gdm2mmPoints;

			public PointList tdm2mmPoints;

			public PointList mm2gmPoints;

			public Rectangle dm2dgmBox;

			public Rectangle dm2gdmBox;

			public Rectangle dm2tdmBox;

			public Rectangle dm2mmBox;

			public Rectangle mm2gmBox;

			public void apply(Point offset) {
				logoFigure.setBounds(logoBox.getTranslated(offset));
				statusFigure.setBounds(statusBox.getTranslated(offset));
				dgmFigure.setBounds(dgmBox.getTranslated(offset));
				gdmFigure.setBounds(gdmBox.getTranslated(offset));
				dmFigure.setBounds(dmBox.getTranslated(offset));
				tdmFigure.setBounds(tdmBox.getTranslated(offset));
				mmFigure.setBounds(mmBox.getTranslated(offset));
				gmFigure.setBounds(gmBox.getTranslated(offset));
				dm2dgmFlow.setPoints(getTranslated(dm2dgmPoints, offset));
				dm2gdmFlow.setPoints(getTranslated(dm2gdmPoints, offset));
				dm2tdmFlow.setPoints(getTranslated(dm2tdmPoints, offset));
				dm2mmFlow.setPoints(getTranslated(dm2mmPoints, offset));
				gdm2mmFlow.setPoints(getTranslated(gdm2mmPoints, offset));
				tdm2mmFlow.setPoints(getTranslated(tdm2mmPoints, offset));
				mm2gmFlow.setPoints(getTranslated(mm2gmPoints, offset));
				dm2dgmFigure.setBounds(dm2dgmBox.getTranslated(offset));
				dm2gdmFigure.setBounds(dm2gdmBox.getTranslated(offset));
				dm2tdmFigure.setBounds(dm2tdmBox.getTranslated(offset));
				dm2mmFigure.setBounds(dm2mmBox.getTranslated(offset));
				mm2gmFigure.setBounds(mm2gmBox.getTranslated(offset));
			}

			private PointList getTranslated(PointList source, Point offset) {
				PointList target = new PointList(source.size());
				target.addAll(source);
				target.translate(offset);
				return target;
			}

			public Dimension getSize() {
				Rectangle bounds = logoBox.getCopy();
				bounds.union(statusBox);
				bounds.union(dgmBox);
				bounds.union(gdmBox);
				bounds.union(dmBox);
				bounds.union(tdmBox);
				bounds.union(mmBox);
				bounds.union(gmBox);
				return bounds.getSize();
			}
		}
	}
}
@


1.5
log
@don't allow disconnected arrows
@
text
@d223 4
a226 1
		flowActionFigure.setLayoutManager(new ToolbarLayout());
@


1.4
log
@rename i18n keys
@
text
@d236 1
a236 1
		private static final int MAX_BOX_WIDTH = 400;
@


1.3
log
@#137306 nls; complete
@
text
@d110 6
a115 6
		add(dgmFigure = createModelFigure(Messages.DashboardFigure_0, Plugin.DGM_ICON));
		add(gdmFigure = createModelFigure(Messages.DashboardFigure_1, Plugin.GDM_ICON));
		add(dmFigure = createModelFigure(Messages.DashboardFigure_2, Plugin.DM_ICON));
		add(tdmFigure = createModelFigure(Messages.DashboardFigure_3, Plugin.TDM_ICON));
		add(mmFigure = createModelFigure(Messages.DashboardFigure_4, Plugin.MM_ICON));
		add(gmFigure = createModelFigure(Messages.DashboardFigure_5, Plugin.GM_ICON));
@


1.2
log
@#124852 add domain genmodel
@
text
@d110 6
a115 6
		add(dgmFigure = createModelFigure("Domain Gen Model", Plugin.DGM_ICON));
		add(gdmFigure = createModelFigure("Graphical Def Model", Plugin.GDM_ICON));
		add(dmFigure = createModelFigure("Domain Model", Plugin.DM_ICON));
		add(tdmFigure = createModelFigure("Tooling Def Model", Plugin.TDM_ICON));
		add(mmFigure = createModelFigure("Mapping Model", Plugin.MM_ICON));
		add(gmFigure = createModelFigure("Diagram Gen Model", Plugin.GM_ICON));
@


1.1
log
@#129930 moved from oeg.codegen.ui
@
text
@d43 2
d57 2
d71 2
d87 2
d98 8
a105 1
		add(logoFigure = new ImageFigure());
d110 2
a111 1
		add(gdmFigure = createModelFigure("Graphical Definition Model", Plugin.GDM_ICON));
d113 1
a113 1
		add(tdmFigure = createModelFigure("Tooling Definition Model", Plugin.TDM_ICON));
d115 2
a116 1
		add(gmFigure = createModelFigure("Generation Model", Plugin.GM_ICON));
d123 1
d141 4
d165 4
d210 2
a211 2
			template.addPoint(-15, LINE_WIDTH / 2 + 10);
			template.addPoint(-15, -(LINE_WIDTH / 2 + 10));
d236 1
a236 1
		private static final int MAX_BOX_WIDTH = 300;
d238 1
a238 1
		private static final int BOX_SPACING = 30;
d252 4
d257 1
a257 3
			int dWidth = gdmSize.width;
			Dimension dmSize = dmFigure.getPreferredSize();
			dWidth = Math.max(dWidth, dmSize.width);
d259 1
a259 5
			dWidth = Math.max(dWidth, tdmSize.width);
			dWidth = Math.min(dWidth, MAX_BOX_WIDTH);
			gdmSize.width = dWidth;
			dmSize.width = dWidth;
			tdmSize.width = dWidth;
d261 1
a261 1
			mmSize.width = Math.min(mmSize.width, MAX_BOX_WIDTH);
d264 1
d273 17
a289 5
			data.gdmBox = new Rectangle(0, 0, gdmSize.width, gdmSize.height);
			data.dm2gdmBox = new Rectangle((data.gdmBox.width - dm2gdmSize.width) / 2, data.gdmBox.y + data.gdmBox.height + BOX_SPACING, dm2gdmSize.width, dm2gdmSize.height);
			data.dmBox = new Rectangle(0, data.dm2gdmBox.y + data.dm2gdmBox.height + BOX_SPACING, dmSize.width, dmSize.height);
			data.dm2tdmBox = new Rectangle((data.dmBox.width - dm2tdmSize.width) / 2, data.dmBox.y + data.dmBox.height + BOX_SPACING, dm2tdmSize.width, dm2tdmSize.height);
			data.tdmBox = new Rectangle(0, data.dm2tdmBox.y + data.dm2tdmBox.height + BOX_SPACING, tdmSize.width, tdmSize.height);
d291 2
a292 1
			data.mmBox = new Rectangle(data.dm2mmBox.x + data.dm2mmBox.width + BOX_SPACING, data.dmBox.y, mmSize.width, mmSize.height);
d294 7
a300 1
			data.gmBox = new Rectangle(data.mm2gmBox.x + data.mm2gmBox.width + BOX_SPACING, data.dmBox.y, gmSize.width, gmSize.height);
d303 5
d309 1
a309 1
			data.dm2gdmPoints = new PointList(2);
d311 3
a313 2
			data.dm2gdmPoints.addPoint(pointsX, data.gdmBox.y + data.gdmBox.height);
			data.dm2tdmPoints = new PointList(2);
d315 2
a316 2
			data.dm2tdmPoints.addPoint(pointsX, data.tdmBox.y);
			int pointsY = data.dmBox.y + data.dmBox.height / 2;
d321 2
a322 3
			data.gdm2mmPoints = new PointList(3);
			data.gdm2mmPoints.addPoint(data.gdmBox.x + data.gdmBox.width, data.gdmBox.y + data.gdmBox.height / 2);
			data.gdm2mmPoints.addPoint(crossX, data.gdmBox.y + data.gdmBox.height / 2);
d324 2
a325 3
			data.tdm2mmPoints = new PointList(3);
			data.tdm2mmPoints.addPoint(data.tdmBox.x + data.tdmBox.width, data.tdmBox.y + data.tdmBox.height / 2);
			data.tdm2mmPoints.addPoint(crossX, data.tdmBox.y + data.tdmBox.height / 2);
d327 1
a327 1
			data.mm2gmPoints = new PointList(2);
d329 2
a330 1
			data.mm2gmPoints.addPoint(data.gmBox.x, pointsY);
d333 2
d336 6
a341 2
			int logoX = Math.max(data.mmBox.x, data.gmBox.x + data.gmBox.width - logoSize.width);
			data.logoBox = new Rectangle(logoX, 0, logoSize.width, logoSize.height);
d343 3
a345 2
			int statusRoof = Math.max(data.mmBox.y + data.mmBox.height, data.gmBox.y + data.gmBox.height) + TEXT_GAP;
			data.statusBox = new Rectangle(data.mmBox.x, Math.max(statusRoof, data.tdmBox.y), statusSize.width, statusSize.height);
d356 2
d368 2
d382 2
d395 1
d401 1
d408 1
d425 1
@

