head	1.2;
access;
symbols
	v20080910-1520:1.2
	v20080722-1827:1.2
	v20080716-1642:1.2
	R2_1_maintenance:1.2.0.2
	Root_R2_1_maintenance:1.2
	R2_1_0:1.2
	v20080507-1326:1.2
	v20080501-1739:1.1
	v20080425-1959:1.1
	v20080322-0000:1.1
	v20071108-0000:1.1
	v20071003-0000:1.1
	v20070921-0000:1.1.2.2
	R2_0_maintenance:1.1.0.2
	v20070903-0000:1.1;
locks; strict;
comment	@# @;


1.2
date	2008.05.07.13.55.39;	author atikhomirov;	state Exp;
branches;
next	1.1;
commitid	388c4821b4d44567;

1.1
date	2007.07.04.13.22.26;	author bblajer;	state Exp;
branches
	1.1.2.1;
next	;
commitid	405d468b9f0f4567;

1.1.2.1
date	2007.07.04.13.22.26;	author bblajer;	state dead;
branches;
next	1.1.2.2;
commitid	7b9846eea5004567;

1.1.2.2
date	2007.09.17.16.02.13;	author bblajer;	state Exp;
branches;
next	;
commitid	7b9846eea5004567;


desc
@@


1.2
log
@[228913] updated ValueExpression use in GMFGen to better accomodate codegen needs (items 1,2,3)
@
text
@/*
 * Copyright (c) 2007 Borland Software Corporation
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    bblajer (Borland) - initial API and implementation
 */

«IMPORT "http://www.eclipse.org/gmf/2008/GenModel"»
«IMPORT "http://www.eclipse.org/emf/2002/Ecore"»
«IMPORT "http://www.eclipse.org/emf/2002/GenModel"»
«EXTENSION xpt::GenModelUtils»

«DEFINE RegexpExpressionFactory FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::copyright FOR container.editorGen»
package «container.expressionsPackageName»;

«EXPAND xpt::Common::generatedClassComment»
public class «className» «EXPAND supertypes» {
	«EXPAND ctor-»

	«EXPAND getExpression-»

	«EXPAND additions-»

	«EXPAND Expression-»
}
«ENDDEFINE»

«DEFINE supertypes FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»

«DEFINE ctor FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
private «className»() {
}
«ENDDEFINE»

«DEFINE getExpression FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
public static «container.getAbstractExpressionQualifiedClassName()» getExpression(String body, org.eclipse.emf.ecore.EClassifier context, java.util.Map environment) {
	return new «EXPAND ExpressionClassName»(body, context, environment);
}

«EXPAND xpt::Common::generatedMemberComment»
public static «container.getAbstractExpressionQualifiedClassName()» getExpression(String body, org.eclipse.emf.ecore.EClassifier context) {
	return getExpression(body, context, java.util.Collections.EMPTY_MAP);
}
«ENDDEFINE»

«DEFINE additions FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»

«DEFINE ExpressionClassName FOR gmfgen::GenExpressionInterpreter»Expression«ENDDEFINE»

«DEFINE Expression FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedClassComment»
private static class «EXPAND ExpressionClassName» extends «container.getAbstractExpressionQualifiedClassName()» {
	«EXPAND Expression_pattern-»

	«EXPAND Expression_ctor-»

	«EXPAND Expression_doEvaluate-»

	«EXPAND Expression_additions-»
}
«ENDDEFINE»

«DEFINE Expression_pattern FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
private final java.util.regex.Pattern pattern;
«ENDDEFINE»

«DEFINE Expression_ctor FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
public «EXPAND ExpressionClassName»(String body, org.eclipse.emf.ecore.EClassifier context, java.util.Map environment) {
	super(body, context);
	java.util.regex.Pattern p;
	try {
		p = java.util.regex.Pattern.compile(body);
	} catch (java.util.regex.PatternSyntaxException e) {
		setStatus(org.eclipse.core.runtime.IStatus.ERROR, e.getMessage(), e);
		p = null;
	}
	this.pattern = p;
}
«ENDDEFINE»

«DEFINE Expression_doEvaluate FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
protected Object doEvaluate(Object contextInstance, java.util.Map env) {
	if (pattern == null) {
		return null;
	}

	if(context() instanceof org.eclipse.emf.ecore.EDataType) {
		contextInstance = org.eclipse.emf.ecore.util.EcoreUtil.convertToString((org.eclipse.emf.ecore.EDataType)context(), contextInstance);
	}

	java.util.regex.Matcher matcher = this.pattern.matcher(String.valueOf(contextInstance));
	return Boolean.valueOf(«EXPAND possibleNegation»matcher.matches());
}
«ENDDEFINE»

«DEFINE possibleNegation FOR gmfgen::GenExpressionInterpreter»«IF language.literal != gmfgen::GenLanguage::regexp.literal»!«ENDIF»«ENDDEFINE»

«DEFINE Expression_additions FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»
@


1.1
log
@Eliminated Jet templates in lite version;
i18n in lite RT;
For generated classes whose names are not directly modifiable via gmfgen file, consistent className/qualifiedClassName template is exposed (and used throughout the generation process, including the Generator);
Link labels and external node labels are not selectable, but movable;
Inner elements are not selectable with marquee tool;
Fixed copyright statements throughout the lite RT.
@
text
@d13 1
a13 1
«IMPORT "http://www.eclipse.org/gmf/2006/GenModel"»
@


1.1.2.1
log
@file RegexpExpressionFactory.xpt was added on branch R2_0_maintenance on 2007-09-17 16:02:13 +0000
@
text
@d1 109
@


1.1.2.2
log
@Eliminated Jet templates in lite version;
i18n in lite RT;
For generated classes whose names are not directly modifiable via gmfgen file, consistent className/qualifiedClassName template is exposed (and used throughout the generation process, including the Generator)
@
text
@a0 109
/*
 * Copyright (c) 2007 Borland Software Corporation
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    bblajer (Borland) - initial API and implementation
 */

«IMPORT "http://www.eclipse.org/gmf/2006/GenModel"»
«IMPORT "http://www.eclipse.org/emf/2002/Ecore"»
«IMPORT "http://www.eclipse.org/emf/2002/GenModel"»
«EXTENSION xpt::GenModelUtils»

«DEFINE RegexpExpressionFactory FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::copyright FOR container.editorGen»
package «container.expressionsPackageName»;

«EXPAND xpt::Common::generatedClassComment»
public class «className» «EXPAND supertypes» {
	«EXPAND ctor-»

	«EXPAND getExpression-»

	«EXPAND additions-»

	«EXPAND Expression-»
}
«ENDDEFINE»

«DEFINE supertypes FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»

«DEFINE ctor FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
private «className»() {
}
«ENDDEFINE»

«DEFINE getExpression FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
public static «container.getAbstractExpressionQualifiedClassName()» getExpression(String body, org.eclipse.emf.ecore.EClassifier context, java.util.Map environment) {
	return new «EXPAND ExpressionClassName»(body, context, environment);
}

«EXPAND xpt::Common::generatedMemberComment»
public static «container.getAbstractExpressionQualifiedClassName()» getExpression(String body, org.eclipse.emf.ecore.EClassifier context) {
	return getExpression(body, context, java.util.Collections.EMPTY_MAP);
}
«ENDDEFINE»

«DEFINE additions FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»

«DEFINE ExpressionClassName FOR gmfgen::GenExpressionInterpreter»Expression«ENDDEFINE»

«DEFINE Expression FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedClassComment»
private static class «EXPAND ExpressionClassName» extends «container.getAbstractExpressionQualifiedClassName()» {
	«EXPAND Expression_pattern-»

	«EXPAND Expression_ctor-»

	«EXPAND Expression_doEvaluate-»

	«EXPAND Expression_additions-»
}
«ENDDEFINE»

«DEFINE Expression_pattern FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
private final java.util.regex.Pattern pattern;
«ENDDEFINE»

«DEFINE Expression_ctor FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
public «EXPAND ExpressionClassName»(String body, org.eclipse.emf.ecore.EClassifier context, java.util.Map environment) {
	super(body, context);
	java.util.regex.Pattern p;
	try {
		p = java.util.regex.Pattern.compile(body);
	} catch (java.util.regex.PatternSyntaxException e) {
		setStatus(org.eclipse.core.runtime.IStatus.ERROR, e.getMessage(), e);
		p = null;
	}
	this.pattern = p;
}
«ENDDEFINE»

«DEFINE Expression_doEvaluate FOR gmfgen::GenExpressionInterpreter-»
«EXPAND xpt::Common::generatedMemberComment»
protected Object doEvaluate(Object contextInstance, java.util.Map env) {
	if (pattern == null) {
		return null;
	}

	if(context() instanceof org.eclipse.emf.ecore.EDataType) {
		contextInstance = org.eclipse.emf.ecore.util.EcoreUtil.convertToString((org.eclipse.emf.ecore.EDataType)context(), contextInstance);
	}

	java.util.regex.Matcher matcher = this.pattern.matcher(String.valueOf(contextInstance));
	return Boolean.valueOf(«EXPAND possibleNegation»matcher.matches());
}
«ENDDEFINE»

«DEFINE possibleNegation FOR gmfgen::GenExpressionInterpreter»«IF language.literal != gmfgen::GenLanguage::regexp.literal»!«ENDIF»«ENDDEFINE»

«DEFINE Expression_additions FOR gmfgen::GenExpressionInterpreter»«ENDDEFINE»
@


