head	1.3;
access;
symbols
	v20081023-2107:1.3
	v20081022-1925:1.3
	v20081021-1810:1.3
	v20081020-0700:1.3
	v20080911-1728:1.3
	v20080911-1506:1.3
	v20080910-1520:1.3
	v20080910-1510:1.3
	v20080903-1520:1.3
	v20080903-1510:1.3
	v20080722-1827:1.3
	R2_1_maintenance:1.3.0.2
	Root_R2_1_maintenance:1.3
	R2_1_0:1.3
	v20080610-1132:1.3
	v20080603-1553:1.3
	v20080512-1200:1.3
	v20080503-1740:1.3
	v20080501-1739:1.3
	v20080425-1959:1.3
	v20080417-1610:1.2
	v20080407-2250:1.1
	v20080407-0930:1.1
	v20080404-1111:1.1;
locks; strict;
comment	@# @;


1.3
date	2008.04.25.18.39.42;	author ahunter;	state Exp;
branches;
next	1.2;
commitid	26f44812256d4567;

1.2
date	2008.04.17.00.04.44;	author aboyko;	state Exp;
branches;
next	1.1;
commitid	12f4806941c4567;

1.1
date	2008.04.03.16.30.10;	author aboyko;	state Exp;
branches;
next	;
commitid	3e0347f506114567;


desc
@@


1.3
log
@[228915] gmf-head ahunter 080425 Non-externalized string literal; it should be followed by //$NON-NLS-<n>
@
text
@/******************************************************************************
 * Copyright (c) 2008 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    IBM Corporation - initial API and implementation 
 ****************************************************************************/

package org.eclipse.gmf.runtime.draw2d.ui.graph;

import org.eclipse.draw2d.geometry.PointList;
import org.eclipse.draw2d.graph.Edge;
import org.eclipse.draw2d.graph.Node;

/**
 * Implementation of Edge that:
 * <li> Can connect border node(s)
 * <li> Can be routed obliquely or orthogonally
 * 
 * @@author aboyko
 * @@since 2.1
 */
public class ConstrainedEdge extends Edge {
	
	public static String DEFAULT_ROUTING_STYLE = "Default"; //$NON-NLS-1$
	public static String ORTHOGONAL_ROUTING_STYLE = "Orthogonal"; //$NON-NLS-1$
	
	private String style = DEFAULT_ROUTING_STYLE;
	
	BorderNode sourceConstraint = null;
	BorderNode targetConstraint = null;
	
	PointList startingRoutedPoints = new PointList();
	PointList endingRoutedPoints = new PointList();

	/**
	 * Constructs a new edge with the given source and target nodes.  All other fields will
	 * have their default values.
	 * @@param source the source Node
	 * @@param target the target Node
	 * @@since 2.1
	 */
	public ConstrainedEdge(Node source, Node target) {
		this(null, source, target);
	}
	
	/**
	 * Constructs a new edge with the given source, target, delta, and weight.
	 * @@param source the source Node
	 * @@param target the target Node
	 * @@param delta the minimum edge span
	 * @@param weight the weight hint
	 * @@since 2.1
	 */
	public ConstrainedEdge(Node source, Node target, int delta, int weight) {
		this(source, target);
		this.delta = delta;
		this.weight = weight;
	}

	/**
	 * Constructs a new edge with the given data object, source, and target node.
	 * @@param data an arbitrary data object
	 * @@param source the source node
	 * @@param target the target node
	 * @@since 2.1
	 */
	public ConstrainedEdge(Object data, Node source, Node target) {
		super(data, source, target);
		if (source instanceof BorderNode) {
			sourceConstraint = (BorderNode)source;
			this.source = sourceConstraint.borderNodeParent;
			this.source.outgoing.add(this);
			sourceConstraint.addOutgoingEdge(this);
		}
		if (target instanceof BorderNode) {
			targetConstraint = (BorderNode)target;
			this.target = targetConstraint.borderNodeParent;
			this.target.incoming.add(this);
			targetConstraint.addIncomingEdge(this);
		}
		if (this.source.equals(this.target)) {
			throw new RuntimeException("Edges between border nodes on the same parent or border node and its parent are disallowed."); //$NON-NLS-1$
		}
	}

	/**
	 * Gets the routing style for the edge 
	 * @@return the style constant
	 * @@since 2.1
	 */
	public String getStyle() {
		return style;
	}

	/**
	 * Sets the routing style for the edge (orthogonal or default)
	 * @@param style the style constant
	 * @@since 2.1
	 */
	public void setStyle(String style) {
		this.style = style;
	}

	/* (non-Javadoc)
	 * @@see org.eclipse.draw2d.graph.Edge#invert()
	 */
	public void invert() {
		super.invert();
		
		if (sourceConstraint != null) {
			sourceConstraint.outgoingJointEdges.edges.remove(this);
		}
		if (targetConstraint != null) {
			targetConstraint.incomingJointEdges.edges.remove(this);
		}
		
		BorderNode temp = sourceConstraint;
		sourceConstraint = targetConstraint;
		targetConstraint = temp;
		
		if (sourceConstraint != null) {
			sourceConstraint.outgoingJointEdges.edges.add(this);
		}
		if (targetConstraint != null) {
			targetConstraint.incomingJointEdges.edges.add(this);
		}
	}

}
@


1.2
log
@[226138] gmf_head aboyko 080416 [Layout] Layout issues
@
text
@d86 1
a86 1
			throw new RuntimeException("Edges between border nodes on the same parent or border node and its parent are disallowed.");
@


1.1
log
@[225437] gmf_head aboyko 080403 Layout improvements
@
text
@d85 3
@

