head	1.7;
access;
symbols
	v20080813-1520:1.7
	v20080807-1333:1.7
	v20080806-1520:1.7
	v20080731-1520:1.7
	v20080722-1827:1.7
	R2_1_maintenance:1.7.0.4
	Root_R2_1_maintenance:1.7
	R2_1_0:1.7
	v20080528-1052:1.7
	v20080417-1610:1.7
	v20080222-1200:1.7
	v20080215-1500:1.7
	v20080207-0207:1.7
	v20071214-1111:1.7
	v20071108-0000:1.7
	v20071003-0000:1.7
	v20070809-0000:1.7
	R2_0_maintenance:1.7.0.2
	R2_0:1.7
	R4_20:1.7
	v20070621-0000:1.7
	RC3_20:1.6
	v20070608-1300:1.6
	v20070605-1400:1.5
	v20070601-1400:1.4
	v20070518-1300:1.3
	v20070330-1300:1.2
	v20060316-0600:1.2
	v20070307-0700:1.2
	v20070228-2000:1.2
	v20070208-1800:1.2
	M4_20:1.2
	v20061214-0000:1.2
	M3_20:1.2
	v20061117-0800:1.2;
locks; strict;
comment	@# @;
expand	@k@;


1.7
date	2007.06.20.11.39.51;	author atikhomirov;	state Exp;
branches;
next	1.6;
commitid	95e467912074567;

1.6
date	2007.06.08.18.45.20;	author atikhomirov;	state Exp;
branches;
next	1.5;
commitid	21504669a3c04567;

1.5
date	2007.06.05.13.39.12;	author atikhomirov;	state Exp;
branches;
next	1.4;
commitid	3131466567804567;

1.4
date	2007.05.28.13.33.47;	author atikhomirov;	state Exp;
branches;
next	1.3;
commitid	3e69465ada3a4567;

1.3
date	2007.05.17.22.14.20;	author atikhomirov;	state Exp;
branches;
next	1.2;
commitid	640b464cd3bb4567;

1.2
date	2006.11.03.16.50.17;	author atikhomirov;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.02.21.58.38;	author atikhomirov;	state Exp;
branches;
next	;


desc
@@


1.7
log
@[193180] not every child of a link deserves to be generated. Even labels are not that good, but decorations are even worse. Left labels for legacy reasons (users tend to edfine link's label as a child), omit every other child kind.
In addition, use field name right away as figure variable to minimize number of names introduced, fight potential name clashes
@
text
@/*
 * Copyright (c) 2006, 2007 Borland Software Corporation
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Artem Tikhomirov (Borland) - initial API and implementation
 */

«IMPORT "http://www.eclipse.org/gmf/2006/GraphicalDefinition"»
«IMPORT "http://www.eclipse.org/emf/2002/Ecore"»
«IMPORT "templates"»
«EXTENSION Util»

«DEFINE ClassBody(String cuName) FOR gmfgraph::Figure»«ERROR "abstract ClassBody(Figure)"»«ENDDEFINE»

«DEFINE ClassBody(String cuName) FOR gmfgraph::FigureRef-»
«EXPAND ClassBody(cuName) FOR figure-»
«ENDDEFINE»

«DEFINE ClassBody(String cuName) FOR gmfgraph::RealFigure-»
	/**
	 * @@generated
	 */
	public «cuName»() {
«getBordersInUse().clear()->""-»
		«EXPAND Layout::Init("this") FOR layout-»
		«EXPAND Attrs::Init("this")-»
«IF !children.typeSelect(Figure).isEmpty()-»
		createContents();
	}
«EXPAND Children::CreateChildren-»
«EXPAND Border::InitMethods»
«ELSE-»
	}
«ENDIF-»
«EXPAND Extras::extraMethods»
«EXPAND Extras::localCoordinates»
«EXPAND additions-»
«ENDDEFINE»

«DEFINE ClassBody(String cuName) FOR gmfgraph::PolylineConnection-»
	/**
	 * @@generated
	 */
	public «cuName»() {
		«EXPAND Attrs::Init("this")»
«IF !children.typeSelect(Label).isEmpty()-»
		createContents();
«ENDIF-»
«IF hasSourceDecoration()-»
		setSourceDecoration(createSourceDecoration());
«ENDIF-»
«IF hasTargetDecoration()-»
		setTargetDecoration(createTargetDecoration());
«ENDIF-»
	}
«IF !children.typeSelect(Label).isEmpty()»
«REM»
	Copy of Children::CreateChildren with temp workaround to generate child figures for labels only.
	Though this is temp workaround for https://bugs.eclipse.org/bugs/show_bug.cgi?id=193180, I'm not sure
	what's the right approach with e.g. decoration as child of a link.
«ENDREM»
	/**
	 * @@generated
	 */
	private void createContents(){
«EXPAND Children::instantiate(0, this, "this") FOREACH children.typeSelect(Label)»
	}
«ENDIF-»
«IF hasSourceDecoration()»
	/**
	 * @@generated
	 */
	private org.eclipse.draw2d.RotatableDecoration createSourceDecoration() {
		«EXPAND Decoration::Instantiate("df") FOR sourceDecoration-»
		return df;
	}
«ENDIF-»
«IF hasTargetDecoration()»
	/**
	 * @@generated
	 */
	private org.eclipse.draw2d.RotatableDecoration createTargetDecoration() {
		«EXPAND Decoration::Instantiate("df") FOR targetDecoration-»
		return df;
	}
«ENDIF-»
«EXPAND additions-»
«ENDDEFINE»

«REM»Our regular way to add smth inside generated class body«ENDREM»
«DEFINE additions FOR gmfgraph::Figure»«ENDDEFINE»@


1.6
log
@[191273] once LinkEditPart starts assigning labels their figures, they should be generated
@
text
@d51 1
a51 1
«IF !children.typeSelect(Figure).isEmpty()-»
d61 12
a72 2
«IF !children.typeSelect(Figure).isEmpty()»
«EXPAND Children::CreateChildren-»
@


1.5
log
@handle composite custom borders (fixes failing test) in a way that doesn't mandate any special additional output streams
@
text
@d51 3
d61 3
@


1.4
log
@FigureDescriptor with explicit means to access children introduced into gmfgraph
@
text
@d29 1
d36 1
@


1.3
log
@moving towards not using fqnswitch and java to tell draw2d figure names; let toolsmith to control what draw2d classes are being used; fqnSwitch argument replaced with simple token indicator
@
text
@d13 1
a13 1
«IMPORT "http://www.eclipse.org/gmf/2005/GraphicalDefinition"»
d18 7
a24 6
«DEFINE FigureClass(boolean isInnerClass) FOR gmfgraph::Figure-»
«packageStatement()»
/**
 * @@generated
 */
public class «compilationUnitName()» extends «EXPAND Runtime::fqn» {
d28 1
a28 1
	public «compilationUnitName()»() {
a37 1
«additionalMethods()»
d40 1
a40 7
«IF isInnerClass-»
}
«additionalStaticFields()»
«ELSE-»
«additionalStaticFields()»
}
«ENDIF-»
d43 1
a43 8

«DEFINE FigureClass(boolean isInnerClass) FOR gmfgraph::PolylineConnection-»
«packageStatement()»
/**
 * @@generated
 */
public class «compilationUnitName()» extends «EXPAND Runtime::fqn» {

d47 1
a47 1
	public «compilationUnitName()»() {
d74 5
a78 9
«additionalMethods()»
«IF isInnerClass-»
}
«additionalStaticFields()»
«ELSE-»
«additionalStaticFields()»
}
«ENDIF-»
«ENDDEFINE»@


1.2
log
@no extra line in the beginning of the file
@
text
@d2 1
a2 1
 * Copyright (c) 2006 Borland Software Corporation
d23 1
a23 1
public class «compilationUnitName()» extends «qualifiedClassNameGEF()» {
d55 1
a55 1
public class «compilationUnitName()» extends «qualifiedClassNameGEF()» {
@


1.1
log
@JET templates for gmfgraph model replaced with Xpand counterparts.
MapMode handling simplified
@
text
@d18 1
a18 1
«DEFINE FigureClass(boolean isInnerClass) FOR gmfgraph::Figure»
d50 1
a50 1
«DEFINE FigureClass(boolean isInnerClass) FOR gmfgraph::PolylineConnection»
@

