head	1.10;
access;
symbols
	v20081022-1925:1.10
	v20081015-1925:1.10
	v20081008-1925:1.10
	v20081001-1925:1.10
	v20080924-1925:1.10
	v20080917-1925:1.10
	v20080911-1728:1.10
	v20080910-1520:1.10
	v20080903-1520:1.10
	v20080827-1520:1.10
	v20080813-1520:1.10
	v20080806-1520:1.10
	v20070322-1100:1.9
	v20060316-0600:1.9
	v20070307-0700:1.9
	v20070301-1200:1.9
	v20070228-2000:1.9
	v20070221-1500:1.9
	v20070208-1800:1.9
	v20070202-0200:1.6
	v20070103-0300:1.9
	M4_20:1.9
	v20061222-1800:1.9
	v20061218-1200:1.9
	v20061214-0000:1.9
	v20061120-1300:1.9
	M3_20:1.8
	v20061117-0800:1.8
	v20061027-1200:1.6
	v20061020-1000:1.6
	v20061013-1330:1.6
	v20060919-0800:1.6
	v20060907-1100:1.6
	M1_20:1.6
	v20060904-1500:1.6
	v20060824-1600:1.6
	v20060817-1500:1.6
	v20060728-0500:1.6
	v20060713-1700:1.6
	R1_0_maintenance:1.6.0.2
	R1_0:1.6
	v20060627-1200:1.6
	v20060626-1420:1.6
	v20060620-0400:1.6
	v20060616-1400:1.6
	v20060616-1200:1.6
	v20060609-1400:1.6
	v20060531-1730:1.6
	v20060530-1930:1.6
	v20060526-1200:1.6
	v20060519-1300:1.6
	v20060519-0800:1.6
	v20060512-1000:1.6
	I20060512-1000:1.6
	I20060505-1400:1.6
	I20060428-1300:1.6
	I20060424-0500:1.6
	I20060424-0300:1.6
	M6_10:1.6
	I20060407-1200:1.6
	I20060331-1000:1.6
	I20060324-0300:1.6
	I20060317-1300:1.6
	I20060317-1200:1.6
	I20060316-1300:1.6
	I20060309-1300:1.6
	M5_10:1.5
	S20060303-1600:1.5
	I20060227-1730:1.5
	I20060216-1945:1.5
	I20060210-1715:1.5
	I20060209-1815:1.5
	I20060203-0830:1.3
	I20060202-1415:1.3
	I20060129-1145:1.3
	I20060127-0900:1.3
	I20060120-1530:1.3
	I20060113-1700:1.3
	M4_10:1.3
	I20060107-1100:1.3
	I20060105-1630:1.3
	I20051230-1230:1.3
	I20051223-1100:1.3
	I20051217-0925:1.3
	I20051208-2000:1.3
	I20051201-1800:1.3
	I20051124-2000:1.2
	M3_10:1.2
	I20051118-1245:1.2
	I20051111-1800:1.1
	I20051106-0900:1.1
	v20051030:1.1;
locks; strict;
comment	@# @;
expand	@k@;


1.10
date	2007.03.22.20.48.50;	author ashatalin;	state dead;
branches;
next	1.9;
commitid	14974602ebb14567;

1.9
date	2006.11.17.11.14.16;	author dstadnik;	state Exp;
branches;
next	1.8;
commitid	7c5e455d99874567;

1.8
date	2006.11.08.14.06.28;	author ashatalin;	state Exp;
branches;
next	1.7;

1.7
date	2006.10.17.19.19.54;	author ashatalin;	state Exp;
branches;
next	1.6;

1.6
date	2006.03.07.15.45.28;	author dstadnik;	state Exp;
branches;
next	1.5;

1.5
date	2006.02.08.17.15.39;	author atikhomirov;	state Exp;
branches;
next	1.4;

1.4
date	2006.02.08.16.06.19;	author atikhomirov;	state Exp;
branches;
next	1.3;

1.3
date	2005.11.25.06.54.36;	author dstadnik;	state Exp;
branches;
next	1.2;

1.2
date	2005.11.15.12.03.34;	author dstadnik;	state Exp;
branches;
next	1.1;

1.1
date	2005.10.19.15.36.38;	author atikhomirov;	state Exp;
branches;
next	;


desc
@@


1.10
log
@Fixing problems with NavigatorLinkHelper.
@
text
@<%@@ jet package="org.eclipse.gmf.codegen.templates.editor" class="MatchingStrategyGenerator"
    imports="org.eclipse.gmf.codegen.gmfgen.* org.eclipse.gmf.common.codegen.*"%>
<%
GenDiagram genDiagram = (GenDiagram) ((Object[]) argument)[0];
final ImportAssistant importManager = (ImportAssistant) ((Object[]) argument)[1];
%>
<%@@ include file="../copyright4java.jetinc"%>
<%importManager.emitPackageStatement(stringBuffer);%>

<%importManager.markImportLocation(stringBuffer);%>

/**
 * @@generated
 */
public class <%=genDiagram.getMatchingStrategyClassName()%> implements <%=importManager.getImportedName("org.eclipse.ui.IEditorMatchingStrategy")%> {

	/**
	 * @@generated
	 */
	public boolean matches(<%=importManager.getImportedName("org.eclipse.ui.IEditorReference")%> editorRef, <%=importManager.getImportedName("org.eclipse.ui.IEditorInput")%> input) {
        <%=importManager.getImportedName("org.eclipse.ui.IEditorInput")%> editorInput;
        try {
            editorInput = editorRef.getEditorInput();
        } catch (<%=importManager.getImportedName("org.eclipse.ui.PartInitException")%> e) {
            return false;
        }
        
        if (editorInput.equals(input)) {
        	return true;
        }
        
        <% /* Workaround for IFileEditorInputProxy comparision.. */ %>
<%if (genDiagram.getEditorGen().getApplication() == null) {%>
        if (editorInput instanceof <%=importManager.getImportedName("org.eclipse.ui.IFileEditorInput")%> && input instanceof <%=importManager.getImportedName("org.eclipse.ui.IFileEditorInput")%>) {
        	return ((<%=importManager.getImportedName("org.eclipse.ui.IFileEditorInput")%>) editorInput).getFile().equals(((<%=importManager.getImportedName("org.eclipse.ui.IFileEditorInput")%>) input).getFile());
        }
<%}%>

		<%=importManager.getImportedName("org.eclipse.ui.IEditorPart")%> editor = editorRef.getEditor(false);
		if (input instanceof <%=importManager.getImportedName("org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorInput")%> && editor instanceof <%=importManager.getImportedName(genDiagram.getEditorGen().getEditor().getQualifiedClassName())%>) {
			<%=importManager.getImportedName("org.eclipse.gmf.runtime.notation.Diagram")%> editorDiagram = ((<%=importManager.getImportedName(genDiagram.getEditorGen().getEditor().getQualifiedClassName())%>) editor).getDiagram();
			<%=importManager.getImportedName("org.eclipse.gmf.runtime.notation.Diagram")%> otherDiagram = ((<%=importManager.getImportedName("org.eclipse.gmf.runtime.diagram.ui.parts.DiagramEditorInput")%>) input).getDiagram();
			return equals(editorDiagram, otherDiagram);
		}
		return false;
	}
	
	/**
	 * @@generated
	 */
	private boolean equals(<%=importManager.getImportedName("org.eclipse.gmf.runtime.notation.Diagram")%> editorDiagram, <%=importManager.getImportedName("org.eclipse.gmf.runtime.notation.Diagram")%> otherDiagram) {
		<%=importManager.getImportedName("org.eclipse.emf.ecore.resource.Resource")%> editorResource = editorDiagram.eResource();
		<%=importManager.getImportedName("org.eclipse.emf.ecore.resource.Resource")%> otherResource = otherDiagram.eResource();
		if (editorResource != null && otherResource != null) {
			<%=importManager.getImportedName("org.eclipse.emf.common.util.URI")%> editorURI = editorResource.getURI();
			<%=importManager.getImportedName("org.eclipse.emf.common.util.URI")%> otherURI = otherResource.getURI();
			String editorURIFragment = editorResource.getURIFragment(editorDiagram);
			String otherURIFragment = otherResource.getURIFragment(otherDiagram);
			return editorURI.equals(otherURI) && editorURIFragment.equals(otherURIFragment);
		}
		return false;
	}

}
<%importManager.emitSortedImports();%>@


1.9
log
@do not refer to FileEditorInput from RCP app
@
text
@@


1.8
log
@LinkHelper adopted to work correctly with shortcuts.
@
text
@d33 1
d37 1
@


1.7
log
@Open action for diagram nodes in Navigator added.
@
text
@d31 5
@


1.6
log
@#130100 Allow to specify copyright text in gmfgen model
@
text
@d10 1
a10 1
import org.eclipse.gmf.runtime.diagram.ui.resources.editor.parts.DiagramDocumentEditorMatchingStrategy;
d15 44
a58 1
public class <%=genDiagram.getMatchingStrategyClassName()%> extends DiagramDocumentEditorMatchingStrategy {}
@


1.5
log
@ImportManager has to know its package anyway, so why not use it to emit appropriate statement?
Besides, package fragment is external to template, template has no control over file placement, thus we'd better pass package name as an argument
@
text
@d4 1
a4 1
GenDiagram diagram = (GenDiagram) ((Object[]) argument)[0];
d6 3
a8 2

importManager.emitPackageStatement(stringBuffer);%>
d15 1
a15 1
public class <%=diagram.getMatchingStrategyClassName()%> extends DiagramDocumentEditorMatchingStrategy {}
@


1.4
log
@GenEditorViewer incapsulates all Eclipse's IEditorPart-related info
@
text
@d2 6
a7 3
    imports="org.eclipse.gmf.codegen.gmfgen.*"%>
<%GenDiagram diagram = (GenDiagram) argument;%>
package <%=diagram.getEditorGen().getEditor().getPackageName()%>;
@


1.3
log
@#117132 Remove unnecessary code
@
text
@d4 1
a4 1
package <%=diagram.getEditorPackageName()%>;
@


1.2
log
@update imports
@
text
@a6 1
import org.eclipse.gmf.runtime.emf.core.edit.MEditingDomain;
d11 1
a11 9
public class <%=diagram.getMatchingStrategyClassName()%> extends DiagramDocumentEditorMatchingStrategy {

	/**
	 * @@generated
	 */
	public MEditingDomain getDefaultDomain() {
		return MEditingDomain.INSTANCE;
	}
}
@


1.1
log
@[dstadnik] #113074  diagram action bar contributor
@
text
@d6 1
a6 1
import org.eclipse.gmf.runtime.diagram.ui.resources.editor.internal.parts.DiagramDocumentEditorMatchingStrategy;
@

