head	1.4;
access;
symbols
	v20080910-1520:1.4
	v20080722-1827:1.3
	v20080716-1642:1.3
	R2_1_maintenance:1.3.0.2
	Root_R2_1_maintenance:1.3
	R2_1_0:1.3
	v20080507-1326:1.3
	v20080501-1739:1.2
	v20080425-1959:1.2
	v20080322-0000:1.2
	v20071108-0000:1.1
	v20071003-0000:1.1
	v20070921-0000:1.1
	v20070915-0000:1.1
	v20070903-0000:1.1
	v20070809-0000:1.1
	R2_0_maintenance:1.1.0.2
	R2_0:1.1
	R4_20:1.1
	v20070621-0000:1.1;
locks; strict;
comment	@# @;


1.4
date	2008.09.09.18.22.56;	author atikhomirov;	state Exp;
branches;
next	1.3;
commitid	703b48c6bf004567;

1.3
date	2008.05.07.13.55.39;	author atikhomirov;	state Exp;
branches;
next	1.2;
commitid	388c4821b4d44567;

1.2
date	2008.02.26.22.50.33;	author atikhomirov;	state Exp;
branches;
next	1.1;
commitid	405e47c497b74567;

1.1
date	2007.06.20.10.16.10;	author bblajer;	state Exp;
branches;
next	;
commitid	37dd4678fe694567;


desc
@@


1.4
log
@updated to match changes done in the FullRT for [244710] - tool group should use icons
@
text
@/*
 * Copyright (c) 2007, 2008 Borland Software Corporation
 * 
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    bblajer (Borland) - initial API and implementation
 */

«IMPORT "http://www.eclipse.org/gmf/2008/GenModel"»
«IMPORT "http://www.eclipse.org/emf/2002/Ecore"»
«IMPORT "http://www.eclipse.org/emf/2002/GenModel"»
«EXTENSION xpt::editor::palette::Utils»

«AROUND Factory FOR gmfgen::Palette-»
«EXPAND xpt::Common::copyright FOR diagram.editorGen-»
package «packageName»;

«EXPAND xpt::Common::generatedClassComment»
public class «factoryClassName» {
	«EXPAND contribute-»
	«EXPAND xpt::editor::palette::PaletteFactory::createGroup FOREACH collectGroups()»
	«EXPAND xpt::editor::palette::PaletteFactory::createEntry FOREACH collectTools()»
	«IF needsNodeToolEntryClass()»«EXPAND xpt::editor::palette::NodeToolEntry::NodeToolEntry»«ENDIF-»
	«IF needsLinkToolEntryClass()»«EXPAND xpt::editor::palette::LinkToolEntry::LinkToolEntry»«ENDIF-»
	«EXPAND additions-»
}
«ENDAROUND»

«DEFINE contribute FOR gmfgen::Palette-»
«EXPAND xpt::Common::generatedMemberComment»
public void contributeToPalette(org.eclipse.gef.palette.PaletteRoot paletteRoot) {
«IF !definesStandardTools()-»
	«EXPAND addStandardTools-»
«ENDIF-»
	«EXPAND xpt::editor::palette::PaletteFactory::addEntry("paletteRoot") FOREACH groups-»
}
«ENDDEFINE»

«DEFINE addStandardTools FOR gmfgen::Palette-»
org.eclipse.gef.palette.PaletteGroup controls = new org.eclipse.gef.palette.PaletteGroup("Controls");
paletteRoot.add(controls);

org.eclipse.gef.palette.ToolEntry tool = new org.eclipse.gef.palette.SelectionToolEntry();
controls.add(tool);
paletteRoot.setDefaultEntry(tool);

controls.add(new org.eclipse.gef.palette.MarqueeToolEntry());
«ENDDEFINE»

«AROUND addEntry(String varName) FOR gmfgen::AbstractToolEntry-»
{
	org.eclipse.gef.palette.PaletteEntry paletteEntry = «createMethodName»();
	if (paletteEntry != null) {
		«varName».add(paletteEntry);
«IF default_ && group.stack-»
		«varName».setActiveEntry(paletteEntry);
«ENDIF-»
	}
}
«ENDAROUND»

«AROUND newEntry(String toolVarName) FOR gmfgen::ToolEntry-»
«IF elements.isEmpty()-»
org.eclipse.gef.palette.ToolEntry «toolVarName» = new org.eclipse.gef.palette.ToolEntry(«EXPAND xpt::editor::palette::PaletteFactory::i18nTitle», «EXPAND xpt::editor::palette::PaletteFactory::i18nDesc», null, null) {};
«ELSE-»
final int[] visualIds = new int[] {
	«EXPAND visualID FOREACH elements SEPARATOR ','-»
};
«LET genNodes.isEmpty() ? "LinkToolEntry" : "NodeToolEntry" AS toolEntryClass-»
«toolEntryClass» «toolVarName» = new «toolEntryClass»(«EXPAND xpt::editor::palette::PaletteFactory::i18nTitle», «EXPAND xpt::editor::palette::PaletteFactory::i18nDesc», visualIds);
«ENDLET-»
«ENDIF-»
«ENDAROUND»

«DEFINE visualID FOR Object»«ERROR "Unexpected Type: " + this»«ENDDEFINE»

«DEFINE visualID FOR gmfgen::GenCommonBase»«EXPAND xpt::editor::VisualIDRegistry::visualID»«ENDDEFINE»

«AROUND setSmallImage(String toolVarName, gmfgen::Palette palette) FOR gmfgen::EntryBase-»
«IF null != smallIconPath-»
«toolVarName».setSmallIcon(«activatorFQN(palette)».findImageDescriptor("«smallIconPath»")); «EXPAND xpt::Common::nonNLS»
«ELSE-»
«toolVarName».setSmallIcon(«EXPAND smallImage(toolVarName)»);
«ENDIF-»
«ENDAROUND»

«DEFINE smallImage(String toolVarName) FOR gmfgen::EntryBase»null«ENDDEFINE»

«DEFINE smallImage(String toolVarName) FOR gmfgen::ToolEntry-»
«IF elements.isEmpty()»null«ELSE»«elementTypesClass()».getImageDescriptor(«EXPAND getElement FOR elements.first()»)«ENDIF-»
«ENDDEFINE»

«DEFINE getElement FOR Object»«ERROR "Unexpected type: " + this»«ENDDEFINE»

«DEFINE getElement FOR gmfgen::GenNode»«EXPAND getElement FOR modelFacet»«ENDDEFINE»
«DEFINE getElement FOR gmfgen::GenLink»«EXPAND getElement FOR modelFacet»«ENDDEFINE»

«DEFINE getElement FOR gmfgen::LinkModelFacet»«ERROR "Unexpected model facet: " + this»«ENDDEFINE»

«DEFINE getElement FOR gmfgen::TypeModelFacet»«EXPAND MetaModel::MetaClass FOR metaClass»«ENDDEFINE»
«DEFINE getElement FOR gmfgen::TypeLinkModelFacet»«EXPAND MetaModel::MetaClass FOR metaClass»«ENDDEFINE»
«DEFINE getElement FOR gmfgen::FeatureLinkModelFacet»«EXPAND MetaModel::MetaFeature FOR metaFeature»«ENDDEFINE»

«DEFINE additions FOR gmfgen::Palette»«ENDDEFINE»
@


1.3
log
@[228913] updated ValueExpression use in GMFGen to better accomodate codegen needs (items 1,2,3)
@
text
@d83 1
a83 1
«AROUND setSmallImage(String toolVarName) FOR gmfgen::AbstractToolEntry-»
d85 1
a85 1
«toolVarName».setSmallIcon(«activatorFQN()».findImageDescriptor("«smallIconPath»")); «EXPAND xpt::Common::nonNLS»
d91 1
a91 1
«DEFINE smallImage(String toolVarName) FOR gmfgen::AbstractToolEntry»null«ENDDEFINE»
@


1.2
log
@[150177] phase I, refactor existing code: completed - all metamodel access moved to MetaModel template, LiteRT version updated
@
text
@d13 1
a13 1
«IMPORT "http://www.eclipse.org/gmf/2006/GenModel"»
@


1.1
log
@Rewrite /editor/* templates in XPand;
Use common template to generate code that creates an editing domain in various places;
OpenDiagramEditPolicy: package statement was missing.
@
text
@d2 1
a2 1
 * Copyright (c) 2007 Borland Software Corporation
d104 3
a106 3
«DEFINE getElement FOR gmfgen::TypeModelFacet»«EXPAND xpt::Common::metaClassAccessor FOR metaClass»«ENDDEFINE»
«DEFINE getElement FOR gmfgen::TypeLinkModelFacet»«EXPAND xpt::Common::metaClassAccessor FOR metaClass»«ENDDEFINE»
«DEFINE getElement FOR gmfgen::FeatureLinkModelFacet»«EXPAND xpt::Common::metaFeatureAccessor FOR metaFeature»«ENDDEFINE»
@

