head	1.5;
access;
symbols
	jhotdraw54b2-release:1.5
	reorg_6x_split:1.5
	MVC_PHASE1:1.5.0.4
	NEW_ATTRIBUTES:1.5.0.2
	DNOYEB1_ALPHA-2:1.2.4.1
	release_JHD54b1:1.5
	BUGFIX_670992:1.4.0.2
	DNOYEB1_ALPHA-1:1.2.4.1
	dnoyeb1:1.2.0.4
	repack:1.2.0.2
	Root_repack:1.2
	Before_FigureVisitor:1.1;
locks; strict;
comment	@# @;


1.5
date	2003.01.30.00.27.33;	author mrfloppy;	state Exp;
branches;
next	1.4;

1.4
date	2003.01.12.20.21.16;	author dnoyeb;	state Exp;
branches;
next	1.3;

1.3
date	2003.01.03.00.55.32;	author dnoyeb;	state Exp;
branches;
next	1.2;

1.2
date	2002.09.22.08.58.23;	author mrfloppy;	state Exp;
branches
	1.2.4.1;
next	1.1;

1.1
date	2002.08.04.22.39.17;	author mrfloppy;	state Exp;
branches;
next	;

1.2.4.1
date	2003.01.03.16.03.59;	author dnoyeb;	state Exp;
branches;
next	;


desc
@@


1.5
log
@prepare for 5.4 release: various bug fixes
@
text
@/*
 * @@(#)SplitPaneDesktop.java
 *
 * Project:		JHotdraw - a GUI framework for technical drawings
 *				http://www.jhotdraw.org
 *				http://jhotdraw.sourceforge.net
 * Copyright:	© by the original author(s) and all contributors
 * License:		Lesser GNU Public License (LGPL)
 *				http://www.opensource.org/licenses/lgpl-license.html
 */

package CH.ifa.draw.contrib;

import javax.swing.*;
import java.awt.*;
import CH.ifa.draw.framework.DrawingView;
import java.beans.PropertyChangeListener;
import java.beans.PropertyChangeEvent;

/**
 * @@todo Gotta fix this !!! the selected view changes based on which split pane is selected!
 *
 * @@author C.L.Gilbert <dnoyeb@@users.sourceforge.net>
 * @@author Wolfram Kaiser <mrfloppy@@users.sourceforge.net>
 * @@version <$CURRENT_VERSION$>
 */
public class SplitPaneDesktop extends JSplitPane implements Desktop {

	private DesktopEventService myDesktopEventService;

    public SplitPaneDesktop() {
		setDesktopEventService(createDesktopEventService());
		setAlignmentX(JSplitPane.LEFT_ALIGNMENT);
		setOneTouchExpandable(true);

		addPropertyChangeListener(createPropertyChangeListener());
    }

	protected PropertyChangeListener createPropertyChangeListener() {
		return new PropertyChangeListener() {
			public void propertyChange(PropertyChangeEvent evt) {
				if (getRightComponent() != null) {
					getRightComponent().repaint();
				}
				if (getLeftComponent() != null) {
					getLeftComponent().repaint();
				}
			}
		};
	}

	protected Component createContents(DrawingView dv, int location) {
		setRightComponent(createRightComponent(dv));
		setLeftComponent(createLeftComponent(dv));
	    switch (location) {
		    case Desktop.PRIMARY: {
			    return getLeftComponent();
			}
			case Desktop.SECONDARY: {
				return getRightComponent();
			}
			default: {
			    return null;
			}
	    }
	}

	protected Component createRightComponent(DrawingView dv) {
		JScrollPane sp = new JScrollPane((Component)dv);
		sp.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
		sp.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
		sp.setAlignmentX(LEFT_ALIGNMENT);
		return sp;
	}

	protected Component createLeftComponent(DrawingView dv) {
		return new JScrollPane(new JList());
	}

	public DrawingView getActiveDrawingView() {
		return getDesktopEventService().getActiveDrawingView();
	}

	public void addToDesktop(DrawingView dv, int location) {
		createContents(dv, Desktop.PRIMARY);
/*	    switch (location) {
		    case Desktop.PRIMARY: {
			    setLeftComponent(createContents(dv, Desktop.PRIMARY));
				break;
			}
			case Desktop.SECONDARY: {
				setRightComponent(createContents(dv, Desktop.SECONDARY));
				break;
			}
	    }
*/
//		validate();
		setDividerLocation(getInitDividerLocation());
	}

	protected int getInitDividerLocation() {
		return 150;
	}

	public void removeFromDesktop(DrawingView dv, int location) {
		Component[] comps = getContainer().getComponents();
		for (int x = 0; x < comps.length; x++) {
			if (dv == Helper.getDrawingView(comps[x])) {
				getContainer().remove(comps[x]);
			    break;
			}
		}
	}

	public void removeAllFromDesktop(int location) {
	    getContainer().removeAll();
	}

	public DrawingView[] getAllFromDesktop(int location) {
		return getDesktopEventService().getDrawingViews(getComponents());
	}

	public void addDesktopListener(DesktopListener dpl) {
		getDesktopEventService().addDesktopListener(dpl);
	}

	public void removeDesktopListener(DesktopListener dpl) {
		getDesktopEventService().removeDesktopListener(dpl);
	}

	private Container getContainer() {
		return this;
	}

	protected DesktopEventService getDesktopEventService() {
		return myDesktopEventService;
	}

	private void setDesktopEventService(DesktopEventService newDesktopEventService) {
		myDesktopEventService = newDesktopEventService;
	}

	protected DesktopEventService createDesktopEventService() {
		return new DesktopEventService(this, getContainer());
	}

	public void updateTitle(String newDrawingTitle) {
		// should be setTitle but a JPanelDesktop has no own title bar
		setName(newDrawingTitle);
	}
}@


1.4
log
@Clean up head to be what it was before i mistakenly committed my changes to it.
My changes should have been committed to a branch, and let mrfloppy merge to the trunk.
This will happen from now on.
@
text
@d23 2
a24 2
 * @@author C.L.Gilbert <dnoyeb@@sourceforge.net>
 * @@author Wolfram Kaiser <mrfloppy@@sourceforge.net>
@


1.3
log
@Improved drawing and application title handling.
MDI was not setting activeDrawingView to null when last was closed.
New drawingTitleChange event.
@
text
@d23 1
a23 1
 * @@author C.L.Gilbert <dnoyeb@@users.sourceforge.net>
d146 1
a146 3
    /**
     *  @@deprecated desktop will use listener
     */
@


1.2
log
@introduce FigureVisitor for paste/delete commands
@
text
@d23 1
a23 1
 * @@author C.L.Gilbert <dnoyeb@@sourceforge.net>
d146 3
a148 1

@


1.2.4.1
log
@Improved drawing and application title handling.
MDI was not setting activeDrawingView to null when last was closed.
New drawingTitleChange event.
@
text
@d23 1
a23 1
 * @@author C.L.Gilbert <dnoyeb@@users.sourceforge.net>
d146 1
a146 3
    /**
     *  @@deprecated desktop will use listener
     */
@


1.1
log
@after variou merges... (before 5.4 release)
@
text
@d146 5
@

