36d35
< reg threi_clear;
148,159d146
< always @ (posedge clk or posedge wb_rst_i) begin
<     if (wb_rst_i)
<         threi_clear <= # 1 0;
<     else
<         if (! lsr [`UART_LS_TFE] && (tf_count == 0))
<             threi_clear <= # 1 0;
<         else
<             if (wb_re_i && wb_addr_i == `UART_REG_II)
<                 threi_clear <= # 1 1;
< 
< end
< 
268c255,258
< always @ (posedge clk or posedge wb_rst_i) lsr1r <= # 1 wb_rst_i ? 0 : lsr_mask ? 0 : lsr1 && ~ lsr1_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr1_d <= # 1 0;
> else
>     lsr1r <= # 1 lsr_mask ? 0 : lsr1 && ~ lsr1_d;
276c266,269
< always @ (posedge clk or posedge wb_rst_i) lsr2r <= # 1 wb_rst_i ? 0 : lsr_mask ? 0 : lsr2 && ~ lsr2_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr2_d <= # 1 0;
> else
>     lsr2r <= # 1 lsr_mask ? 0 : lsr2 && ~ lsr2_d;
284c277,280
< always @ (posedge clk or posedge wb_rst_i) lsr3r <= # 1 wb_rst_i ? 0 : lsr_mask ? 0 : lsr3 && ~ lsr3_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr3_d <= # 1 0;
> else
>     lsr3r <= # 1 lsr_mask ? 0 : lsr3 && ~ lsr3_d;
292c288,291
< always @ (posedge clk or posedge wb_rst_i) lsr4r <= # 1 wb_rst_i ? 0 : lsr_mask ? 0 : lsr4 && ~ lsr4_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr4_d <= # 1 0;
> else
>     lsr4r <= # 1 lsr_mask ? 0 : lsr4 && ~ lsr4_d;
302c301,304
< always @ (posedge clk or posedge wb_rst_i) lsr5r <= # 1 wb_rst_i ? 1 : (lsr_mask || iir_read || tx_fifo_write) ? 0 : lsr5 && ~ lsr5_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr5_d <= # 1 0;
> else
>     lsr5r <= # 1 (lsr_mask || iir_read || tx_fifo_write) ? 0 : lsr5 && ~ lsr5_d;
310c312,315
< always @ (posedge clk or posedge wb_rst_i) lsr6r <= # 1 wb_rst_i ? 1 : (lsr_mask || tx_fifo_write) ? 0 : lsr6 && ~ lsr6_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr6_d <= # 1 0;
> else
>     lsr6r <= # 1 (lsr_mask || tx_fifo_write) ? 0 : lsr6 && ~ lsr6_d;
318c323,326
< always @ (posedge clk or posedge wb_rst_i) lsr7r <= # 1 wb_rst_i ? 0 : lsr_mask ? 0 : lsr7 && ~ lsr7_d;
---
> always @ (posedge clk or posedge wb_rst_i) if (wb_rst_i)
>     lsr7_d <= # 1 0;
> else
>     lsr7r <= # 1 lsr_mask ? 0 : lsr7 && ~ lsr7_d;
344c352
< assign thre_int = threi_clear ? 0 : ier [`UART_IE_THRE] && lsr [`UART_LS_TFE];
---
> assign thre_int = ier [`UART_IE_THRE] && lsr [`UART_LS_TFE];
446c454
<                                 iir [`UART_II_II] <= # 1 1?b0;
---
>                                 iir [`UART_II_II] <= # 1 0;
