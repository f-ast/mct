28a29
> ////      - Igor Mohor (igorm@opencores.org)                      ////
36c37
< //// Copyright (C) 2000 Jacob Gorban, gorban@opencores.org        ////
---
> //// Copyright (C) 2000, 2001 Authors                             ////
63a65,72
> // Revision 1.9  2001/08/23 16:05:05  mohor
> // Stop bit bug fixed.
> // Parity bug fixed.
> // WISHBONE read cycle bug fixed,
> // OE indicator (Overrun Error) bug fixed.
> // PE indicator (Parity Error) bug fixed.
> // Register read bug fixed.
> //
99d107
< 	enable,
115d122
< output		enable;
417c424,425
< // Enable signal generation logic
---
> 
> // Frequency divider
421d428
< 	begin
423,424d429
< 		enable <= #1 1'b0;
< 	end
426,431c431,432
< 	begin
< 		if (start_dlc)
< 		begin
< 			enable <= #1 1'b0;
< 			dlc    <= #1 dl;
< 		end
---
>   if (start_dlc | ~ (|dlc))
>   	dlc <= #1 dl - 1;               // preset counter
433,439c434
< 		begin
< 			if (dl!=0)
< 			begin
< 				if ( (dlc-1)==0 )
< 				begin
< 					enable <= #1 1'b1;
< 					dlc <= #1 dl;
---
> 		dlc <= #1 dlc - 1;              // decrement counter
441c436,438
< 				else
---
> 
> // Enable signal generation logic
> always @(posedge clk or posedge wb_rst_i)
442a440
> 	if (wb_rst_i)
444,446d441
< 					dlc <= #1 dlc - 1;
< 				end
< 			end
448,449c443,445
< 			begin
< 				dlc <= #1 0;
---
>   if (|dl & ~(|dlc))     // dl>0 & dlc==0
> 		enable <= #1 1'b1;
>   else
452,454c448,453
< 		end
< 	end
< end
---
> 
> 
> 
> 
> 
> 
