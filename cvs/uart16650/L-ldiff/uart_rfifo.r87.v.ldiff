61,61d60
<                     fifo [bottom] <= # 1 0;
79,79c78,78
<             if (push & (count == fifo_depth))
---
>             if (push & ~ pop & (count == fifo_depth))
